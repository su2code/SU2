<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Documentation: Common/include/toolboxes/ndflattener.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoSU2small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ndflattener_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ndflattener.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ndflattener_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * \file ndflattener.hpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * \brief Flatten pointer-to-pointer-... arrays for MPI communication</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * \author M. Aehle</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * \version 7.5.0 &quot;Blackbird&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * SU2 Project Website: https://su2code.github.io</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * The SU2 Project is maintained by the SU2 Foundation</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * (http://su2foundation.org)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Copyright 2012-2022, SU2 Contributors (cf. AUTHORS.md)</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * SU2 is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * SU2 is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * License along with SU2. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;../containers/C2DContainer.hpp&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;../parallelization/mpi_structure.hpp&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/// \addtogroup Containers</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/// @{</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// --- Usage</span><span class="comment"></span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/*! \page ndflattener_usage NdFlattener usage</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * # What is an NdFlattener?</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * NdFlattener is a container to store a deep copy of multidimensional data in a single object that provides a</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * generic []...[] interface. The data and their structure are stored in few contiguous arrays, allowing for an</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * efficient MPI gathering operation.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * # Which problem does it solve?</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> * In SU2, there is a lot of multidimensional data: data depending on K&gt;1 indices, like a wall property</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> * depending on the rank, zone index, and marker index.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> * The data is often stored non-contiguously as a &quot;tree&quot;:</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> * - an array of pointers, each one of which points to</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> * - (repeat the previous line another (K-2) times)</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> * - an array of data.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> * The individual arrays&#39; sizes are usually unrelated to each other. Therefore in addition to this tree of</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> * pointers-to-...-to-data, usually there is a tree of pointers-to-...-to-size for each lower level.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * Instead of arrays, there might be getter functions for the data and the sizes.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * In order to use multidimensional data behind such a non-generic interface as an argument in a function call,</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> * we usually make the callee aware of the interface and expose all the trees: Either as separate pointers to arrays</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> * (or functions), which is tedious, or by handing an object in which they naturally live, which exposes much more</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> * information.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> * If the callee is an MPI communication operation, this is not possible. Here, a frequent pattern is to copy the data</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> * into a single contiguous array, which is then communicated alongside with the structure (lengths of the arrays).</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> * The NdFlattener container is a systematic way to store multidimensional data in a single contiguous array, and</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"> * the structure in few additional contiguous arrays. It exposes them through a generic []...[] interface and allows</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> * for an efficient MPI_Allgatherv-like operation.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> * To demonstrate the usage of NdFlattener, let us store a property of type su2double that depends on</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> * the rank, zone index, and marker index.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> * # Form the local NdFlattener</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> * by a &quot;recursive function&quot; like this:</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> *     auto f_local =</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> *     make_pair( nZone, [=](unsigned long iZone){</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> *       return make_pair( (Geometry of iZone)-&gt;GetnMarker() , [=](unsigned long iMarker){</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> *         return YOUR_PROPERTY(iZone, iMarker);</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> *       });</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> *     });</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"> *     NdFlattener&lt;2&gt; nd_local(f_local);</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> * It might be safer to explicitly capture what you need in the lambda expressions.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> * You can also construct an NdFlattener without any arguments, and use NdFlattener::initialize(f_local).</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> * f_local is</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> *  - a pair of an (exclusive) upper bound for the first index and a function that maps the first index to</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> *  - a pair of an (exclusive) upper bound for the second index and a function that maps the second index to</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> *  - (iterate this if there are more layers)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> *  - the value corresponding to these indices.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> * The template parameter &quot;2&quot; is the number of indices. The data type (default: su2double) and the index type</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> * (default: unsigned long) are further optional template parameters.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * # Form the global NdFlattener</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> * by &quot;collective communication&quot; like this:</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> *     NdFlattener&lt;3&gt; nd_global(Nd_MPI_Environment(), &amp;nd_local);</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> * nd_global&#39;s first index is the rank, then the indices of nd_local follow.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> * The struct Nd_MPI_Environment contains the relevant information about the parallel environment. The default</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> * values are suitable to communicate su2double data. In order to communicate data of another MPI datatype,</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> * use e.g. Nd_MPI_Environment(MPI_UNSIGNED_LONG).</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> * You can also construct an NdFlattener without any arguments, and use NdFlattener::initialize(mpi_env, &amp;nd_local).</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> * # Refreshing</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> * If only the data but not the indices (i.e. the structure of sublists&#39; lengths) have changed, you can refresh</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> * them with the call</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> *     nd_local.refresh(f_local); // , or</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> *     nd_global(Nd_MPI_Environment(), &amp;nd_local); // respectively.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> * An NdFlattener constructed or initialized from a &quot;recursive function&quot; or &quot;collective communication&quot; must be</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> * refreshed in the same way.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> * We also provide a function NdFlattener::initialize_or_refresh, that initializes if not initialized, and refreshes</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> * otherwise.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> * # Look-up</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> * You can access the NdFlattener via a &quot;[]...[]&quot; interface that resembles multidimensional arrays</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> * or pointer-to-pointer-... arrays. If you provide all of the K indices, this returns a reference</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> * to the data element. If you provide less than K indices, you obtain an IndexAccumulator object</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> * to which you can later pass more indices. With respect to the above example:</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> *     std::cout &lt;&lt; nd_global[rank][zone][marker]; // e.g. 4.0</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> *     auto nd_g_rank = nd_global[rank];</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> *     nd_g_rank[zone][marker] *= 2.0;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> *     std::cout &lt;&lt; nd_g_rank[zone][marker]; // e.g. 8.0</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> * You may use the IndexAccumulator repeatedly as long as the accessed NdFlattener exists.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> * As NdFlatteners are always deep copies, the above block would not change nd_local or the non-contiguous</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> * data from which it was copied.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> * Each index is checked to lie in the correct range dictated by the NdFlattener and the</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> * previous indices. You can obtain the minimal overflowing index with `size`:</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> *     auto nd_g_rank = nd_global[rank];</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> *     std::cout &lt;&lt; nd_g_rank[zone].size();</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> * When all indices except the last one are fixed, the corresponding data is stored contiguously and a pointer</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> * to this 1D array can be retrieved by</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> *     nd_global[rank][zone].data()</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> * # Constness</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> * The reference returned by the last `operator[]`, and the pointer returned by `data()`, are const if</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> * - the accessed NdFlattener object was const, or</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> * - one of the intermediate IndexAccumulator objects was qualified as const.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> * This reflects the semantic meaning of const:</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> *     NdFlattener&lt;2&gt; nd2(...);</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> *     template&lt;class T&gt; set(T&amp; t) { t[0] = 1.0; }</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> *     set( nd2[0] ); // OK</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> *     template&lt;class T&gt; set_const(T const&amp; t) { t[0] = 1.0; }</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> *     set_const( nd2[0] ); // does not compile</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> * # Unit tests</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> * The interface described here is tested in UnitTests/Common/toolboxes/ndflattener_tests.cpp, which may also</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> * serve as an addition example of how to use the NdFlattener.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//  --- Implementation details---</span><span class="comment"></span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">/*! \page ndflattener_implementationdetails Implementation details of NdFlattener</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> * If your array has K indices, instantiate this class with template parameter K,</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> * which is derived recursively from this class with template parameter (K-1).</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> * In each layer, there is an array: Of type Data for K=1, and of type Index for K&gt;1.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> * The data array of K=1 contains the values of the array A in lexicographic ordering:</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> * [0]...[0][0][0], [0]...[0][0][1], ..., [0]...[0][0][something],</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> * [0]...[0][1][0], [0]...[0][1][1], ..., [0]...[0][1][something],</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> * ...,</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> * [0]...[1][0][0], [0]...[1][0][1], ..., [0]...[1][0][something],</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> * ... ...,</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> * [1]...[0][0][0], [1]...[0][0][1], ..., [1]...[0][0][something],</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> * ... ... ...</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> * Let us call each row in this representation a &quot;last-index list&quot;.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> * Note that they might have different lengths, so &quot;something&quot; might stand for different</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> * values here. Last-index lists can also be empty.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> * The indices array of K=2 contains the indices of the (K=1)-data array at which a new</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> * last-index list starts. If a last-index list is empty, the are repetitive entries in the</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> * indices array.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> * The indices array of K=3 contains the indices of the (K=2)-indices array at which the</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> * last-but-two index increases by one or drops to zero. If the last-but-two index is increased</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> * by more than one, there are repetitive entries.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> * Etc. etc, up to the indices array at layer K.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> * To form such a structure, we typically iterate twice through the pointer-to-pointer-...</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> * array: The first time we get to know how much space to reserve in each layer, then we</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> * allocate it and during the second iteration we copy the data.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">size_t</span> K, <span class="keyword">typename</span> Data_t_ = su2<span class="keywordtype">double</span>, <span class="keyword">typename</span> Index_t_ = <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>&gt;</div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classNdFlattener.html">  208</a></span>&#160;<span class="keyword">class </span><a class="code" href="classNdFlattener.html">NdFlattener</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">/*! \struct Nd_MPI_Environment</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> * \brief Contains information for the collective communication of NdFlatteners.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> * The default arguments in the constructor are chosen in a sensible way:</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> * - To communicate su2double data, just call Nd_MPI_Environment().</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> * - To communicate unsigned long data, call Nd_MPI_Environment(MPI_UNSIGNED_LONG).</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html">  217</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structNd__MPI__Environment.html">Nd_MPI_Environment</a> {</div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a15dfd855910037c6669df56166afca35">  218</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNd__MPI__Environment.html#a15dfd855910037c6669df56166afca35">MPI_Allgather_t</a> = decltype(&amp;(<a class="code" href="classCBaseMPIWrapper.html#a137ef06ade0c4f94d2a61f9b8817b6a7">SU2_MPI::Allgather</a>));</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a5e5bef9fa01fba05a2812d2d2cbafc1c">  219</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNd__MPI__Environment.html#a5e5bef9fa01fba05a2812d2d2cbafc1c">MPI_Allgatherv_t</a> = decltype(&amp;(<a class="code" href="classCBaseMPIWrapper.html#a1c8c3f6d23fd0833c8cd8ef23b0beded">SU2_MPI::Allgatherv</a>));</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a5169cfe6edb4111d6163bc9d1c0e64f9">  220</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNd__MPI__Environment.html#a5169cfe6edb4111d6163bc9d1c0e64f9">MPI_Datatype_t</a> = <span class="keyword">typename</span> <a class="code" href="classCBaseMPIWrapper.html#a7ee4e39a5fcbeaf454b5ec08bd6109bd">SU2_MPI::Datatype</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a729649ff21ac665bd2a84a2eacdba931">  221</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNd__MPI__Environment.html#a729649ff21ac665bd2a84a2eacdba931">MPI_Communicator_t</a> = <span class="keyword">typename</span> <a class="code" href="classCBaseMPIWrapper.html#af7c8104bafda520cf525f49c888bc48f">SU2_MPI::Comm</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#adac1c73261483bef70e172f3cf82e205">  223</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structNd__MPI__Environment.html#a5169cfe6edb4111d6163bc9d1c0e64f9">MPI_Datatype_t</a> <a class="code" href="structNd__MPI__Environment.html#adac1c73261483bef70e172f3cf82e205">mpi_data</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">  224</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structNd__MPI__Environment.html#a5169cfe6edb4111d6163bc9d1c0e64f9">MPI_Datatype_t</a> <a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">  225</a></span>&#160;  <a class="code" href="structNd__MPI__Environment.html#a729649ff21ac665bd2a84a2eacdba931">MPI_Communicator_t</a> <a class="code" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">comm</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a747675f4eda0b8141fdcacba21db0f60">  226</a></span>&#160;  <a class="code" href="structNd__MPI__Environment.html#a15dfd855910037c6669df56166afca35">MPI_Allgather_t</a> <a class="code" href="structNd__MPI__Environment.html#a747675f4eda0b8141fdcacba21db0f60">MPI_Allgather_fun</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a92c1196dd12e5c945114f2a7143006f5">  227</a></span>&#160;  <a class="code" href="structNd__MPI__Environment.html#a5e5bef9fa01fba05a2812d2d2cbafc1c">MPI_Allgatherv_t</a> <a class="code" href="structNd__MPI__Environment.html#a92c1196dd12e5c945114f2a7143006f5">MPI_Allgatherv_fun</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#aeee6df4eaefd58ca614ec84247648538">  228</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structNd__MPI__Environment.html#aeee6df4eaefd58ca614ec84247648538">rank</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">  229</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="structNd__MPI__Environment.html#a74cf24b88c0a9b0ed7b8379b2c2ee01c">  231</a></span>&#160;  <a class="code" href="structNd__MPI__Environment.html#a74cf24b88c0a9b0ed7b8379b2c2ee01c">Nd_MPI_Environment</a>(<a class="code" href="structNd__MPI__Environment.html#a5169cfe6edb4111d6163bc9d1c0e64f9">MPI_Datatype_t</a> <a class="code" href="structNd__MPI__Environment.html#adac1c73261483bef70e172f3cf82e205">mpi_data</a> = <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                     <a class="code" href="structNd__MPI__Environment.html#a5169cfe6edb4111d6163bc9d1c0e64f9">MPI_Datatype_t</a> <a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a> = <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                     <a class="code" href="structNd__MPI__Environment.html#a729649ff21ac665bd2a84a2eacdba931">MPI_Communicator_t</a> <a class="code" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">comm</a> = <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>(),</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                     <a class="code" href="structNd__MPI__Environment.html#a15dfd855910037c6669df56166afca35">MPI_Allgather_t</a> <a class="code" href="structNd__MPI__Environment.html#a747675f4eda0b8141fdcacba21db0f60">MPI_Allgather_fun</a> = &amp;(<a class="code" href="classCBaseMPIWrapper.html#a137ef06ade0c4f94d2a61f9b8817b6a7">SU2_MPI::Allgather</a>),</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                     <a class="code" href="structNd__MPI__Environment.html#a5e5bef9fa01fba05a2812d2d2cbafc1c">MPI_Allgatherv_t</a> <a class="code" href="structNd__MPI__Environment.html#a92c1196dd12e5c945114f2a7143006f5">MPI_Allgatherv_fun</a> = &amp;(<a class="code" href="classCBaseMPIWrapper.html#a1c8c3f6d23fd0833c8cd8ef23b0beded">SU2_MPI::Allgatherv</a>))</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      : <a class="code" href="structNd__MPI__Environment.html#adac1c73261483bef70e172f3cf82e205">mpi_data</a>(<a class="code" href="structNd__MPI__Environment.html#adac1c73261483bef70e172f3cf82e205">mpi_data</a>),</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>(<a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>),</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">comm</a>(<a class="code" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">comm</a>),</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="structNd__MPI__Environment.html#a747675f4eda0b8141fdcacba21db0f60">MPI_Allgather_fun</a>(<a class="code" href="structNd__MPI__Environment.html#a747675f4eda0b8141fdcacba21db0f60">MPI_Allgather_fun</a>),</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="structNd__MPI__Environment.html#a92c1196dd12e5c945114f2a7143006f5">MPI_Allgatherv_fun</a>(<a class="code" href="structNd__MPI__Environment.html#a92c1196dd12e5c945114f2a7143006f5">MPI_Allgatherv_fun</a>),</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="structNd__MPI__Environment.html#aeee6df4eaefd58ca614ec84247648538">rank</a>(<a class="code" href="classCBaseMPIWrapper.html">SU2_MPI</a>::GetRank()),</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>(<a class="code" href="classCBaseMPIWrapper.html">SU2_MPI</a>::GetSize()) {}</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;};</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="namespacehelpers.html">  245</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacehelpers.html">helpers</a> {<span class="comment"></span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">/*! \class IndexAccumulator</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"> * \brief Data structure holding an offset for the NdFlattener, to provide a []...[]-interface.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> * \details Derived from IndexAccumulator_Base, specifying the operator[] method:</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> *  - For N==1, the structure has already read all indices but one. So after this method has read the last</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"> *    index, return a (possibly const) reference to the data. An additional function data() should be provided.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"> *  - For N&gt;1, more indices have to be read, return an IndexAccumulator&lt;N-1,Nd_t_lower&gt;. Nd_t_lower is the</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> *    NdFlattener type with one index less. Nd_t_lower is const-qualified if Nd_t is const-qualified, or if the</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> *    index look-up is performed in a const IndexAccumulator.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> * \tparam N - Number of missing parameters</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> * \tparam Nd_t - Type of the accessed NdFlattener, should be NdFlattener&lt;N,...&gt;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"> * \tparam Check - if true, raise error if index to operator[] is not in range</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> */</span><span class="comment"></span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">/*! \class IndexAccumulator_Base</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"> * \brief Parent class of IndexAccumulator.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> * \details IndexAccumulator provides the operator[] method.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">size_t</span> N_, <span class="keyword">typename</span> Nd_t_, <span class="keywordtype">bool</span> Check&gt;</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html">  263</a></span>&#160;<span class="keyword">class </span><a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">IndexAccumulator_Base</a> {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#a2a7f2fc38f34c71da37bd471cd092a41">  265</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">size_t</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a2a7f2fc38f34c71da37bd471cd092a41">N</a> = N_;</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#aabaa772bf5f025fed63eb26e980a5ede">  266</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aabaa772bf5f025fed63eb26e980a5ede">Nd_t</a> = Nd_t_;</div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">  267</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">Index_t</a> = <span class="keyword">typename</span> Nd_t::Index_t;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">  /*! \brief Return exclusive upper bound for next index.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">  271</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a3971d1eaa7f489ab6f0f2e6ed70eb77c">size_</a>; }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">  274</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aabaa772bf5f025fed63eb26e980a5ede">Nd_t</a>&amp; <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>;             <span class="comment">/*!&lt; \brief The accessed NdFlattener. */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">  275</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a>; <span class="comment">/*!&lt; \brief Index in the currently accessed layer. */</span></div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#a3971d1eaa7f489ab6f0f2e6ed70eb77c">  276</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a3971d1eaa7f489ab6f0f2e6ed70eb77c">size_</a>;  <span class="comment">/*!&lt; \brief Exclusive upper bound for the next index. */</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#a4d91ccb17ceec5768e46ecf86d0c6681">  278</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a4d91ccb17ceec5768e46ecf86d0c6681">IndexAccumulator_Base</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aabaa772bf5f025fed63eb26e980a5ede">Nd_t</a>&amp; <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>, <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a>, <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>) : <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>), <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a>), <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a3971d1eaa7f489ab6f0f2e6ed70eb77c">size_</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>) {}</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">  280</a></span>&#160;  <a class="code" href="code__config_8hpp.html#a724fb9f82013c782db5c3c12ea36aac8">FORCEINLINE</a> <span class="keywordtype">void</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">CheckBound</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">Index_t</a> i)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    assert(i &lt; <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>());</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> (Check) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">if</span> (i &gt;= <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>()) <a class="code" href="classCBaseMPIWrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;NdFlattener: Index out of range.&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;};</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">size_t</span> N_, <span class="keyword">typename</span> Nd_t_, <span class="keywordtype">bool</span> Check = false&gt;</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html">  289</a></span>&#160;<span class="keyword">class </span><a class="code" href="classhelpers_1_1IndexAccumulator.html">IndexAccumulator</a> : <span class="keyword">public</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">IndexAccumulator_Base</a>&lt;N_, Nd_t_, Check&gt; {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#a8ffddf4f704c79b8d2956c3e4739cba9">  291</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">Base</a> = <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">IndexAccumulator_Base&lt;N_, Nd_t_, Check&gt;</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#a1e8b3bccb6aa73ca5c4a6beeb357f945">  292</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">size_t</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#a1e8b3bccb6aa73ca5c4a6beeb357f945">N</a> = N_;</div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#a1125e41e3be5dd428a51c880579c0a44">  293</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#a1125e41e3be5dd428a51c880579c0a44">Nd_t</a> = Nd_t_;</div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">  294</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> = <span class="keyword">typename</span> Nd_t::Index_t;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#a6e314b95454b56a70cc16b215d2753ef">  296</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator.html#a6e314b95454b56a70cc16b215d2753ef">IndexAccumulator</a>(<a class="code" href="classhelpers_1_1IndexAccumulator.html#a1125e41e3be5dd428a51c880579c0a44">Nd_t</a>&amp; <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>, <a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a>, <a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>) : <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">Base</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>, <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a>, <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>) {}</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">  /*! The Base of NdFlattener&lt;K&gt; is NdFlattener&lt;K-1&gt;, but do also preserve constness.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#a0102c0ec97c5e2d73d8bd5fe47050859">Nd_Base_t</a> = <a class="code" href="code__config_8hpp.html#a32ca23e8acd5305690e2a6fc104f0610">su2conditional_t</a>&lt;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    std::is_const&lt;Nd_t&gt;::value,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">const</span> <span class="keyword">typename</span> Nd_t::Base,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">typename</span> Nd_t::Base</div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#a0102c0ec97c5e2d73d8bd5fe47050859">  304</a></span>&#160;  &gt;;<span class="comment"></span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">  /*! Return type of operator[]. */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#aaa1b387b489ad57d1e867e6abec77fcb">  306</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html">LookupType</a> = <a class="code" href="classhelpers_1_1IndexAccumulator.html">IndexAccumulator</a>&lt;<a class="code" href="classhelpers_1_1IndexAccumulator.html#a1e8b3bccb6aa73ca5c4a6beeb357f945">N</a> - 1, <a class="code" href="classhelpers_1_1IndexAccumulator.html#a0102c0ec97c5e2d73d8bd5fe47050859">Nd_Base_t</a>&gt;;<span class="comment"></span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">  /*! Return type of operator[] const. */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#a143c42e800fdef20ad10077f379c2c35">  308</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html">LookupType_const</a> = <a class="code" href="classhelpers_1_1IndexAccumulator.html">IndexAccumulator</a>&lt;<a class="code" href="classhelpers_1_1IndexAccumulator.html#a1e8b3bccb6aa73ca5c4a6beeb357f945">N</a> - 1, <span class="keyword">const</span> <span class="keyword">typename</span> Nd_t::Base&gt;;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">Base::nd</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">Base::offset</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">Base::size</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">Base::CheckBound</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">  /*! \brief Read one more index, checking whether it is in the range dictated by the NdFlattener and</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">   * previous indices. Non-const version.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">   * \param[in] i - Index.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#af1bc94cd0b38470779185612f5e47095">  318</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator.html">LookupType</a> <a class="code" href="classhelpers_1_1IndexAccumulator.html#af1bc94cd0b38470779185612f5e47095">operator[]</a>(<a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> i) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">CheckBound</a>(i);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> new_offset = <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>.GetIndices()[<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a> + i];</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> new_size = <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>.GetIndices()[<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a> + i + 1] - new_offset;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#aaa1b387b489ad57d1e867e6abec77fcb">LookupType</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>, new_offset, new_size);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }<span class="comment"></span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">  /*! \brief Read one more index, const version.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">   * \param[in] i - Index.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator.html#a68d9c03ca0121d5a82c887ee5253d5f8">  327</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator.html">LookupType_const</a> <a class="code" href="classhelpers_1_1IndexAccumulator.html#a68d9c03ca0121d5a82c887ee5253d5f8">operator[]</a>(<a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> i)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">CheckBound</a>(i);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> new_offset = <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>.GetIndices()[<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a> + i];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">Index_t</a> new_size = <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>.GetIndices()[<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a> + i + 1] - new_offset;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#a143c42e800fdef20ad10077f379c2c35">LookupType_const</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>, new_offset, new_size);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;};</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Nd_t_, <span class="keywordtype">bool</span> Check&gt;</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html">  336</a></span>&#160;<span class="keyword">class </span><a class="code" href="classhelpers_1_1IndexAccumulator.html">IndexAccumulator</a>&lt;1, Nd_t_, Check&gt; : <span class="keyword">public</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">IndexAccumulator_Base</a>&lt;1, Nd_t_, Check&gt; {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a4f9700aaa64c9c8a5dc51f76f351f7e9">  338</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">Base</a> = <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">IndexAccumulator_Base&lt;1, Nd_t_, Check&gt;</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a6f180ad87de79f82fd83112dd0b51973">  339</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">size_t</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#a1e8b3bccb6aa73ca5c4a6beeb357f945">N</a> = 1;</div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#ab3fb64e44956577778fb71708c9ac649">  340</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#ab3fb64e44956577778fb71708c9ac649">Nd_t</a> = Nd_t_;</div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#acb5eba6d1ac568f316a5d6596f4e0452">  341</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#acb5eba6d1ac568f316a5d6596f4e0452">Index_t</a> = <span class="keyword">typename</span> Nd_t::Index_t;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a6cb84f17be07abd70bd068ae5a7dcd59">  343</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a6cb84f17be07abd70bd068ae5a7dcd59">IndexAccumulator</a>(<a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#ab3fb64e44956577778fb71708c9ac649">Nd_t</a>&amp; <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>, <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#acb5eba6d1ac568f316a5d6596f4e0452">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a>, <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#acb5eba6d1ac568f316a5d6596f4e0452">Index_t</a> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>) : <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html">Base</a>(<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>, <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a>, <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">size</a>) {}</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">  /*! Return type of operator[].</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">   * \details Data type of NdFlattener, but do also preserve constness.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html#aaa1b387b489ad57d1e867e6abec77fcb">LookupType</a> = <a class="code" href="code__config_8hpp.html#a32ca23e8acd5305690e2a6fc104f0610">su2conditional_t</a>&lt;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    std::is_const&lt;Nd_t&gt;::value,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keyword">const</span> <span class="keyword">typename</span> Nd_t::Data_t,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">typename</span> Nd_t::Data_t</div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a618d5a771ed3bc17f02d5ed49c8a0346">  352</a></span>&#160;  &gt;;</div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#aea341cf362faf74a8f75ea3c83d5d348">  353</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#aea341cf362faf74a8f75ea3c83d5d348">LookupType_const</a> = <span class="keyword">const</span> <span class="keyword">typename</span> Nd_t::Data_t;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">Base::nd</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">Base::offset</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">Base::size</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">Base::CheckBound</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  /*! \brief Return (possibly const) reference to the corresponding data element, checking if the index is in its range.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">   * Non-const version.</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">   * \details The returned reference is const if and only if the type of the accessed NdFlattener is const-qualified.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">   * Even though the original NdFlattener might be non-const, marking any IndexAccumulator as const during index look-up</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">   * will invoke the const version of operator[], which turns the NdFlattener type to const.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">   * \param[in] i - Last index.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a110e80ca4b0b468a6431e953c0492232">  366</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a618d5a771ed3bc17f02d5ed49c8a0346">LookupType</a>&amp; <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a110e80ca4b0b468a6431e953c0492232">operator[]</a>(<a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#acb5eba6d1ac568f316a5d6596f4e0452">Index_t</a> i) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">CheckBound</a>(i);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>.data()[<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a> + i];</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  }<span class="comment"></span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">  /*! \brief Return const reference to the corresponding data element, checking if the index is in its range.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">   * \param[in] i - Last index.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a64f730a5ffe82f88cc207aa14fcd57d5">  373</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#aea341cf362faf74a8f75ea3c83d5d348">LookupType_const</a>&amp; <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a64f730a5ffe82f88cc207aa14fcd57d5">operator[]</a>(<a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#acb5eba6d1ac568f316a5d6596f4e0452">Index_t</a> i)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">CheckBound</a>(i);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">nd</a>.data()[<a class="code" href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">offset</a> + i];</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">  /*! \brief Return (possibly const) pointer to data, non-const version.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">   * \details If all indices except the last one are fixed, the corresponding data</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">   * is stored contiguously. Return a pointer to the beginning of the</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">   * block. If this IndexAccumulator was generated from a non-const NdFlattener, the</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">   * pointer is non-const, otherwise it is const.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a7491f0bd14b5246e29a2642c33a70ef3">  384</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a618d5a771ed3bc17f02d5ed49c8a0346">LookupType</a>* <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a7491f0bd14b5246e29a2642c33a70ef3">data</a>() { <span class="keywordflow">return</span> &amp;(this-&gt;<a class="code" href="classhelpers_1_1IndexAccumulator.html#af1bc94cd0b38470779185612f5e47095">operator[]</a>(0)); }<span class="comment"></span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">  /*! \brief Return const pointer to data.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a957ebed19ca9fe06120860adc0f1880c">  387</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#aea341cf362faf74a8f75ea3c83d5d348">LookupType_const</a>* <a class="code" href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a957ebed19ca9fe06120860adc0f1880c">data</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> &amp;(this-&gt;<a class="code" href="classhelpers_1_1IndexAccumulator.html#af1bc94cd0b38470779185612f5e47095">operator[]</a>(0)); }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;};</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;}  <span class="comment">// namespace helpers</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"> * \class NdFlattener</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"> * \brief Serialize pointer-to-pointer-... array into one 1D array, keeping track</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"> * of the offsets in few additional 1D arrays.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"> * The pointer-to-pointer-... array can be provided by a nested lambda function</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"> * (&#39;recursive function&#39;) or by gathering such arrays from MPI processes (&#39;collective</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"> * communication&#39;). After initializing an NdFlattener with either of these data,</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"> * it can be refreshed in the same way after the the pointer-to-pointer-... array&#39;s</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"> * values (but not its structure) have changed.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"> * \tparam K - number of indices</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"> * \tparam Data_t - Type of stored array data</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"> * \tparam Index - Type of index</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">size_t</span> K_, <span class="keyword">typename</span> Data_t_, <span class="keyword">typename</span> Index_t_&gt;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keyword">class </span><a class="code" href="classNdFlattener.html">NdFlattener</a> : <span class="keyword">public</span> <a class="code" href="classNdFlattener.html">NdFlattener</a>&lt;K_ - 1, Data_t_, Index_t_&gt; {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">  411</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">size_t</span> <a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> = K_;</div>
<div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ace314cf70c1cbe21851e005c1458915c">  412</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener.html#ace314cf70c1cbe21851e005c1458915c">Data_t</a> = Data_t_;</div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">  413</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> = Index_t_;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classNdFlattener.html#afd311f85986580499c9f51461b3637b0">  415</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener.html">Base</a> = <a class="code" href="classNdFlattener.html">NdFlattener</a>&lt;<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1, <a class="code" href="classNdFlattener.html#ace314cf70c1cbe21851e005c1458915c">Data_t</a>, <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a>&gt;;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a9bfeda2bb726ef627873d06acd879198">  416</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener.html">CurrentLayer</a> = <a class="code" href="classNdFlattener.html">NdFlattener&lt;K, Data_t, Index_t&gt;</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="classNdFlattener.html#add14725068d3eaf719c28b03af9c1341">  417</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener.html#add14725068d3eaf719c28b03af9c1341">LowestLayer</a> = <span class="keyword">typename</span> <a class="code" href="classNdFlattener.html#add14725068d3eaf719c28b03af9c1341">Base::LowestLayer</a>;  <span class="comment">// the K=1 class</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">  /*! \brief Number of nodes in this layer.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">   * For the layer K=1, nNodes will be the number of data points.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">   * For a layer K&gt;1, nNodes will be the number of sublists.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> nNodes = 0;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">  /*! \brief Iterator used at construction, runs from 0 to (nNodes-1). */</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> iNode = 0;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">  /*! \brief Indices in the lower layer&#39;s indices or data array */</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  std::vector&lt;Index_t&gt; indices;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">/*=== Getters ===*/</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ac88d13be2ab15eb18a4ef3dcef422d61">  435</a></span>&#160;  <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a>* <a class="code" href="classNdFlattener.html#ac88d13be2ab15eb18a4ef3dcef422d61">GetIndices</a>() { <span class="keywordflow">return</span> indices.data(); }</div>
<div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ad43480bb6c51dc9db777aec958e77298">  436</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a>* <a class="code" href="classNdFlattener.html#ad43480bb6c51dc9db777aec958e77298">GetIndices</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> indices.data(); }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">/*=== Outputting ===*/</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">  /*! \brief Write in Python-list style.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">   * Like this: [[1, 2], [10, 20, 30]]</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ade5dd1b122b74f8a64fa8aac985ef971">  444</a></span>&#160;  <span class="keyword">friend</span> std::ostream&amp; <a class="code" href="classNdFlattener.html#ade5dd1b122b74f8a64fa8aac985ef971">operator&lt;&lt;</a>(std::ostream&amp; output, <a class="code" href="classNdFlattener.html">NdFlattener</a> <span class="keyword">const</span>&amp; nd) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    nd.<a class="code" href="classNdFlattener.html#ad6251f803250b964507d3f96e8dad259">toPythonString_fromto</a>(output, 0, nd.<a class="code" href="classNdFlattener.html#a2d463de26d5641654e00ab0bcfd4b871">size</a>());</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">  /*! \brief Write to stream in Python-list style, using the data of the</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">   * indices array between &#39;from&#39; (inclusive) and &#39;to&#39; (exclusive).</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">   * Like this: [[1, 2], [10, 20, 30]]</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">   * \param[in] output - Stream</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">   * \param[in] from - Beginning of the representation in the indices array.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">   * \param[in] to - Ending of the representation in the indices array.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ad6251f803250b964507d3f96e8dad259">  458</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#ad6251f803250b964507d3f96e8dad259">toPythonString_fromto</a>(std::ostream&amp; output, <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> from, <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> to)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    output &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> i = from; i &lt; to;) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <a class="code" href="classNdFlattener.html#ad6251f803250b964507d3f96e8dad259">Base::toPythonString_fromto</a>(output, indices[i], indices[i + 1]);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">if</span> (++i &lt; to) output &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    output &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">  /*! \brief Basic constructor. Afterwards, initialization can be done with initialize_or_refresh.</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">   * Called recursively when a derived class (higher K) is constructed.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a616bdd6ed50711c32570ab954c944028">  472</a></span>&#160;  <a class="code" href="classNdFlattener.html#a616bdd6ed50711c32570ab954c944028">NdFlattener</a>() {}</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">  /*! \brief Constructor which calls initialize_or_refresh.</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span>... ARGS&gt;</div>
<div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a910a18f5141706d40e64957ed1652ba5">  478</a></span>&#160;  <a class="code" href="classNdFlattener.html#a910a18f5141706d40e64957ed1652ba5">NdFlattener</a>(ARGS <span class="keyword">const</span>&amp;... args) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="classNdFlattener.html#a717d433dd817509475ec6d32527840cc">initialize_or_refresh</a>(args...);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">  /*! \brief Initialize or refresh the NdFlattener.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">   * \details Either a &#39;recursive function&#39; or &#39;collective communication&#39;</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">   * may be used. When the NdFlattener does not hold data yet, it is</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">   * initialized, meaning that the data are collected and the indices arrays</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">   * are allocated and filled. Otherwise it is refreshed, meaning that the data are</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">   * recollected under the assumption that the indices arrays did not change.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span>... ARGS&gt;</div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a717d433dd817509475ec6d32527840cc">  490</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#a717d433dd817509475ec6d32527840cc">initialize_or_refresh</a>(ARGS <span class="keyword">const</span>&amp;... args) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classNdFlattener.html#a9811243d5f091d113c29bc5d1c90b759">initialized</a>()) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <a class="code" href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">refresh</a>(args...);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <a class="code" href="classNdFlattener.html#a9fbea31e5e243896c09dba9e5be5e6ac">initialize</a>(args...);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">  /*! \brief Initialization status of the NdFlattener.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">   * \returns true if the NdFlattener has been initialized</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a9811243d5f091d113c29bc5d1c90b759">  501</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classNdFlattener.html#a9811243d5f091d113c29bc5d1c90b759">initialized</a>() { <span class="keywordflow">return</span> nNodes &gt; 0; }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">  /*! \brief Allocate the indices array after \a nNodes has been determined.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a155ca9cd82be124dccc5a0be154ff774">  506</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#a155ca9cd82be124dccc5a0be154ff774">allocate</a>() {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    indices.resize(nNodes + 1);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    indices[0] = 0;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="classNdFlattener.html#a155ca9cd82be124dccc5a0be154ff774">Base::allocate</a>();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">  /*! \brief Set \a iNode to 0 in all layers.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00514"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ad2d7ded575e35e08a4e94ba55d6f638a">  514</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#ad2d7ded575e35e08a4e94ba55d6f638a">reset_iNode</a>() {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    iNode = 0;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="classNdFlattener.html#ad2d7ded575e35e08a4e94ba55d6f638a">Base::reset_iNode</a>();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">/*=== Construct from &#39;recursive function&#39; ===*/</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">  /*! \brief Initialize from a &#39;recursive function&#39;.</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">   * The function should return a pair. Its first entry is the number of children.</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">   * Its second entry is a function with the same meaning, recursively</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">   * one layer down.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">   * \param f - the &#39;recursive function&#39;</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> f_type&gt;</div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a9fbea31e5e243896c09dba9e5be5e6ac">  529</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#a9fbea31e5e243896c09dba9e5be5e6ac">initialize</a>(f_type f) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="classNdFlattener.html#a88bbc4bff4bf4abfc28a86f3dffdd65b">count_f</a>(f);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="classNdFlattener.html#a155ca9cd82be124dccc5a0be154ff774">allocate</a>();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="classNdFlattener.html#a3ea01b92179b568eb451730fce25069f">set_f</a>(f, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">  /*! \brief Refresh the data according to the &#39;recursive function&#39;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">   * The NdFlattener must have been constructed with a &#39;recursive function&#39;.</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">   * Now refresh the values with another &#39;recursive function&#39;. The subarray lengths</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">   * resulting from both &#39;recursive functions&#39; must coincide, as the indices arrays</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">   * are not changed.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">   * \param f - the &#39;recursive function&#39;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">   * \tparam f_type - to allow for any type of the &#39;recursive function&#39;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> f_type&gt;</div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">  546</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">refresh</a>(f_type f) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="classNdFlattener.html#ad2d7ded575e35e08a4e94ba55d6f638a">reset_iNode</a>();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="classNdFlattener.html#a3ea01b92179b568eb451730fce25069f">set_f</a>(f, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  /*! \brief Determine the space required for reading the &#39;recursive function&#39;.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">   * \param f - the &#39;recursive function&#39;</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> f_type&gt;</div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a88bbc4bff4bf4abfc28a86f3dffdd65b">  557</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#a88bbc4bff4bf4abfc28a86f3dffdd65b">count_f</a>(f_type f) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> nChild = f.first;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> iChild = 0; iChild &lt; nChild; iChild++) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      nNodes++;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="classNdFlattener.html#a88bbc4bff4bf4abfc28a86f3dffdd65b">Base::count_f</a>(f.second(iChild));</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">  /*! \brief Read the &#39;recursive function&#39; into the allocated arrays.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">   * \param f - the &#39;recursive function&#39;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">   * \param refresh - if true, the object is already initialized and only the data</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">   *   in layer 1 have to be overwritten</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">   * \tparam f_type - to allow for any type of the &#39;recursive function&#39;</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> f_type&gt;</div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a3ea01b92179b568eb451730fce25069f">  573</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#a3ea01b92179b568eb451730fce25069f">set_f</a>(f_type f, <span class="keywordtype">bool</span> <a class="code" href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">refresh</a>) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> nChild = f.first;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> iChild = 0; iChild &lt; nChild; iChild++) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="classNdFlattener.html#a3ea01b92179b568eb451730fce25069f">Base::set_f</a>(f.second(iChild), <a class="code" href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">refresh</a>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">refresh</a>) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        indices[iNode + 1] = indices[iNode] + f.second(iChild).first;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">if</span> (indices[iNode + 1] != indices[iNode] + f.second(iChild).first) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <a class="code" href="classCBaseMPIWrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;NdFlattener: Structure has changed, cannot refresh.&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      iNode++;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">/*=== Construct with Allgatherv ===*/</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">  /*! \brief Initialize a flattener with K indices by combining distributed flatteners with (K-1) indices each.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">   * The new first index will encode the rank of the process. Data is exchanged in MPI::Allgatherv-style</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">   * collective communication.</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">   * \param[in] mpi_env - The MPI environment used for communication.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">   * \param[in] local_version - The local NdFlattener structure with (K-1) indices.</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MPI_Environment_type&gt;</div>
<div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ae83c8ff0ad27c44c29791390a649597f">  599</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#ae83c8ff0ad27c44c29791390a649597f">initialize</a>(MPI_Environment_type <span class="keyword">const</span>&amp; mpi_env, <a class="code" href="classNdFlattener.html">Base</a> <span class="keyword">const</span>&amp; local_version) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">// [k][r] is number of all nodes in layer (k+1), rank r in the new structure</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <a class="code" href="classC2DContainer.html">su2matrix&lt;Index_t&gt;</a> Nodes_all(<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a>, mpi_env.size);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// the first index decides on the rank, so there is exactly one node per rank</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; mpi_env.size; r++) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      nNodes += Nodes_all[<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1][r] = 1;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">// set the lower layers&#39; nNodes and Nodes_all[k]</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="classNdFlattener.html#a788fcaed14315925456293e99cafea6a">Base::count_g</a>(mpi_env, Nodes_all, local_version);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <a class="code" href="classNdFlattener.html#a155ca9cd82be124dccc5a0be154ff774">allocate</a>();</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    indices[0] = 0;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; mpi_env.size; r++) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      indices[r + 1] = indices[r] + Nodes_all[<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 2][r];</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="classNdFlattener.html#a6adfdfb5984bef7cc0b621424793caf8">Base::set_g</a>(mpi_env, Nodes_all, local_version);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">  /*! \brief Refresh the data by MPI collective communication.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">   * The NdFlattener must have been constructed by MPI collective communication.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">   * Now refresh the values with another collective communication. The subarray lengths</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">   * resulting from both collective communications must coincide, as the indices arrays</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">   * are not changed.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">   * \param[in] mpi_env - The MPI environment used for communication.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">   * \param[in] local_version - The local NdFlattener structure.</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MPI_Environment_type&gt;</div>
<div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ae1e23b255260eba213f5397100440cfb">  628</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#ae1e23b255260eba213f5397100440cfb">refresh</a>(MPI_Environment_type <span class="keyword">const</span>&amp; mpi_env, <a class="code" href="classNdFlattener.html">Base</a> <span class="keyword">const</span>&amp; local_version) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="classC2DContainer.html">su2matrix&lt;Index_t&gt;</a> Nodes_all_0(1, mpi_env.size);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    LowestLayer::count_g(mpi_env, Nodes_all_0, local_version);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    LowestLayer::set_g(mpi_env, Nodes_all_0, local_version);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">  /*! \brief Count the distributed flatteners&#39; numbers of nodes, and set nNodes.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">   * \param[in] mpi_env - MPI environment for communication</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">   * \param[out] Nodes_all - [k][r] is set to number of nodes in layer (k+1), rank r.</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">   * \param[in] local_version - local instance to be send to the other processes</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a788fcaed14315925456293e99cafea6a">  641</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#a788fcaed14315925456293e99cafea6a">count_g</a>(<a class="code" href="structNd__MPI__Environment.html">Nd_MPI_Environment</a> <span class="keyword">const</span>&amp; mpi_env, <a class="code" href="classC2DContainer.html">su2matrix&lt;Index_t&gt;</a>&amp; Nodes_all, <a class="code" href="classNdFlattener.html">CurrentLayer</a> <span class="keyword">const</span>&amp; local_version) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    nNodes = 0;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// gather numbers of nodes in the current layer from all processes</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    mpi_env.<a class="code" href="structNd__MPI__Environment.html#a747675f4eda0b8141fdcacba21db0f60">MPI_Allgather_fun</a>(&amp;(local_version.nNodes), 1, mpi_env.<a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>, Nodes_all[<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1], 1, mpi_env.<a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                              mpi_env.<a class="code" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">comm</a>);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>; r++) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      nNodes += Nodes_all[<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1][r];</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="classNdFlattener.html#a788fcaed14315925456293e99cafea6a">Base::count_g</a>(mpi_env, Nodes_all, local_version);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">  /*! \brief Gather the distributed flatteners&#39; data and index arrays into the allocated arrays.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">   * \param[in] mpi_env - MPI environment for communication</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">   * \param[in] Nodes_all - [k][r] is the number of nodes in layer (k+1), rank r.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">   * \param[in] local_version - local instance to be sent to the other processes</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a6adfdfb5984bef7cc0b621424793caf8">  658</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener.html#a6adfdfb5984bef7cc0b621424793caf8">set_g</a>(<a class="code" href="structNd__MPI__Environment.html">Nd_MPI_Environment</a> <span class="keyword">const</span>&amp; mpi_env, <a class="code" href="classC2DContainer.html">su2matrix&lt;Index_t&gt;</a> <span class="keyword">const</span>&amp; Nodes_all,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;             <a class="code" href="classNdFlattener.html">CurrentLayer</a> <span class="keyword">const</span>&amp; local_version) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    std::vector&lt;int&gt; Nodes_all_K_as_int(mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    std::vector&lt;int&gt; Nodes_all_k_cumulated( mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a> + 1);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">//&lt; [r] is the number of nodes in the current layer, summed over all processes with rank below r, **plus one**.</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// Used as displacements in Allgatherv, as we do not want to transfer the initial zeros, but we want to transfer the</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">// last element of indices, which is the local nNodes of the layer below. Note that MPI needs indices of type &#39;int&#39;.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    Nodes_all_k_cumulated[0] = 1;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>; r++) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      Nodes_all_k_cumulated[r + 1] = Nodes_all_k_cumulated[r] + Nodes_all[<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1][r];</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      Nodes_all_K_as_int[r] = Nodes_all[<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1][r];</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    mpi_env.<a class="code" href="structNd__MPI__Environment.html#a92c1196dd12e5c945114f2a7143006f5">MPI_Allgatherv_fun</a>(local_version.indices.data() + 1, Nodes_all[<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1][mpi_env.<a class="code" href="structNd__MPI__Environment.html#aeee6df4eaefd58ca614ec84247648538">rank</a>], mpi_env.<a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                               indices.data(), Nodes_all_K_as_int.data(), Nodes_all_k_cumulated.data(),</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                               mpi_env.<a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>, mpi_env.<a class="code" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">comm</a>);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// shift indices</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 1; r &lt; mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>; r++) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> first_entry_to_be_shifted = Nodes_all_k_cumulated[r];</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> last_entry_to_be_shifted = Nodes_all_k_cumulated[r + 1] - 1;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> shift = indices[first_entry_to_be_shifted - 1];</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> i = first_entry_to_be_shifted; i &lt;= last_entry_to_be_shifted; i++) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        indices[i] += shift;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="classNdFlattener.html#a6adfdfb5984bef7cc0b621424793caf8">Base::set_g</a>(mpi_env, Nodes_all, local_version);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="comment">/*== Data access ==*/</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00688"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a2d463de26d5641654e00ab0bcfd4b871">  688</a></span>&#160;  <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> <a class="code" href="classNdFlattener.html#a2d463de26d5641654e00ab0bcfd4b871">size</a>()<span class="keyword"> const </span>{  <span class="comment">// should not be called by recursion, is incorrect in lower layers!</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">return</span> nNodes;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">  /*! \brief Look-up with IndexAccumulator, non-const version.</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="classNdFlattener.html#a6a9a19053ee7af0ddd85511c6a84ae09">  694</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator.html">helpers::IndexAccumulator</a>&lt;<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1, <a class="code" href="classNdFlattener.html">NdFlattener</a>&lt;<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1, <a class="code" href="classNdFlattener.html#ace314cf70c1cbe21851e005c1458915c">Data_t</a>, <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a>&gt; &gt; <a class="code" href="classNdFlattener.html#a6a9a19053ee7af0ddd85511c6a84ae09">operator[]</a>(<a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> i0) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html">helpers::IndexAccumulator&lt;K, NdFlattener&lt;K, Data_t, Index_t&gt;</a> &gt;(*<span class="keyword">this</span>, 0, <a class="code" href="classNdFlattener.html#a2d463de26d5641654e00ab0bcfd4b871">size</a>())[i0];</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  }<span class="comment"></span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">  /*! \brief Look-up with IndexAccumulator, const version.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="classNdFlattener.html#ad7f7a4a5a99d0aaa715d570cf290bf68">  699</a></span>&#160;  <a class="code" href="classhelpers_1_1IndexAccumulator.html">helpers::IndexAccumulator</a>&lt;<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1, <span class="keyword">const</span> <a class="code" href="classNdFlattener.html">NdFlattener</a>&lt;<a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> - 1, <a class="code" href="classNdFlattener.html#ace314cf70c1cbe21851e005c1458915c">Data_t</a>, <a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a>&gt; &gt; <a class="code" href="classNdFlattener.html#ad7f7a4a5a99d0aaa715d570cf290bf68">operator[]</a>(<a class="code" href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">Index_t</a> i0)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhelpers_1_1IndexAccumulator.html">helpers::IndexAccumulator&lt;K, const NdFlattener&lt;K, Data_t, Index_t&gt;</a> &gt;(*<span class="keyword">this</span>, 0, <a class="code" href="classNdFlattener.html#a2d463de26d5641654e00ab0bcfd4b871">size</a>())[i0];</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;};</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Data_t_, <span class="keyword">typename</span> Index_t_&gt;</div>
<div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html">  705</a></span>&#160;<span class="keyword">class </span><a class="code" href="classNdFlattener.html">NdFlattener</a>&lt;1, Data_t_, Index_t_&gt; {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00707"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a47ef2fefe6ee2d72fc49208f6a4eb819">  707</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">size_t</span> <a class="code" href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">K</a> = 1;</div>
<div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a52efc5419bd133e84eb85d026565bb4a">  708</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a52efc5419bd133e84eb85d026565bb4a">Data_t</a> = Data_t_;</div>
<div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">  709</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> = Index_t_;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a96027fb225ce7a531c2d067852d5adfa">  711</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener.html">CurrentLayer</a> = <a class="code" href="classNdFlattener.html">NdFlattener&lt;1, Data_t, Index_t&gt;</a>;</div>
<div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a5eb3d74eeedac6557342de8fe5aed8cd">  712</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classNdFlattener.html">LowestLayer</a> = <a class="code" href="classNdFlattener.html#a9bfeda2bb726ef627873d06acd879198">CurrentLayer</a>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> nNodes = 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> iNode = 0;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  std::vector&lt;Data_t&gt; data_;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="comment">/*=== Outputting ===*/</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9985fc052db1844771c5f67aa730d422">  721</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9985fc052db1844771c5f67aa730d422">toPythonString_fromto</a>(std::ostream&amp; output, <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> from, <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> to)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    output &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> i = from; i &lt; to;) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      output &lt;&lt; data_[i];</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">if</span> (++i &lt; to) output &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    output &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#af41a3d1b6f98a67dbb955c2fe2243a17">  731</a></span>&#160;  <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#af41a3d1b6f98a67dbb955c2fe2243a17">NdFlattener</a>(<span class="keywordtype">void</span>) {}</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span>... ARGS&gt;</div>
<div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9df400fffc029b03d912f4860afc89c7">  734</a></span>&#160;  <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9df400fffc029b03d912f4860afc89c7">NdFlattener</a>(ARGS <span class="keyword">const</span>&amp;... args) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="classNdFlattener.html#a717d433dd817509475ec6d32527840cc">initialize_or_refresh</a>(args...);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span>... ARGS&gt;</div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a1ed58eba72715577c835b35128fe8540">  739</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a1ed58eba72715577c835b35128fe8540">initialize_or_refresh</a>(ARGS <span class="keyword">const</span>&amp;... args) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classNdFlattener.html#a9811243d5f091d113c29bc5d1c90b759">initialized</a>()) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">refresh</a>(args...);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <a class="code" href="classNdFlattener.html#a9fbea31e5e243896c09dba9e5be5e6ac">initialize</a>(args...);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a8905da79f0ea609f1417c14d3db63336">  747</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a8905da79f0ea609f1417c14d3db63336">initialized</a>() { <span class="keywordflow">return</span> nNodes &gt; 0; }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">// Functionality to initialize/refresh from a recursive function</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="comment">// could be desirable also for N=1, in order to gather from such</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">// NdFlatteners an NdFlattener with N=2.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// Gathering an NdFlattener with N=1 is not meaningful however.</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> f_type&gt;</div>
<div class="line"><a name="l00755"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#aef5dcd681c9b50870c37d0004707090a">  755</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#aef5dcd681c9b50870c37d0004707090a">initialize</a>(f_type f) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="classNdFlattener.html#a88bbc4bff4bf4abfc28a86f3dffdd65b">count_f</a>(f);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="classNdFlattener.html#a155ca9cd82be124dccc5a0be154ff774">allocate</a>();</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="classNdFlattener.html#a3ea01b92179b568eb451730fce25069f">set_f</a>(f, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> f_type&gt;</div>
<div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a079683b9cc112cdd655c0252e438247c">  762</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a079683b9cc112cdd655c0252e438247c">refresh</a>(f_type f) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <a class="code" href="classNdFlattener.html#ad2d7ded575e35e08a4e94ba55d6f638a">reset_iNode</a>();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <a class="code" href="classNdFlattener.html#a3ea01b92179b568eb451730fce25069f">set_f</a>(f, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#adb69d2887ccdba8d7f2f14c99c21be39">  768</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#adb69d2887ccdba8d7f2f14c99c21be39">allocate</a>() { data_.resize(nNodes); }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#ad51b91db8677fdfba4bb136be0beb1ad">  770</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#ad51b91db8677fdfba4bb136be0beb1ad">reset_iNode</a>() { iNode = 0; }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">/*=== Construct from &#39;recursive function&#39; ===*/</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> f_type&gt;</div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#abbc8389e20804222636bbac7f5acd09d">  775</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#abbc8389e20804222636bbac7f5acd09d">count_f</a>(f_type f) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    nNodes += f.first;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> f_type&gt;</div>
<div class="line"><a name="l00780"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a81321ed348a0514114ecf4a7bc539f0a">  780</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a81321ed348a0514114ecf4a7bc539f0a">set_f</a>(f_type f, <span class="keywordtype">bool</span> <a class="code" href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">refresh</a>) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> nChild = f.first;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> iChild = 0; iChild &lt; nChild; iChild++) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      data_[iNode] = f.second(iChild);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      iNode++;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="comment">/*=== Construct with Allgatherv ===*/</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00790"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9c9aa457f79b8b5bee2d4d55f9c9fb75">  790</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9c9aa457f79b8b5bee2d4d55f9c9fb75">count_g</a>(<a class="code" href="structNd__MPI__Environment.html">Nd_MPI_Environment</a> <span class="keyword">const</span>&amp; mpi_env, <a class="code" href="classC2DContainer.html">su2matrix&lt;Index_t&gt;</a>&amp; Nodes_all, <a class="code" href="classNdFlattener.html">CurrentLayer</a> <span class="keyword">const</span>&amp; local_version) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    nNodes = 0;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">// gather numbers of nodes in the current layer from all processes</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    mpi_env.<a class="code" href="structNd__MPI__Environment.html#a747675f4eda0b8141fdcacba21db0f60">MPI_Allgather_fun</a>(&amp;(local_version.nNodes), 1, mpi_env.<a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>, Nodes_all[0], 1, mpi_env.<a class="code" href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">mpi_index</a>,</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                              mpi_env.<a class="code" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">comm</a>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>; r++) {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      nNodes += Nodes_all[0][r];</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#ac44a8b46653f84b1371ef65e320886c2">  800</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#ac44a8b46653f84b1371ef65e320886c2">set_g</a>(<a class="code" href="structNd__MPI__Environment.html">Nd_MPI_Environment</a> <span class="keyword">const</span>&amp; mpi_env, <a class="code" href="classC2DContainer.html">su2matrix&lt;Index_t&gt;</a> <span class="keyword">const</span>&amp; Nodes_all,</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;             <a class="code" href="classNdFlattener.html">CurrentLayer</a> <span class="keyword">const</span>&amp; local_version) {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    std::vector&lt;int&gt; Nodes_all_0_as_int(mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    std::vector&lt;int&gt; Nodes_all_0_cumulated(mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a> + 1);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    Nodes_all_0_cumulated[0] = 0;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; mpi_env.<a class="code" href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">size</a>; r++) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      Nodes_all_0_cumulated[r + 1] = Nodes_all_0_cumulated[r] + Nodes_all[0][r];</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      Nodes_all_0_as_int[r] = Nodes_all[0][r];</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    mpi_env.<a class="code" href="structNd__MPI__Environment.html#a92c1196dd12e5c945114f2a7143006f5">MPI_Allgatherv_fun</a>(local_version.data_.data(), Nodes_all[0][mpi_env.<a class="code" href="structNd__MPI__Environment.html#aeee6df4eaefd58ca614ec84247648538">rank</a>], mpi_env.<a class="code" href="structNd__MPI__Environment.html#adac1c73261483bef70e172f3cf82e205">mpi_data</a>, data_.data(),</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                               Nodes_all_0_as_int.data(), Nodes_all_0_cumulated.data(), mpi_env.<a class="code" href="structNd__MPI__Environment.html#adac1c73261483bef70e172f3cf82e205">mpi_data</a>, mpi_env.<a class="code" href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">comm</a>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">/*== Access to data ==*/</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// Calling the following functions is a bit strange, because if you have only one level,</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">// you do not really benefit from NdFlattener&#39;s functionality.</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9b2f865322da41df47d55e0116d1c079">  818</a></span>&#160;  <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9b2f865322da41df47d55e0116d1c079">size</a>()<span class="keyword"> const </span>{  <span class="comment">// should not be called by recursion, is incorrect in lower layers!</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">return</span> nNodes;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  }<span class="comment"></span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">  /*! \brief Data look-up, non-const version.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00823"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a44bbbe5580037ff4ecae3e39a2592ab6">  823</a></span>&#160;  <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a52efc5419bd133e84eb85d026565bb4a">Data_t</a>&amp; <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a44bbbe5580037ff4ecae3e39a2592ab6">operator[]</a>(<a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> i0) { <span class="keywordflow">return</span> data_[i0]; }<span class="comment"></span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">  /*! \brief Data look-up, const version.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00826"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a8ee0926026a2b328268d8553acea872a">  826</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a52efc5419bd133e84eb85d026565bb4a">Data_t</a>&amp; <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a8ee0926026a2b328268d8553acea872a">operator[]</a>(<a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">Index_t</a> i0)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> data_[i0]; }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#aa19cc0dcefe3fc023a1b56dd26d05bbf">  828</a></span>&#160;  <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a52efc5419bd133e84eb85d026565bb4a">Data_t</a>* <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#aa19cc0dcefe3fc023a1b56dd26d05bbf">data</a>() { <span class="keywordflow">return</span> data_.data(); }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno"><a class="line" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a22a11787e88ba9a12c60a25b3e3a3bbf">  830</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a52efc5419bd133e84eb85d026565bb4a">Data_t</a>* <a class="code" href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a22a11787e88ba9a12c60a25b3e3a3bbf">data</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> data_.data(); }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;};</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">/// @}</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_ad51b91db8677fdfba4bb136be0beb1ad"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#ad51b91db8677fdfba4bb136be0beb1ad">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::reset_iNode</a></div><div class="ttdeci">void reset_iNode()</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00770">ndflattener.hpp:770</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a729649ff21ac665bd2a84a2eacdba931"><div class="ttname"><a href="structNd__MPI__Environment.html#a729649ff21ac665bd2a84a2eacdba931">Nd_MPI_Environment::MPI_Communicator_t</a></div><div class="ttdeci">typename SU2_MPI::Comm MPI_Communicator_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00221">ndflattener.hpp:221</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a7ee4e39a5fcbeaf454b5ec08bd6109bd"><div class="ttname"><a href="classCBaseMPIWrapper.html#a7ee4e39a5fcbeaf454b5ec08bd6109bd">CBaseMPIWrapper::Datatype</a></div><div class="ttdeci">int Datatype</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00492">mpi_structure.hpp:492</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_ab3fb64e44956577778fb71708c9ac649"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#ab3fb64e44956577778fb71708c9ac649">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::Nd_t</a></div><div class="ttdeci">Nd_t_ Nd_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00340">ndflattener.hpp:340</a></div></div>
<div class="ttc" id="aclassNdFlattener_html"><div class="ttname"><a href="classNdFlattener.html">NdFlattener</a></div><div class="ttdoc">Serialize pointer-to-pointer-... array into one 1D array, keeping track of the offsets in few additio...</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00208">ndflattener.hpp:208</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a616bdd6ed50711c32570ab954c944028"><div class="ttname"><a href="classNdFlattener.html#a616bdd6ed50711c32570ab954c944028">NdFlattener::NdFlattener</a></div><div class="ttdeci">NdFlattener()</div><div class="ttdoc">Basic constructor. Afterwards, initialization can be done with initialize_or_refresh.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00472">ndflattener.hpp:472</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_aa19cc0dcefe3fc023a1b56dd26d05bbf"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#aa19cc0dcefe3fc023a1b56dd26d05bbf">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::data</a></div><div class="ttdeci">Data_t * data()</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00828">ndflattener.hpp:828</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ad7f7a4a5a99d0aaa715d570cf290bf68"><div class="ttname"><a href="classNdFlattener.html#ad7f7a4a5a99d0aaa715d570cf290bf68">NdFlattener::operator[]</a></div><div class="ttdeci">helpers::IndexAccumulator&lt; K - 1, const NdFlattener&lt; K - 1, Data_t, Index_t &gt; &gt; operator[](Index_t i0) const</div><div class="ttdoc">Look-up with IndexAccumulator, const version.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00699">ndflattener.hpp:699</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_a6e314b95454b56a70cc16b215d2753ef"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#a6e314b95454b56a70cc16b215d2753ef">helpers::IndexAccumulator::IndexAccumulator</a></div><div class="ttdeci">IndexAccumulator(Nd_t &amp;nd, Index_t offset, Index_t size)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00296">ndflattener.hpp:296</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a588b8b0305d504a718ee6dd661d6e41f"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a588b8b0305d504a718ee6dd661d6e41f">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::Index_t</a></div><div class="ttdeci">Index_t_ Index_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00709">ndflattener.hpp:709</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a04457c47629bda56704e6a8804833eeb"><div class="ttname"><a href="classCBaseMPIWrapper.html#a04457c47629bda56704e6a8804833eeb">CBaseMPIWrapper::Error</a></div><div class="ttdeci">static void Error(std::string ErrorMsg, std::string FunctionName)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8cpp_source.html#l00114">mpi_structure.cpp:114</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html">helpers::IndexAccumulator</a></div><div class="ttdoc">Data structure holding an offset for the NdFlattener, to provide a []...[]-interface.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00289">ndflattener.hpp:289</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ade5dd1b122b74f8a64fa8aac985ef971"><div class="ttname"><a href="classNdFlattener.html#ade5dd1b122b74f8a64fa8aac985ef971">NdFlattener::operator&lt;&lt;</a></div><div class="ttdeci">friend std::ostream &amp; operator&lt;&lt;(std::ostream &amp;output, NdFlattener const &amp;nd)</div><div class="ttdoc">Write in Python-list style.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00444">ndflattener.hpp:444</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_a22e0e736af840f6aa5c2a8a869c5ea05"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#a22e0e736af840f6aa5c2a8a869c5ea05">helpers::IndexAccumulator_Base::nd</a></div><div class="ttdeci">Nd_t &amp; nd</div><div class="ttdoc">The accessed NdFlattener.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00274">ndflattener.hpp:274</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a747675f4eda0b8141fdcacba21db0f60"><div class="ttname"><a href="structNd__MPI__Environment.html#a747675f4eda0b8141fdcacba21db0f60">Nd_MPI_Environment::MPI_Allgather_fun</a></div><div class="ttdeci">MPI_Allgather_t MPI_Allgather_fun</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00226">ndflattener.hpp:226</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_adcb7c3fe6748862e59a173a903394c2d"><div class="ttname"><a href="structNd__MPI__Environment.html#adcb7c3fe6748862e59a173a903394c2d">Nd_MPI_Environment::mpi_index</a></div><div class="ttdeci">const MPI_Datatype_t mpi_index</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00224">ndflattener.hpp:224</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a44bbbe5580037ff4ecae3e39a2592ab6"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a44bbbe5580037ff4ecae3e39a2592ab6">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::operator[]</a></div><div class="ttdeci">Data_t &amp; operator[](Index_t i0)</div><div class="ttdoc">Data look-up, non-const version.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00823">ndflattener.hpp:823</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a8ee0926026a2b328268d8553acea872a"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a8ee0926026a2b328268d8553acea872a">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::operator[]</a></div><div class="ttdeci">const Data_t &amp; operator[](Index_t i0) const</div><div class="ttdoc">Data look-up, const version.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00826">ndflattener.hpp:826</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a5e5bef9fa01fba05a2812d2d2cbafc1c"><div class="ttname"><a href="structNd__MPI__Environment.html#a5e5bef9fa01fba05a2812d2d2cbafc1c">Nd_MPI_Environment::MPI_Allgatherv_t</a></div><div class="ttdeci">decltype(&amp;(SU2_MPI::Allgatherv)) MPI_Allgatherv_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00219">ndflattener.hpp:219</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a9df400fffc029b03d912f4860afc89c7"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9df400fffc029b03d912f4860afc89c7">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::NdFlattener</a></div><div class="ttdeci">NdFlattener(ARGS const &amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00734">ndflattener.hpp:734</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ac88d13be2ab15eb18a4ef3dcef422d61"><div class="ttname"><a href="classNdFlattener.html#ac88d13be2ab15eb18a4ef3dcef422d61">NdFlattener::GetIndices</a></div><div class="ttdeci">Index_t * GetIndices()</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00435">ndflattener.hpp:435</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a52efc5419bd133e84eb85d026565bb4a"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a52efc5419bd133e84eb85d026565bb4a">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::Data_t</a></div><div class="ttdeci">Data_t_ Data_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00708">ndflattener.hpp:708</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a079683b9cc112cdd655c0252e438247c"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a079683b9cc112cdd655c0252e438247c">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::refresh</a></div><div class="ttdeci">void refresh(f_type f)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00762">ndflattener.hpp:762</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a9fbea31e5e243896c09dba9e5be5e6ac"><div class="ttname"><a href="classNdFlattener.html#a9fbea31e5e243896c09dba9e5be5e6ac">NdFlattener::initialize</a></div><div class="ttdeci">void initialize(f_type f)</div><div class="ttdoc">Initialize from a 'recursive function'.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00529">ndflattener.hpp:529</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a8905da79f0ea609f1417c14d3db63336"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a8905da79f0ea609f1417c14d3db63336">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::initialized</a></div><div class="ttdeci">bool initialized()</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00747">ndflattener.hpp:747</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_aaa1b387b489ad57d1e867e6abec77fcb"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#aaa1b387b489ad57d1e867e6abec77fcb">helpers::IndexAccumulator::LookupType</a></div><div class="ttdeci">IndexAccumulator&lt; N - 1, Nd_Base_t &gt; LookupType</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00306">ndflattener.hpp:306</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_aba90beeb7c3861542f199d7dde450471"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#aba90beeb7c3861542f199d7dde450471">helpers::IndexAccumulator_Base::offset</a></div><div class="ttdeci">const Index_t offset</div><div class="ttdoc">Index in the currently accessed layer.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00275">ndflattener.hpp:275</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_a64f730a5ffe82f88cc207aa14fcd57d5"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a64f730a5ffe82f88cc207aa14fcd57d5">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::operator[]</a></div><div class="ttdeci">LookupType_const &amp; operator[](Index_t i) const</div><div class="ttdoc">Return const reference to the corresponding data element, checking if the index is in its range.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00373">ndflattener.hpp:373</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a717d433dd817509475ec6d32527840cc"><div class="ttname"><a href="classNdFlattener.html#a717d433dd817509475ec6d32527840cc">NdFlattener::initialize_or_refresh</a></div><div class="ttdeci">void initialize_or_refresh(ARGS const &amp;... args)</div><div class="ttdoc">Initialize or refresh the NdFlattener.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00490">ndflattener.hpp:490</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_a68d9c03ca0121d5a82c887ee5253d5f8"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#a68d9c03ca0121d5a82c887ee5253d5f8">helpers::IndexAccumulator::operator[]</a></div><div class="ttdeci">LookupType_const operator[](Index_t i) const</div><div class="ttdoc">Read one more index, const version.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00327">ndflattener.hpp:327</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html"><div class="ttname"><a href="classCBaseMPIWrapper.html">CBaseMPIWrapper</a></div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00489">mpi_structure.hpp:489</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a1c8c3f6d23fd0833c8cd8ef23b0beded"><div class="ttname"><a href="classCBaseMPIWrapper.html#a1c8c3f6d23fd0833c8cd8ef23b0beded">CBaseMPIWrapper::Allgatherv</a></div><div class="ttdeci">static void Allgatherv(const void *sendbuf, int sendcnt, Datatype sendtype, void *recvbuf, const int *recvcnt, const int *displs, Datatype recvtype, Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00571">mpi_structure.hpp:571</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a137ef06ade0c4f94d2a61f9b8817b6a7"><div class="ttname"><a href="classCBaseMPIWrapper.html#a137ef06ade0c4f94d2a61f9b8817b6a7">CBaseMPIWrapper::Allgather</a></div><div class="ttdeci">static void Allgather(const void *sendbuf, int sendcnt, Datatype sendtype, void *recvbuf, int recvcnt, Datatype recvtype, Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00576">mpi_structure.hpp:576</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a9b2f865322da41df47d55e0116d1c079"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9b2f865322da41df47d55e0116d1c079">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::size</a></div><div class="ttdeci">Index_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00818">ndflattener.hpp:818</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a84662874cf763c9001e3913fe20b3785"><div class="ttname"><a href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a></div><div class="ttdeci">#define CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00059">mpi_structure.hpp:59</a></div></div>
<div class="ttc" id="aclassC2DContainer_html"><div class="ttname"><a href="classC2DContainer.html">C2DContainer</a></div><div class="ttdoc">A templated matrix/vector-like object.</div><div class="ttdef"><b>Definition:</b> <a href="C2DContainer_8hpp_source.html#l00390">C2DContainer.hpp:390</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_a7491f0bd14b5246e29a2642c33a70ef3"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a7491f0bd14b5246e29a2642c33a70ef3">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::data</a></div><div class="ttdeci">LookupType * data()</div><div class="ttdoc">Return (possibly const) pointer to data, non-const version.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00384">ndflattener.hpp:384</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_abbc8389e20804222636bbac7f5acd09d"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#abbc8389e20804222636bbac7f5acd09d">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::count_f</a></div><div class="ttdeci">void count_f(f_type f)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00775">ndflattener.hpp:775</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ae83c8ff0ad27c44c29791390a649597f"><div class="ttname"><a href="classNdFlattener.html#ae83c8ff0ad27c44c29791390a649597f">NdFlattener::initialize</a></div><div class="ttdeci">void initialize(MPI_Environment_type const &amp;mpi_env, Base const &amp;local_version)</div><div class="ttdoc">Initialize a flattener with K indices by combining distributed flatteners with (K-1) indices each.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00599">ndflattener.hpp:599</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_abb3607a705cbb416e85e842c899ae294"><div class="ttname"><a href="classNdFlattener.html#abb3607a705cbb416e85e842c899ae294">NdFlattener::Index_t</a></div><div class="ttdeci">Index_t_ Index_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00413">ndflattener.hpp:413</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_adb69d2887ccdba8d7f2f14c99c21be39"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#adb69d2887ccdba8d7f2f14c99c21be39">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::allocate</a></div><div class="ttdeci">void allocate()</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00768">ndflattener.hpp:768</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a27d7320b99937d5cb8028ddac164c69a"><div class="ttname"><a href="classNdFlattener.html#a27d7320b99937d5cb8028ddac164c69a">NdFlattener::K</a></div><div class="ttdeci">static constexpr size_t K</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00411">ndflattener.hpp:411</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html">helpers::IndexAccumulator_Base</a></div><div class="ttdoc">Parent class of IndexAccumulator.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00263">ndflattener.hpp:263</a></div></div>
<div class="ttc" id="acode__config_8hpp_html_a724fb9f82013c782db5c3c12ea36aac8"><div class="ttname"><a href="code__config_8hpp.html#a724fb9f82013c782db5c3c12ea36aac8">FORCEINLINE</a></div><div class="ttdeci">#define FORCEINLINE</div><div class="ttdef"><b>Definition:</b> <a href="code__config_8hpp_source.html#l00036">code_config.hpp:36</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a88bbc4bff4bf4abfc28a86f3dffdd65b"><div class="ttname"><a href="classNdFlattener.html#a88bbc4bff4bf4abfc28a86f3dffdd65b">NdFlattener::count_f</a></div><div class="ttdeci">void count_f(f_type f)</div><div class="ttdoc">Determine the space required for reading the 'recursive function'.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00557">ndflattener.hpp:557</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a92c1196dd12e5c945114f2a7143006f5"><div class="ttname"><a href="structNd__MPI__Environment.html#a92c1196dd12e5c945114f2a7143006f5">Nd_MPI_Environment::MPI_Allgatherv_fun</a></div><div class="ttdeci">MPI_Allgatherv_t MPI_Allgatherv_fun</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00227">ndflattener.hpp:227</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_ad9da072d9031d972a6709e9d01c21c70"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#ad9da072d9031d972a6709e9d01c21c70">helpers::IndexAccumulator_Base&lt; N_, Nd_t_, false &gt;::Index_t</a></div><div class="ttdeci">typename Nd_t::Index_t Index_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00267">ndflattener.hpp:267</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a155ca9cd82be124dccc5a0be154ff774"><div class="ttname"><a href="classNdFlattener.html#a155ca9cd82be124dccc5a0be154ff774">NdFlattener::allocate</a></div><div class="ttdeci">void allocate()</div><div class="ttdoc">Allocate the indices array after nNodes has been determined.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00506">ndflattener.hpp:506</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_a110e80ca4b0b468a6431e953c0492232"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a110e80ca4b0b468a6431e953c0492232">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::operator[]</a></div><div class="ttdeci">LookupType &amp; operator[](Index_t i)</div><div class="ttdoc">Return (possibly const) reference to the corresponding data element, checking if the index is in its ...</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00366">ndflattener.hpp:366</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_a1e8b3bccb6aa73ca5c4a6beeb357f945"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#a1e8b3bccb6aa73ca5c4a6beeb357f945">helpers::IndexAccumulator::N</a></div><div class="ttdeci">static constexpr size_t N</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00292">ndflattener.hpp:292</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a1892851c55f2d14cf70491dbc7314dbf"><div class="ttname"><a href="structNd__MPI__Environment.html#a1892851c55f2d14cf70491dbc7314dbf">Nd_MPI_Environment::comm</a></div><div class="ttdeci">MPI_Communicator_t comm</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00225">ndflattener.hpp:225</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a22a11787e88ba9a12c60a25b3e3a3bbf"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a22a11787e88ba9a12c60a25b3e3a3bbf">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::data</a></div><div class="ttdeci">const Data_t * data() const</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00830">ndflattener.hpp:830</a></div></div>
<div class="ttc" id="acode__config_8hpp_html_a32ca23e8acd5305690e2a6fc104f0610"><div class="ttname"><a href="code__config_8hpp.html#a32ca23e8acd5305690e2a6fc104f0610">su2conditional_t</a></div><div class="ttdeci">typename su2conditional&lt; B, T, F &gt;::type su2conditional_t</div><div class="ttdef"><b>Definition:</b> <a href="code__config_8hpp_source.html#l00067">code_config.hpp:67</a></div></div>
<div class="ttc" id="anamespacehelpers_html"><div class="ttname"><a href="namespacehelpers.html">helpers</a></div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00245">ndflattener.hpp:245</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a788fcaed14315925456293e99cafea6a"><div class="ttname"><a href="classNdFlattener.html#a788fcaed14315925456293e99cafea6a">NdFlattener::count_g</a></div><div class="ttdeci">void count_g(Nd_MPI_Environment const &amp;mpi_env, su2matrix&lt; Index_t &gt; &amp;Nodes_all, CurrentLayer const &amp;local_version)</div><div class="ttdoc">Count the distributed flatteners' numbers of nodes, and set nNodes.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00641">ndflattener.hpp:641</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_aef5dcd681c9b50870c37d0004707090a"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#aef5dcd681c9b50870c37d0004707090a">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::initialize</a></div><div class="ttdeci">void initialize(f_type f)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00755">ndflattener.hpp:755</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_a957ebed19ca9fe06120860adc0f1880c"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a957ebed19ca9fe06120860adc0f1880c">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::data</a></div><div class="ttdeci">LookupType_const * data() const</div><div class="ttdoc">Return const pointer to data.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00387">ndflattener.hpp:387</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a6adfdfb5984bef7cc0b621424793caf8"><div class="ttname"><a href="classNdFlattener.html#a6adfdfb5984bef7cc0b621424793caf8">NdFlattener::set_g</a></div><div class="ttdeci">void set_g(Nd_MPI_Environment const &amp;mpi_env, su2matrix&lt; Index_t &gt; const &amp;Nodes_all, CurrentLayer const &amp;local_version)</div><div class="ttdoc">Gather the distributed flatteners' data and index arrays into the allocated arrays.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00658">ndflattener.hpp:658</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_aeee6df4eaefd58ca614ec84247648538"><div class="ttname"><a href="structNd__MPI__Environment.html#aeee6df4eaefd58ca614ec84247648538">Nd_MPI_Environment::rank</a></div><div class="ttdeci">const int rank</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00228">ndflattener.hpp:228</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_a28d9fe090295b2cb30c64e5acb666ffd"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#a28d9fe090295b2cb30c64e5acb666ffd">helpers::IndexAccumulator_Base::CheckBound</a></div><div class="ttdeci">void CheckBound(Index_t i) const</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00280">ndflattener.hpp:280</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_a1125e41e3be5dd428a51c880579c0a44"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#a1125e41e3be5dd428a51c880579c0a44">helpers::IndexAccumulator::Nd_t</a></div><div class="ttdeci">Nd_t_ Nd_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00293">ndflattener.hpp:293</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a9bfeda2bb726ef627873d06acd879198"><div class="ttname"><a href="classNdFlattener.html#a9bfeda2bb726ef627873d06acd879198">NdFlattener::CurrentLayer</a></div><div class="ttdeci">NdFlattener&lt; K, Data_t, Index_t &gt; CurrentLayer</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00416">ndflattener.hpp:416</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_aabaa772bf5f025fed63eb26e980a5ede"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#aabaa772bf5f025fed63eb26e980a5ede">helpers::IndexAccumulator_Base&lt; N_, Nd_t_, false &gt;::Nd_t</a></div><div class="ttdeci">Nd_t_ Nd_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00266">ndflattener.hpp:266</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_a0102c0ec97c5e2d73d8bd5fe47050859"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#a0102c0ec97c5e2d73d8bd5fe47050859">helpers::IndexAccumulator::Nd_Base_t</a></div><div class="ttdeci">su2conditional_t&lt; std::is_const&lt; Nd_t &gt;::value, const typename Nd_t::Base, typename Nd_t::Base &gt; Nd_Base_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00304">ndflattener.hpp:304</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ae1e23b255260eba213f5397100440cfb"><div class="ttname"><a href="classNdFlattener.html#ae1e23b255260eba213f5397100440cfb">NdFlattener::refresh</a></div><div class="ttdeci">void refresh(MPI_Environment_type const &amp;mpi_env, Base const &amp;local_version)</div><div class="ttdoc">Refresh the data by MPI collective communication.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00628">ndflattener.hpp:628</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_af1bc94cd0b38470779185612f5e47095"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#af1bc94cd0b38470779185612f5e47095">helpers::IndexAccumulator::operator[]</a></div><div class="ttdeci">LookupType operator[](Index_t i)</div><div class="ttdoc">Read one more index, checking whether it is in the range dictated by the NdFlattener and previous ind...</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00318">ndflattener.hpp:318</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ad43480bb6c51dc9db777aec958e77298"><div class="ttname"><a href="classNdFlattener.html#ad43480bb6c51dc9db777aec958e77298">NdFlattener::GetIndices</a></div><div class="ttdeci">const Index_t * GetIndices() const</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00436">ndflattener.hpp:436</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a544507655c2c099c6745cd0f69b5671b"><div class="ttname"><a href="structNd__MPI__Environment.html#a544507655c2c099c6745cd0f69b5671b">Nd_MPI_Environment::size</a></div><div class="ttdeci">const int size</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00229">ndflattener.hpp:229</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_a618d5a771ed3bc17f02d5ed49c8a0346"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a618d5a771ed3bc17f02d5ed49c8a0346">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::LookupType</a></div><div class="ttdeci">su2conditional_t&lt; std::is_const&lt; Nd_t &gt;::value, const typename Nd_t::Data_t, typename Nd_t::Data_t &gt; LookupType</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00352">ndflattener.hpp:352</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_af7c8104bafda520cf525f49c888bc48f"><div class="ttname"><a href="classCBaseMPIWrapper.html#af7c8104bafda520cf525f49c888bc48f">CBaseMPIWrapper::Comm</a></div><div class="ttdeci">int Comm</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00491">mpi_structure.hpp:491</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a3ea01b92179b568eb451730fce25069f"><div class="ttname"><a href="classNdFlattener.html#a3ea01b92179b568eb451730fce25069f">NdFlattener::set_f</a></div><div class="ttdeci">void set_f(f_type f, bool refresh)</div><div class="ttdoc">Read the 'recursive function' into the allocated arrays.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00573">ndflattener.hpp:573</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_adac1c73261483bef70e172f3cf82e205"><div class="ttname"><a href="structNd__MPI__Environment.html#adac1c73261483bef70e172f3cf82e205">Nd_MPI_Environment::mpi_data</a></div><div class="ttdeci">const MPI_Datatype_t mpi_data</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00223">ndflattener.hpp:223</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a9985fc052db1844771c5f67aa730d422"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9985fc052db1844771c5f67aa730d422">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::toPythonString_fromto</a></div><div class="ttdeci">void toPythonString_fromto(std::ostream &amp;output, Index_t from, Index_t to) const</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00721">ndflattener.hpp:721</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_ac44a8b46653f84b1371ef65e320886c2"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#ac44a8b46653f84b1371ef65e320886c2">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::set_g</a></div><div class="ttdeci">void set_g(Nd_MPI_Environment const &amp;mpi_env, su2matrix&lt; Index_t &gt; const &amp;Nodes_all, CurrentLayer const &amp;local_version)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00800">ndflattener.hpp:800</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a15dfd855910037c6669df56166afca35"><div class="ttname"><a href="structNd__MPI__Environment.html#a15dfd855910037c6669df56166afca35">Nd_MPI_Environment::MPI_Allgather_t</a></div><div class="ttdeci">decltype(&amp;(SU2_MPI::Allgather)) MPI_Allgather_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00218">ndflattener.hpp:218</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ad2d7ded575e35e08a4e94ba55d6f638a"><div class="ttname"><a href="classNdFlattener.html#ad2d7ded575e35e08a4e94ba55d6f638a">NdFlattener::reset_iNode</a></div><div class="ttdeci">void reset_iNode()</div><div class="ttdoc">Set iNode to 0 in all layers.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00514">ndflattener.hpp:514</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ad6251f803250b964507d3f96e8dad259"><div class="ttname"><a href="classNdFlattener.html#ad6251f803250b964507d3f96e8dad259">NdFlattener::toPythonString_fromto</a></div><div class="ttdeci">void toPythonString_fromto(std::ostream &amp;output, Index_t from, Index_t to) const</div><div class="ttdoc">Write to stream in Python-list style, using the data of the indices array between 'from' (inclusive) ...</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00458">ndflattener.hpp:458</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_af41a3d1b6f98a67dbb955c2fe2243a17"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#af41a3d1b6f98a67dbb955c2fe2243a17">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::NdFlattener</a></div><div class="ttdeci">NdFlattener(void)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00731">ndflattener.hpp:731</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html"><div class="ttname"><a href="structNd__MPI__Environment.html">Nd_MPI_Environment</a></div><div class="ttdoc">Contains information for the collective communication of NdFlatteners.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00217">ndflattener.hpp:217</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aafd1dc0086079e7904385538c54c9c8f"><div class="ttname"><a href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a></div><div class="ttdeci">#define MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00474">mpi_structure.hpp:474</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_a143c42e800fdef20ad10077f379c2c35"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#a143c42e800fdef20ad10077f379c2c35">helpers::IndexAccumulator::LookupType_const</a></div><div class="ttdeci">IndexAccumulator&lt; N - 1, const typename Nd_t::Base &gt; LookupType_const</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00308">ndflattener.hpp:308</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a9c9aa457f79b8b5bee2d4d55f9c9fb75"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a9c9aa457f79b8b5bee2d4d55f9c9fb75">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::count_g</a></div><div class="ttdeci">void count_g(Nd_MPI_Environment const &amp;mpi_env, su2matrix&lt; Index_t &gt; &amp;Nodes_all, CurrentLayer const &amp;local_version)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00790">ndflattener.hpp:790</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a2d463de26d5641654e00ab0bcfd4b871"><div class="ttname"><a href="classNdFlattener.html#a2d463de26d5641654e00ab0bcfd4b871">NdFlattener::size</a></div><div class="ttdeci">Index_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00688">ndflattener.hpp:688</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_a6cb84f17be07abd70bd068ae5a7dcd59"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#a6cb84f17be07abd70bd068ae5a7dcd59">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::IndexAccumulator</a></div><div class="ttdeci">IndexAccumulator(Nd_t &amp;nd, Index_t offset, Index_t size)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00343">ndflattener.hpp:343</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a74cf24b88c0a9b0ed7b8379b2c2ee01c"><div class="ttname"><a href="structNd__MPI__Environment.html#a74cf24b88c0a9b0ed7b8379b2c2ee01c">Nd_MPI_Environment::Nd_MPI_Environment</a></div><div class="ttdeci">Nd_MPI_Environment(MPI_Datatype_t mpi_data=4, MPI_Datatype_t mpi_index=1, MPI_Communicator_t comm=SU2_MPI::GetComm(), MPI_Allgather_t MPI_Allgather_fun=&amp;(SU2_MPI::Allgather), MPI_Allgatherv_t MPI_Allgatherv_fun=&amp;(SU2_MPI::Allgatherv))</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00231">ndflattener.hpp:231</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_ace314cf70c1cbe21851e005c1458915c"><div class="ttname"><a href="classNdFlattener.html#ace314cf70c1cbe21851e005c1458915c">NdFlattener::Data_t</a></div><div class="ttdeci">Data_t_ Data_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00412">ndflattener.hpp:412</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_aea341cf362faf74a8f75ea3c83d5d348"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#aea341cf362faf74a8f75ea3c83d5d348">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::LookupType_const</a></div><div class="ttdeci">const typename Nd_t::Data_t LookupType_const</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00353">ndflattener.hpp:353</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_a3971d1eaa7f489ab6f0f2e6ed70eb77c"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#a3971d1eaa7f489ab6f0f2e6ed70eb77c">helpers::IndexAccumulator_Base::size_</a></div><div class="ttdeci">const Index_t size_</div><div class="ttdoc">Exclusive upper bound for the next index.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00276">ndflattener.hpp:276</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4_html_acb5eba6d1ac568f316a5d6596f4e0452"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator_3_011_00_01Nd__t___00_01Check_01_4.html#acb5eba6d1ac568f316a5d6596f4e0452">helpers::IndexAccumulator&lt; 1, Nd_t_, Check &gt;::Index_t</a></div><div class="ttdeci">typename Nd_t::Index_t Index_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00341">ndflattener.hpp:341</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator_html_ae0b0b887cc8753c783008a261054feee"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator.html#ae0b0b887cc8753c783008a261054feee">helpers::IndexAccumulator::Index_t</a></div><div class="ttdeci">typename Nd_t::Index_t Index_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00294">ndflattener.hpp:294</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a8154391fc3522954802889d81d4ef5da"><div class="ttname"><a href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">CBaseMPIWrapper::GetComm</a></div><div class="ttdeci">static Comm GetComm()</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00517">mpi_structure.hpp:517</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_ab9b0848b12ce91efb3bbeddcc1978cb7"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#ab9b0848b12ce91efb3bbeddcc1978cb7">helpers::IndexAccumulator_Base::size</a></div><div class="ttdeci">Index_t size() const</div><div class="ttdoc">Return exclusive upper bound for next index.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00271">ndflattener.hpp:271</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a81321ed348a0514114ecf4a7bc539f0a"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a81321ed348a0514114ecf4a7bc539f0a">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::set_f</a></div><div class="ttdeci">void set_f(f_type f, bool refresh)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00780">ndflattener.hpp:780</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_a2a7f2fc38f34c71da37bd471cd092a41"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#a2a7f2fc38f34c71da37bd471cd092a41">helpers::IndexAccumulator_Base::N</a></div><div class="ttdeci">static constexpr size_t N</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00265">ndflattener.hpp:265</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a6a9a19053ee7af0ddd85511c6a84ae09"><div class="ttname"><a href="classNdFlattener.html#a6a9a19053ee7af0ddd85511c6a84ae09">NdFlattener::operator[]</a></div><div class="ttdeci">helpers::IndexAccumulator&lt; K - 1, NdFlattener&lt; K - 1, Data_t, Index_t &gt; &gt; operator[](Index_t i0)</div><div class="ttdoc">Look-up with IndexAccumulator, non-const version.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00694">ndflattener.hpp:694</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a910a18f5141706d40e64957ed1652ba5"><div class="ttname"><a href="classNdFlattener.html#a910a18f5141706d40e64957ed1652ba5">NdFlattener::NdFlattener</a></div><div class="ttdeci">NdFlattener(ARGS const &amp;... args)</div><div class="ttdoc">Constructor which calls initialize_or_refresh.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00478">ndflattener.hpp:478</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a61cde9075b8f5fdb19299fb0c356ff4a"><div class="ttname"><a href="classNdFlattener.html#a61cde9075b8f5fdb19299fb0c356ff4a">NdFlattener::refresh</a></div><div class="ttdeci">void refresh(f_type f)</div><div class="ttdoc">Refresh the data according to the 'recursive function'.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00546">ndflattener.hpp:546</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a9b2b3fcdfe74a7a8b6d98a14d92a4b43"><div class="ttname"><a href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a></div><div class="ttdeci">#define MPI_UNSIGNED_LONG</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00470">mpi_structure.hpp:470</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_a9811243d5f091d113c29bc5d1c90b759"><div class="ttname"><a href="classNdFlattener.html#a9811243d5f091d113c29bc5d1c90b759">NdFlattener::initialized</a></div><div class="ttdeci">bool initialized()</div><div class="ttdoc">Initialization status of the NdFlattener.</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00501">ndflattener.hpp:501</a></div></div>
<div class="ttc" id="aclasshelpers_1_1IndexAccumulator__Base_html_a4d91ccb17ceec5768e46ecf86d0c6681"><div class="ttname"><a href="classhelpers_1_1IndexAccumulator__Base.html#a4d91ccb17ceec5768e46ecf86d0c6681">helpers::IndexAccumulator_Base::IndexAccumulator_Base</a></div><div class="ttdeci">IndexAccumulator_Base(Nd_t &amp;nd, Index_t offset, Index_t size)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00278">ndflattener.hpp:278</a></div></div>
<div class="ttc" id="astructNd__MPI__Environment_html_a5169cfe6edb4111d6163bc9d1c0e64f9"><div class="ttname"><a href="structNd__MPI__Environment.html#a5169cfe6edb4111d6163bc9d1c0e64f9">Nd_MPI_Environment::MPI_Datatype_t</a></div><div class="ttdeci">typename SU2_MPI::Datatype MPI_Datatype_t</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00220">ndflattener.hpp:220</a></div></div>
<div class="ttc" id="aclassNdFlattener_html_add14725068d3eaf719c28b03af9c1341"><div class="ttname"><a href="classNdFlattener.html#add14725068d3eaf719c28b03af9c1341">NdFlattener::LowestLayer</a></div><div class="ttdeci">typename Base::LowestLayer LowestLayer</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00417">ndflattener.hpp:417</a></div></div>
<div class="ttc" id="aclassNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4_html_a1ed58eba72715577c835b35128fe8540"><div class="ttname"><a href="classNdFlattener_3_011_00_01Data__t___00_01Index__t___01_4.html#a1ed58eba72715577c835b35128fe8540">NdFlattener&lt; 1, Data_t_, Index_t_ &gt;::initialize_or_refresh</a></div><div class="ttdeci">void initialize_or_refresh(ARGS const &amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="ndflattener_8hpp_source.html#l00739">ndflattener.hpp:739</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4ab6b4cc6a7edbff49100e9123df213f.html">Common</a></li><li class="navelem"><a class="el" href="dir_92cb2900980f09bf257878861626e98f.html">include</a></li><li class="navelem"><a class="el" href="dir_c2bcda47e72dfcfa068320c4822b9fe0.html">toolboxes</a></li><li class="navelem"><a class="el" href="ndflattener_8hpp.html">ndflattener.hpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
