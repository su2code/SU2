<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Documentation: SU2_CFD/src/solvers/CFEM_DG_NSSolver.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoSU2small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('CFEM__DG__NSSolver_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CFEM_DG_NSSolver.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CFEM__DG__NSSolver_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * \file CFEM_DG_NSSolver.cpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * \brief Main subroutines for solving finite element Navier-Stokes flow problems</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * \author J. Alonso, E. van der Weide, T. Economon</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * \version 7.5.0 &quot;Blackbird&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * SU2 Project Website: https://su2code.github.io</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * The SU2 Project is maintained by the SU2 Foundation</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * (http://su2foundation.org)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Copyright 2012-2022, SU2 Contributors (cf. AUTHORS.md)</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * SU2 is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * SU2 is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * License along with SU2. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;../../include/solvers/CFEM_DG_NSSolver.hpp&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;../../../Common/include/toolboxes/printing_toolbox.hpp&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="CFEM__DG__NSSolver_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">   32</a></span>&#160;<span class="preprocessor">#define SIZE_ARR_NORM 8</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a29c1a5c8d0afd5b82ff19c6f6f64a75b">   34</a></span>&#160;<a class="code" href="classCFEM__DG__NSSolver.html#a29c1a5c8d0afd5b82ff19c6f6f64a75b">CFEM_DG_NSSolver::CFEM_DG_NSSolver</a>(<span class="keywordtype">void</span>) : <a class="code" href="classCFEM__DG__EulerSolver.html">CFEM_DG_EulerSolver</a>() {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">/*--- Basic array initialization ---*/</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  CD_Visc  = <span class="keyword">nullptr</span>; CL_Visc  = <span class="keyword">nullptr</span>; CSF_Visc = <span class="keyword">nullptr</span>; CEff_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  CMx_Visc = <span class="keyword">nullptr</span>; CMy_Visc = <span class="keyword">nullptr</span>; CMz_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  CFx_Visc = <span class="keyword">nullptr</span>; CFy_Visc = <span class="keyword">nullptr</span>; CFz_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">/*--- Surface-based array initialization ---*/</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  Surface_CL_Visc  = <span class="keyword">nullptr</span>; Surface_CD_Visc  = <span class="keyword">nullptr</span>; Surface_CSF_Visc = <span class="keyword">nullptr</span>; Surface_CEff_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  Surface_CFx_Visc = <span class="keyword">nullptr</span>; Surface_CFy_Visc = <span class="keyword">nullptr</span>; Surface_CFz_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  Surface_CMx_Visc = <span class="keyword">nullptr</span>; Surface_CMy_Visc = <span class="keyword">nullptr</span>; Surface_CMz_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  MaxHeatFlux_Visc = <span class="keyword">nullptr</span>; Heat_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">/*--- Set the SGS model to NULL and indicate that no SGS model is used. ---*/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  SGSModel     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  SGSModelUsed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#ac5a18ef33fc677c41a8f25d05eea1318">   52</a></span>&#160;<a class="code" href="classCFEM__DG__NSSolver.html#a29c1a5c8d0afd5b82ff19c6f6f64a75b">CFEM_DG_NSSolver::CFEM_DG_NSSolver</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; : <a class="code" href="classCFEM__DG__EulerSolver.html">CFEM_DG_EulerSolver</a>(geometry, config, iMesh) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">/*--- Array initialization ---*/</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  CD_Visc = <span class="keyword">nullptr</span>;  CL_Visc = <span class="keyword">nullptr</span>;  CSF_Visc = <span class="keyword">nullptr</span>; CEff_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  CMx_Visc = <span class="keyword">nullptr</span>; CMy_Visc = <span class="keyword">nullptr</span>; CMz_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  CFx_Visc = <span class="keyword">nullptr</span>; CFy_Visc = <span class="keyword">nullptr</span>; CFz_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  Surface_CL_Visc  = <span class="keyword">nullptr</span>; Surface_CD_Visc = <span class="keyword">nullptr</span>;  Surface_CSF_Visc = <span class="keyword">nullptr</span>; Surface_CEff_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  Surface_CFx_Visc = <span class="keyword">nullptr</span>; Surface_CFy_Visc = <span class="keyword">nullptr</span>; Surface_CFz_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  Surface_CMx_Visc = <span class="keyword">nullptr</span>; Surface_CMy_Visc = <span class="keyword">nullptr</span>; Surface_CMz_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  MaxHeatFlux_Visc = <span class="keyword">nullptr</span>; Heat_Visc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">/*--- Initialize the solution and right hand side vectors for storing</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">   the residuals and updating the solution (always needed even for</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">   explicit schemes). ---*/</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">//LinSysSol.Initialize(nPoint, nPointDomain, nVar, 0.0);</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//LinSysRes.Initialize(nPoint, nPointDomain, nVar, 0.0);</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">/*--- Non dimensional coefficients ---*/</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  CD_Visc       = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  CL_Visc       = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  CSF_Visc      = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  CMx_Visc      = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  CMy_Visc      = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  CMz_Visc      = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  CEff_Visc     = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  CFx_Visc      = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  CFy_Visc      = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  CFz_Visc      = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  Surface_CL_Visc   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  Surface_CD_Visc   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  Surface_CSF_Visc  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  Surface_CEff_Visc = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  Surface_CFx_Visc  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  Surface_CFy_Visc  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  Surface_CFz_Visc  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  Surface_CMx_Visc  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  Surface_CMy_Visc  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  Surface_CMz_Visc  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  Heat_Visc        = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  MaxHeatFlux_Visc = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">/*--- Init total coefficients ---*/</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a>   = 0.0; <a class="code" href="classCFEM__DG__EulerSolver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a>  = 0.0; <a class="code" href="classCFEM__DG__EulerSolver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a> = 0.0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a>  = 0.0; <a class="code" href="classCFEM__DG__EulerSolver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a> = 0.0; <a class="code" href="classCFEM__DG__EulerSolver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a> = 0.0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a> = 0.0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a>  = 0.0; <a class="code" href="classCFEM__DG__EulerSolver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a> = 0.0; <a class="code" href="classCFEM__DG__EulerSolver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a> = 0.0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">/*--- Read farfield conditions from config ---*/</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  Viscosity_Inf = config-&gt;<a class="code" href="classCConfig.html#a07714d2b67cf861cdb43891e2ff4f318">GetViscosity_FreeStreamND</a>();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  Prandtl_Lam   = config-&gt;<a class="code" href="classCConfig.html#a502035c2b049606186e11e01b7df626a">GetPrandtl_Lam</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  Prandtl_Turb  = config-&gt;<a class="code" href="classCConfig.html#a4b89ad15fa82f93ca8ccfe945e2c14a7">GetPrandtl_Turb</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  Tke_Inf       = config-&gt;<a class="code" href="classCConfig.html#a15b6f9a9ef3431c9478f68b6017b0137">GetTke_FreeStreamND</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">/*--- Set the SGS model in case an LES simulation is carried out ---*/</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">GetKind_Solver</a>() == <a class="code" href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1ca1369526eecb5ac5e6b2ee9b93a048f1e">MAIN_SOLVER::FEM_LES</a>) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">/* Make a distinction between the SGS models used and set SGSModel and</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">       SGSModelUsed accordingly. */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">switch</span>( config-&gt;<a class="code" href="classCConfig.html#a48a38b37dada9393fa8288e6b0a09b3e">GetKind_SGS_Model</a>() ) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a0abcea8fd4c94005a730427882d6e1d0afb51ccd07d6c26673745aa0ae14c4a85">TURB_SGS_MODEL::IMPLICIT_LES</a>:</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        SGSModel     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        SGSModelUsed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a0abcea8fd4c94005a730427882d6e1d0a6a2d09f749cfe603633b071dbecf4a7f">TURB_SGS_MODEL::SMAGORINSKY</a>:</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        SGSModel     = <span class="keyword">new</span> <a class="code" href="classCSmagorinskyModel.html">CSmagorinskyModel</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        SGSModelUsed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a0abcea8fd4c94005a730427882d6e1d0a7192fae7ec327c8d281dfe19e94d4e72">TURB_SGS_MODEL::WALE</a>:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        SGSModel     = <span class="keyword">new</span> <a class="code" href="classCWALEModel.html">CWALEModel</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        SGSModelUsed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a0abcea8fd4c94005a730427882d6e1d0a37768dcf184b83625cab7709c591e0ec">TURB_SGS_MODEL::VREMAN</a>:</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        SGSModel     = <span class="keyword">new</span> <a class="code" href="classCVremanModel.html">CVremanModel</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        SGSModelUsed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="classCBaseMPIWrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Unknown SGS model encountered&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">/* No LES, so no SGS model needed.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">       Set the pointer to NULL and the boolean to false. */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    SGSModel     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    SGSModelUsed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a166cf9167fb8c2e9fa95a0c300593d3d">  153</a></span>&#160;<a class="code" href="classCFEM__DG__NSSolver.html#a166cf9167fb8c2e9fa95a0c300593d3d">CFEM_DG_NSSolver::~CFEM_DG_NSSolver</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keyword">delete</span> [] CD_Visc;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keyword">delete</span> [] CL_Visc;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;       <span class="keyword">delete</span> [] CSF_Visc;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;       <span class="keyword">delete</span> [] CMx_Visc;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;       <span class="keyword">delete</span> [] CMy_Visc;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;       <span class="keyword">delete</span> [] CMz_Visc;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;       <span class="keyword">delete</span> [] CFx_Visc;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;       <span class="keyword">delete</span> [] CFy_Visc;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       <span class="keyword">delete</span> [] CFz_Visc;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keyword">delete</span> [] CEff_Visc;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">delete</span> [] Surface_CL_Visc;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keyword">delete</span> [] Surface_CD_Visc;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keyword">delete</span> [] Surface_CSF_Visc;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keyword">delete</span> [] Surface_CEff_Visc;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="keyword">delete</span> [] Surface_CFx_Visc;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keyword">delete</span> [] Surface_CFy_Visc;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="keyword">delete</span> [] Surface_CFz_Visc;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="keyword">delete</span> [] Surface_CMx_Visc;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <span class="keyword">delete</span> [] Surface_CMy_Visc;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keyword">delete</span> [] Surface_CMz_Visc;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keyword">delete</span> [] Heat_Visc;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="keyword">delete</span> [] MaxHeatFlux_Visc;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keyword">delete</span> SGSModel;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a5118d674e7eb6f4865fb53f6f20eac1c">  183</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a5118d674e7eb6f4865fb53f6f20eac1c">CFEM_DG_NSSolver::Friction_Forces</a>(<span class="keyword">const</span> <a class="code" href="classCGeometry.html">CGeometry</a>* geometry, <span class="keyword">const</span> <a class="code" href="classCConfig.html">CConfig</a>* config) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">/* Allocate the memory for the work array and initialize it to zero to avoid</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">     warnings in debug mode  about uninitialized memory when padding is applied. */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  vector&lt;su2double&gt; workArrayVec(<a class="code" href="classCFEM__DG__EulerSolver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a>, 0.0);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *workArray = workArrayVec.data();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">/*--- The skin friction is computed using the laminar viscosity and      ---*/</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">/*--- velocity gradients. This is correct when integration to the wall   ---*/</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">/*--- is performed, but not when wall functions are used. Hence, this    ---*/</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">/*--- function must be modified when wall functions are implemented.     ---*/</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector. */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">/*--- Get the information of the angle of attack, reference area, etc. ---*/</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Alpha        = config-&gt;<a class="code" href="classCConfig.html#aa824c1a1b3c7cd05b7be414a76e0b250">GetAoA</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Beta         = config-&gt;<a class="code" href="classCConfig.html#a25bfd5255f84135494ca2c368a848f98">GetAoS</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefLength    = config-&gt;<a class="code" href="classCConfig.html#afe9547710c70982ff9eee4504e3c4a69">GetRefLength</a>();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keyword">auto</span> Origin      = config-&gt;<a class="code" href="classCConfig.html#a67306b97ff437e1b9939c3f8561c6e4a">GetRefOriginMoment</a>(0);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">/*--- Evaluate reference values for non-dimensionalization. ---*/</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefHeatFlux = config-&gt;<a class="code" href="classCConfig.html#ab99f4c81b2b9dd7e4b0f917ad8c5e829">GetHeat_Flux_Ref</a>();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factor = 1.0 / <a class="code" href="classCFEM__DG__EulerSolver.html#ae13c22d84e920bba7ea932eead5c3baf">AeroCoeffForceRef</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">/*--- Variables initialization ---*/</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  AllBound_CD_Visc = 0.0;  AllBound_CL_Visc  = 0.0; AllBound_CSF_Visc = 0.0;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  AllBound_CMx_Visc = 0.0; AllBound_CMy_Visc = 0.0; AllBound_CMz_Visc = 0.0;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  AllBound_CFx_Visc = 0.0; AllBound_CFy_Visc = 0.0; AllBound_CFz_Visc = 0.0;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  AllBound_HeatFlux_Visc = 0.0; AllBound_MaxHeatFlux_Visc = 0.0; AllBound_CEff_Visc = 0.0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); ++iMarker_Monitoring) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    Surface_CL_Visc[iMarker_Monitoring]  = 0.0; Surface_CD_Visc[iMarker_Monitoring]   = 0.0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    Surface_CSF_Visc[iMarker_Monitoring] = 0.0; Surface_CEff_Visc[iMarker_Monitoring] = 0.0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    Surface_CFx_Visc[iMarker_Monitoring] = 0.0; Surface_CFy_Visc[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    Surface_CFz_Visc[iMarker_Monitoring] = 0.0; Surface_CMx_Visc[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    Surface_CMy_Visc[iMarker_Monitoring] = 0.0; Surface_CMz_Visc[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">/*--- Loop over the Navier-Stokes markers ---*/</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker=0; iMarker&lt;<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; ++iMarker) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">/* Check if this boundary must be monitored. */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Monitoring = config-&gt;<a class="code" href="classCConfig.html#a70fa75374f533da62b71207d589d6211">GetMarker_All_Monitoring</a>(iMarker);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span>(Monitoring == <a class="code" href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885a99f136a862ba5c7d16967231c29f09d6">YES</a>) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">/* Easier storage of the boundary condition. */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Boundary = config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">/*--- Obtain the origin for the moment computation for a particular marker ---*/</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                       ++iMarker_Monitoring) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordtype">string</span> Monitoring_Tag = config-&gt;<a class="code" href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">GetMarker_Monitoring_TagBound</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordtype">string</span> Marker_Tag     = config-&gt;<a class="code" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(iMarker);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span> (Marker_Tag == Monitoring_Tag)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          Origin = config-&gt;<a class="code" href="classCConfig.html#a67306b97ff437e1b9939c3f8561c6e4a">GetRefOriginMoment</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="comment">/* Check for a boundary for which the viscous forces must be computed. */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">if</span>((Boundary == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) || (Boundary == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>)) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">/*--- Determine the prescribed heat flux or prescribed temperature. ---*/</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordtype">bool</span> HeatFlux_Prescribed = <span class="keyword">false</span>, Temperature_Prescribed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Wall_HeatFlux = 0.0, Wall_Temperature = 0.0;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(iMarker);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">if</span>(Boundary == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          HeatFlux_Prescribed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          Wall_HeatFlux       = config-&gt;<a class="code" href="classCConfig.html#a61a5154012543ac7d95929ddc6b79950">GetWall_HeatFlux</a>(Marker_Tag);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          Temperature_Prescribed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          Wall_Temperature       = config-&gt;<a class="code" href="classCConfig.html#a2bf56370670128e9e93af4ed3a7e2bb7">GetIsothermal_Temperature</a>(Marker_Tag)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                 / config-&gt;<a class="code" href="classCConfig.html#a218d027f78cd801a8734a2d4581591ad">GetTemperature_Ref</a>();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">/*--- Forces initialization at each Marker ---*/</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        CD_Visc[iMarker]  = 0.0; CL_Visc[iMarker]  = 0.0; CSF_Visc[iMarker] = 0.0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        CMx_Visc[iMarker] = 0.0; CMy_Visc[iMarker] = 0.0; CMz_Visc[iMarker] = 0.0;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        CFx_Visc[iMarker] = 0.0; CFy_Visc[iMarker] = 0.0; CFz_Visc[iMarker] = 0.0;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        Heat_Visc[iMarker]  = 0.0; MaxHeatFlux_Visc[iMarker] = 0.0; CEff_Visc[iMarker] = 0.0;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ForceViscous[]  = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MomentViscous[] = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">/* Easier storage of the boundary faces for this boundary marker. */</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      nSurfElem = <a class="code" href="classCFEM__DG__EulerSolver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="structCBoundaryFEM.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.size();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem = <a class="code" href="classCFEM__DG__EulerSolver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="structCBoundaryFEM.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.data();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">/* Check if a wall treatment is used. */</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classCFEM__DG__EulerSolver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].wallModel ) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          <span class="comment">/*--- Wall treatment is used, so the wall shear stress and heat flux</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">                are computed using the wall model. As the interpolation of data</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">                of the exchange point is different for each element, it is not</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">                possible to treat multiple faces simultaneously. So here just</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">                a loop over the number of faces is carried out. ---*/</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;nSurfElem; ++l) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">/* Get the required information from the corresponding standard face. */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *weights  = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="comment">/* Loop over the donors for this boundary face. */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a7a048944dcc446cbc2fc2128bfa425cc">donorsWallFunction</a>.size(); ++j) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;              <span class="comment">/* Easier storage of the element ID of the donor and set the pointer</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">                 where the solution of this element starts. Note that VecWorkSolDOFs</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">                 must be used and not VecSolDOFs, because it is possible that a donor</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">                 is a halo element, which are not stored in VecSolDOFs. */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  donorID   = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a7a048944dcc446cbc2fc2128bfa425cc">donorsWallFunction</a>[j];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="classCVolumeElementFEM.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFsElem   = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                             + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;              <span class="comment">/* Determine the number of integration points for this donor and</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">                 interpolate the solution for the corresponding exchange points. */</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nIntThisDonor = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j+1]</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                                 - surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j];</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;              <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nIntThisDonor, <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, nDOFsElem, surfElem[l].matWallFunctionDonor[j].data(),</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                  solDOFsElem, workArray, config);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;              <span class="comment">/* Loop over the integration points for this donor element. */</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=surfElem[l].nIntPerWallFunctionDonor[j];</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                 i&lt;surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j+1]; ++i) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="comment">/* Easier storage of the actual integration point. */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aa6f58573b6ae42747d3e98e1497d76f1">intPerWallFunctionDonor</a>[i];</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="comment">/* Determine the normal, wall velocity and coordinates</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">                   for this integration point. */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normals = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + ii*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + ii*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Coord   = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data() + ii*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="comment">/* Determine the velocities and pressure in the exchange point. */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solInt = workArray</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                        + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(i-surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j]);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv = 1.0/solInt[0];</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel[]  = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k] = rhoInv*solInt[k+1];</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel2Mag = vel[0]*vel[0] + vel[1]*vel[1] + vel[2]*vel[2];</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> eInt    = rhoInv*solInt[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] - 0.5*vel2Mag;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(solInt[0], eInt);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Pressure = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">GetPressure</a>();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Temperature = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ab7651562ac98477a1f3ae39832a4ffb1">GetTemperature</a>();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> LaminarViscosity= <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="comment">/* Subtract the prescribed wall velocity, i.e. grid velocity</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">                   from the velocity in the exchange point. */</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k] -= gridVel[k];</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="comment">/* Determine the tangential velocity by subtracting the normal</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">                   velocity component. */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velNorm = 0.0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) velNorm += normals[k]*vel[k];</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k]  -= normals[k]*velNorm;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="comment">/* Determine the magnitude of the tangential velocity as well</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">                   as its direction (unit vector). */</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velTan = <a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(vel[0]*vel[0] + vel[1]*vel[1] + vel[2]*vel[2]);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                velTan = max(velTan,1.e-25);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dirTan[] = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) dirTan[k] = vel[k]/velTan;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="comment">/* Compute the wall shear stress and heat flux vector using</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">                   the wall model. */</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauWall, qWall, ViscosityWall, kOverCvWall;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <a class="code" href="classCFEM__DG__EulerSolver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="structCBoundaryFEM.html#adfdf6282092e74ca678b522fad104a7b">wallModel</a>-&gt;<a class="code" href="classCWallModel.html#aa97d804c3e84dddab5c3e16b5996b16a">WallShearStressAndHeatFlux</a>(Temperature, velTan,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                                                          LaminarViscosity, Pressure,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                                                          Wall_HeatFlux, HeatFlux_Prescribed,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                                                          Wall_Temperature, Temperature_Prescribed,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                                          <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>, tauWall, qWall,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                                          ViscosityWall, kOverCvWall);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="comment">/* Update the viscous forces and moments. Note that the force direction</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">                   is the direction of the tangential velocity. */</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dForceMag = tauWall*weights[ii]*normals[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*factor;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dForces[] = {0.0, 0.0, 0.0}, dCoor[] = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                  dCoor[k]         = Coord[k] - Origin[k];</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                  dForces[k]       = dForceMag*dirTan[k];</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                  ForceViscous[k] += dForces[k];</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                  MomentViscous[2] += (dForces[1]*dCoor[0] - dForces[0]*dCoor[1])/RefLength;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                  MomentViscous[0] += (dForces[2]*dCoor[1] - dForces[1]*dCoor[2])/RefLength;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                  MomentViscous[1] += (dForces[0]*dCoor[2] - dForces[2]*dCoor[0])/RefLength;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                  MomentViscous[2] += (dForces[1]*dCoor[0] - dForces[0]*dCoor[1])/RefLength;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <span class="comment">/* Update the heat flux and maximum heat flux for this marker. */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                Heat_Visc[iMarker]       += qWall*weights[i]*normals[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                MaxHeatFlux_Visc[iMarker] = max(MaxHeatFlux_Visc[iMarker], fabs(qWall));</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;              }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <span class="comment">/*--- Integration to the wall is used so the wall data must be computed.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">                Loop over the faces of this boundary. Multiple faces are treated</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">                simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">                multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">                happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;nSurfElem;) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">               N value in the gemm computations. */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, nSurfElem, nFaceSimul,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="comment">/* Get the required information from the corresponding standard face. */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt      = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *basisFace     = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#a19d1d508495d95239567972e425fd0c3">GetBasisFaceIntegration</a>();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *derBasisElem  = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#abd2f5656593a34508bdfb2093a1d6f92">GetMatDerBasisElemIntegration</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *weights       = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="comment">/* Set the pointers for the local work arrays. */</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solInt     = workArray;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradSolInt = solInt     + NPad*nInt;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solCopy    = gradSolInt + NPad*nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;              <span class="comment">/* Easier storage of the DOFs of the face. */</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFs = surfElem[l+ll].<a class="code" href="structCSurfaceElementFEM.html#aee91841e533b10cdbe3b3b09e98e3695">DOFsSolFace</a>.data();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;              <span class="comment">/* Copy the solution of the DOFs of the face such that it is</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">                 contiguous in memory. */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace; ++i) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF = <a class="code" href="classCFEM__DG__EulerSolver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*DOFs[i];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *sol    = solCopy + NPad*i + llNVar;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                  sol[mm] = solDOF[mm];</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="comment">/* Call the general function to carry out the matrix product to determine</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">               the solution in the integration points. */</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt, NPad, nDOFsFace, basisFace, solCopy, solInt, config);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="comment">/*--- Store the solution of the DOFs of the adjacent elements in contiguous</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">                  memory such that the function blasFunctions-&gt;gemm can be used to compute</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">                  the gradients solution variables in the integration points of the face. ---*/</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem; ++i) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF = <a class="code" href="classCFEM__DG__EulerSolver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#abdf9f21e0435e853d60d7faeecbb5e2f">DOFsSolElement</a>[i];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *sol    = solCopy + NPad*i + llNVar;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                  sol[mm] = solDOF[mm];</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;              }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="comment">/* Compute the gradients in the integration points. Call the general function to</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">               carry out the matrix product. */</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem, derBasisElem, solCopy, gradSolInt, config);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="comment">/* Determine the offset between r- and -s-derivatives, which is also the</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">               offset between s- and t-derivatives. */</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">               in order to have the most efficient code. */</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">switch</span>( <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;              <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="comment">/* Two dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">                   simultaneously. */</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                  <span class="comment">/* Loop over the integration points of this surface element. */</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    <span class="comment">/* Easier storage of the solution, its gradients, the normals,</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">                       the metric terms and the coordinates of this integration point. */</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol         = solInt     + i*NPad + llNVar;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDr    = gradSolInt + i*NPad + llNVar;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDs    = solDOFDr   + offDeriv;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normals     = surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data()</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                                 + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#a49f9ee99ed3a8a6c5c895050f29169d8">metricCoorDerivFace</a>.data()</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                                 + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Coord       = surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data()</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                                 + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    <span class="comment">/* Easier storage of the metric terms. */</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = metricTerms[2];</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = metricTerms[3];</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    <span class="comment">/* Compute the Cartesian gradients of the solution. */</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdx  = solDOFDr[3]*drdx + solDOFDs[3]*dsdx;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdy  = solDOFDr[3]*drdy + solDOFDs[3]*dsdy;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    <span class="comment">/* Compute the velocities and static energy in this</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">                       integration point. */</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv   = 1.0/sol[0];</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = DensityInv*sol[1];</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = DensityInv*sol[2];</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = DensityInv*sol[3];</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    <span class="comment">/* Compute the Cartesian gradients of the velocities and</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">                       static energy in this integration point and also the</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">                       divergence of the velocity. */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = DensityInv*(drudx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = DensityInv*(drudy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = DensityInv*(drvdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = DensityInv*(drvdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergydx = DensityInv*(drEdx - TotalEnergy*drhodx)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                                    - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergydy = DensityInv*(drEdy - TotalEnergy*drhody)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                                    - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> divVel = dudx + dvdy;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    <span class="comment">/* Compute the laminar viscosity. */</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    <span class="comment">/* Set the value of the second viscosity and compute the</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">                       divergence term in the viscous normal stresses. */</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*ViscosityLam;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    <span class="comment">/* Compute the viscous stress tensor and the normal flux.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">                       Note that there is a plus sign for the heat flux, because</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">                       the normal points into the geometry. */</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxx = 2.0*ViscosityLam*dudx + lamDivTerm;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyy = 2.0*ViscosityLam*dvdy + lamDivTerm;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxy = ViscosityLam*(dudy + dvdx);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qHeatNorm = ViscosityLam*factHeatFlux_Lam</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                              * (dStaticEnergydx*normals[0]</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                              +  dStaticEnergydy*normals[1]);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    <span class="comment">/* Update the viscous force and moment. Note that the normal</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">                       points into the geometry, hence the minus sign for the stress. */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> scaleFac =  weights[i]*normals[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*factor;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Fx       = -scaleFac*(tauxx*normals[0] + tauxy*normals[1]);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Fy       = -scaleFac*(tauxy*normals[0] + tauyy*normals[1]);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                    ForceViscous[0] += Fx;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    ForceViscous[1] += Fy;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dx = Coord[0] - Origin[0];</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dy = Coord[1] - Origin[1];</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                    MomentViscous[2] += (Fy*dx - Fx*dy)/RefLength;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    <span class="comment">/* Update the heat flux and maximum heat flux for this marker. */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    Heat_Visc[iMarker] += qHeatNorm*weights[i]*normals[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*RefHeatFlux;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                    MaxHeatFlux_Visc[iMarker] = max(MaxHeatFlux_Visc[iMarker], fabs(qHeatNorm));</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                  }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;              }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;              <span class="comment">/*------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;              <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                <span class="comment">/* Three dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">                   simultaneously. */</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                  <span class="comment">/* Loop over the integration points of this surface element. */</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                    <span class="comment">/* Easier storage of the solution, its gradients, the normals,</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">                       the metric terms and the coordinates of this integration point. */</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol         = solInt     + i*NPad + llNVar;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDr    = gradSolInt + i*NPad + llNVar;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDs    = solDOFDr   + offDeriv;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDt    = solDOFDs   + offDeriv;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normals     = surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data()</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                                 + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#a49f9ee99ed3a8a6c5c895050f29169d8">metricCoorDerivFace</a>.data()</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                                 + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Coord       = surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data()</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                                 + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    <span class="comment">/* Easier storage of the metric terms. */</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdz = metricTerms[2];</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = metricTerms[3];</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = metricTerms[4];</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdz = metricTerms[5];</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdx = metricTerms[6];</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdy = metricTerms[7];</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdz = metricTerms[8];</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    <span class="comment">/* Compute the Cartesian gradients of the solution. */</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx + solDOFDt[0]*dtdx;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx + solDOFDt[1]*dtdx;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx + solDOFDt[2]*dtdx;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdx  = solDOFDr[3]*drdx + solDOFDs[3]*dsdx + solDOFDt[3]*dtdx;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdx  = solDOFDr[4]*drdx + solDOFDs[4]*dsdx + solDOFDt[4]*dtdx;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy + solDOFDt[0]*dtdy;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy + solDOFDt[1]*dtdy;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy + solDOFDt[2]*dtdy;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdy  = solDOFDr[3]*drdy + solDOFDs[3]*dsdy + solDOFDt[3]*dtdy;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdy  = solDOFDr[4]*drdy + solDOFDs[4]*dsdy + solDOFDt[4]*dtdy;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodz = solDOFDr[0]*drdz + solDOFDs[0]*dsdz + solDOFDt[0]*dtdz;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudz  = solDOFDr[1]*drdz + solDOFDs[1]*dsdz + solDOFDt[1]*dtdz;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdz  = solDOFDr[2]*drdz + solDOFDs[2]*dsdz + solDOFDt[2]*dtdz;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdz  = solDOFDr[3]*drdz + solDOFDs[3]*dsdz + solDOFDt[3]*dtdz;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdz  = solDOFDr[4]*drdz + solDOFDs[4]*dsdz + solDOFDt[4]*dtdz;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <span class="comment">/* Compute the velocities and static energy in this</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">                       integration point. */</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv   = 1.0/sol[0];</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = DensityInv*sol[1];</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = DensityInv*sol[2];</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> w            = DensityInv*sol[3];</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = DensityInv*sol[4];</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> + w*w);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    <span class="comment">/* Compute the Cartesian gradients of the velocities and</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">                       static energy in this integration point and also the</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">                       divergence of the velocity. */</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = DensityInv*(drudx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = DensityInv*(drudy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudz = DensityInv*(drudz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodz);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = DensityInv*(drvdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = DensityInv*(drvdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdz = DensityInv*(drvdz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodz);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdx = DensityInv*(drwdx - w*drhodx);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdy = DensityInv*(drwdy - w*drhody);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdz = DensityInv*(drwdz - w*drhodz);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergydx = DensityInv*(drEdx - TotalEnergy*drhodx)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                                    - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx - w*dwdx;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergydy = DensityInv*(drEdy - TotalEnergy*drhody)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                                    - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy - w*dwdy;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergydz = DensityInv*(drEdz - TotalEnergy*drhodz)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                                    - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdz - w*dwdz;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> divVel = dudx + dvdy + dwdz;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    <span class="comment">/* Compute the laminar viscosity. */</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    <span class="comment">/* Set the value of the second viscosity and compute the</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">                       divergence term in the viscous normal stresses. */</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*ViscosityLam;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    <span class="comment">/* Compute the viscous stress tensor and the normal flux.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">                       Note that there is a plus sign for the heat flux, because</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">                       the normal points into the geometry. */</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxx = 2.0*ViscosityLam*dudx + lamDivTerm;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyy = 2.0*ViscosityLam*dvdy + lamDivTerm;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauzz = 2.0*ViscosityLam*dwdz + lamDivTerm;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxy = ViscosityLam*(dudy + dvdx);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxz = ViscosityLam*(dudz + dwdx);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyz = ViscosityLam*(dvdz + dwdy);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qHeatNorm = ViscosityLam*factHeatFlux_Lam</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                              * (dStaticEnergydx*normals[0]</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                              +  dStaticEnergydy*normals[1]</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                              +  dStaticEnergydz*normals[2]);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    <span class="comment">/* Update the viscous force and moment. Note that the normal</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">                       points into the geometry, hence the minus sign for the stress. */</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> scaleFac =  weights[i]*normals[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*factor;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Fx = -scaleFac*(tauxx*normals[0] + tauxy*normals[1]</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                                       +            tauxz*normals[2]);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Fy = -scaleFac*(tauxy*normals[0] + tauyy*normals[1]</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                       +            tauyz*normals[2]);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Fz = -scaleFac*(tauxz*normals[0] + tauyz*normals[1]</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                       +            tauzz*normals[2]);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    ForceViscous[0] += Fx;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    ForceViscous[1] += Fy;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    ForceViscous[2] += Fz;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dx = Coord[0] - Origin[0];</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dy = Coord[1] - Origin[1];</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dz = Coord[2] - Origin[2];</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    MomentViscous[0] += (Fz*dy - Fy*dz)/RefLength;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    MomentViscous[1] += (Fx*dz - Fz*dx)/RefLength;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    MomentViscous[2] += (Fy*dx - Fx*dy)/RefLength;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    <span class="comment">/* Update the heat flux and maximum heat flux for this marker. */</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                    Heat_Visc[iMarker] += qHeatNorm*weights[i]*normals[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*RefHeatFlux;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                    MaxHeatFlux_Visc[iMarker] = max(MaxHeatFlux_Visc[iMarker], fabs(qHeatNorm));</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                  }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">               current chunk. */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            l = lEnd;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="comment">/*--- Project forces and store the non-dimensional coefficients ---*/</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          CD_Visc[iMarker]   =  ForceViscous[0]*cos(Alpha) + ForceViscous[1]*sin(Alpha);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          CL_Visc[iMarker]   = -ForceViscous[0]*sin(Alpha) + ForceViscous[1]*cos(Alpha);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          CEff_Visc[iMarker] = CL_Visc[iMarker] / (CD_Visc[iMarker]+<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          CMz_Visc[iMarker]  = MomentViscous[2];</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          CFx_Visc[iMarker]  = ForceViscous[0];</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          CFy_Visc[iMarker]  = ForceViscous[1];</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          CD_Visc[iMarker]   =  ForceViscous[0]*cos(Alpha)*cos(Beta)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                             +  ForceViscous[1]*sin(Beta)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                             +  ForceViscous[2]*sin(Alpha)*cos(Beta);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          CL_Visc[iMarker]   = -ForceViscous[0]*sin(Alpha) + ForceViscous[2]*cos(Alpha);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          CSF_Visc[iMarker]  = -ForceViscous[0]*sin(Beta)*cos(Alpha)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                             +  ForceViscous[1]*cos(Beta)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                             -  ForceViscous[2]*sin(Beta)*sin(Alpha);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          CEff_Visc[iMarker] = CL_Visc[iMarker]/(CD_Visc[iMarker] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          CMx_Visc[iMarker]  = MomentViscous[0];</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          CMy_Visc[iMarker]  = MomentViscous[1];</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          CMz_Visc[iMarker]  = MomentViscous[2];</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          CFx_Visc[iMarker]  = ForceViscous[0];</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;          CFy_Visc[iMarker]  = ForceViscous[1];</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          CFz_Visc[iMarker]  = ForceViscous[2];</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        AllBound_CD_Visc   += CD_Visc[iMarker];</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        AllBound_CL_Visc   += CL_Visc[iMarker];</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        AllBound_CSF_Visc  += CSF_Visc[iMarker];</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        AllBound_CMx_Visc  += CMx_Visc[iMarker];</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        AllBound_CMy_Visc  += CMy_Visc[iMarker];</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        AllBound_CMz_Visc  += CMz_Visc[iMarker];</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        AllBound_CFx_Visc  += CFx_Visc[iMarker];</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        AllBound_CFy_Visc  += CFy_Visc[iMarker];</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        AllBound_CFz_Visc  += CFz_Visc[iMarker];</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        AllBound_HeatFlux_Visc   += Heat_Visc[iMarker];</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        AllBound_MaxHeatFlux_Visc = max(AllBound_MaxHeatFlux_Visc,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                        MaxHeatFlux_Visc[iMarker]);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="comment">/*--- Compute the coefficients per surface ---*/</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                         ++iMarker_Monitoring) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          <span class="keywordtype">string</span> Monitoring_Tag = config-&gt;<a class="code" href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">GetMarker_Monitoring_TagBound</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(iMarker);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          <span class="keywordflow">if</span> (Marker_Tag == Monitoring_Tag) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            Surface_CL_Visc[iMarker_Monitoring]   += CL_Visc[iMarker];</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            Surface_CD_Visc[iMarker_Monitoring]   += CD_Visc[iMarker];</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            Surface_CSF_Visc[iMarker_Monitoring]  += CSF_Visc[iMarker];</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            Surface_CEff_Visc[iMarker_Monitoring] += CEff_Visc[iMarker];</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            Surface_CFx_Visc[iMarker_Monitoring]  += CFx_Visc[iMarker];</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            Surface_CFy_Visc[iMarker_Monitoring]  += CFy_Visc[iMarker];</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            Surface_CFz_Visc[iMarker_Monitoring]  += CFz_Visc[iMarker];</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            Surface_CMx_Visc[iMarker_Monitoring]  += CMx_Visc[iMarker];</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            Surface_CMy_Visc[iMarker_Monitoring]  += CMy_Visc[iMarker];</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            Surface_CMz_Visc[iMarker_Monitoring]  += CMz_Visc[iMarker];</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">/*--- Parallel mode. The data from all ranks must be gathered.</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">        Determine the size of the communication buffer. ---*/</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nCommSize = 9*config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>() + 10;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="comment">/*--- Define the communication buffers and store to local data in</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">        the local buffer. ---*/</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  vector&lt;su2double&gt; locBuf(nCommSize), globBuf(nCommSize);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = 0;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  locBuf[ii++] = AllBound_CD_Visc;  locBuf[ii++] = AllBound_CL_Visc;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  locBuf[ii++] = AllBound_CSF_Visc; locBuf[ii++] = AllBound_CMx_Visc;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  locBuf[ii++] = AllBound_CMy_Visc; locBuf[ii++] = AllBound_CMz_Visc;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  locBuf[ii++] = AllBound_CFx_Visc; locBuf[ii++] = AllBound_CFy_Visc;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  locBuf[ii++] = AllBound_CFz_Visc; locBuf[ii++] = AllBound_HeatFlux_Visc;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); ++i) {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    locBuf[ii++] = Surface_CL_Visc[i];  locBuf[ii++] = Surface_CD_Visc[i];</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    locBuf[ii++] = Surface_CSF_Visc[i]; locBuf[ii++] = Surface_CFx_Visc[i];</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    locBuf[ii++] = Surface_CFy_Visc[i]; locBuf[ii++] = Surface_CFz_Visc[i];</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    locBuf[ii++] = Surface_CMx_Visc[i]; locBuf[ii++] = Surface_CMy_Visc[i];</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    locBuf[ii++] = Surface_CMz_Visc[i];</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">/* Sum up all the data from all ranks. The result will be available on all ranks. */</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#aa495414133c826e5f6651d4ce82d0ef6">GetComm_Level</a>() == <a class="code" href="option__structure_8hpp.html#a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074">COMM_FULL</a>) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(locBuf.data(), globBuf.data(), nCommSize, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                       <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">/*--- Copy the data back from globBuf into the required variables. ---*/</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  ii = 0;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  AllBound_CD_Visc  = globBuf[ii++]; AllBound_CL_Visc       = globBuf[ii++];</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  AllBound_CSF_Visc = globBuf[ii++]; AllBound_CMx_Visc      = globBuf[ii++];</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  AllBound_CMy_Visc = globBuf[ii++]; AllBound_CMz_Visc      = globBuf[ii++];</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  AllBound_CFx_Visc = globBuf[ii++]; AllBound_CFy_Visc      = globBuf[ii++];</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  AllBound_CFz_Visc = globBuf[ii++]; AllBound_HeatFlux_Visc = globBuf[ii++];</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  AllBound_CEff_Visc = AllBound_CL_Visc/(AllBound_CD_Visc + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); ++i) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    Surface_CL_Visc[i]  = globBuf[ii++]; Surface_CD_Visc[i]  = globBuf[ii++];</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    Surface_CSF_Visc[i] = globBuf[ii++]; Surface_CFx_Visc[i] = globBuf[ii++];</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    Surface_CFy_Visc[i] = globBuf[ii++]; Surface_CFz_Visc[i] = globBuf[ii++];</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    Surface_CMx_Visc[i] = globBuf[ii++]; Surface_CMy_Visc[i] = globBuf[ii++];</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    Surface_CMz_Visc[i] = globBuf[ii++];</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    Surface_CEff_Visc[i] = Surface_CL_Visc[i]/(Surface_CD_Visc[i] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">/* Determine the maximum heat flux over all ranks. */</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> localMax = AllBound_MaxHeatFlux_Visc;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#aa495414133c826e5f6651d4ce82d0ef6">GetComm_Level</a>() == <a class="code" href="option__structure_8hpp.html#a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074">COMM_FULL</a>) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;localMax, &amp;AllBound_MaxHeatFlux_Visc, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>,</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                       <a class="code" href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="comment">/*--- Update the total coefficients (note that all the nodes have the same value)---*/</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a>   += AllBound_CD_Visc;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a>   += AllBound_CL_Visc;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a>  += AllBound_CSF_Visc;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a>  = <a class="code" href="classCFEM__DG__EulerSolver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a> / (<a class="code" href="classCFEM__DG__EulerSolver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a> + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a>  += AllBound_CMx_Visc;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a>  += AllBound_CMy_Visc;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a>  += AllBound_CMz_Visc;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a>  += AllBound_CFx_Visc;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a>  += AllBound_CFy_Visc;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a>  += AllBound_CFz_Visc;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">/*--- Update the total coefficients per surface (note that all the nodes have the same value)---*/</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                    ++iMarker_Monitoring) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a>[iMarker_Monitoring]   += Surface_CL_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a>[iMarker_Monitoring]   += Surface_CD_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a>[iMarker_Monitoring]  += Surface_CSF_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a>[iMarker_Monitoring]  = <a class="code" href="classCFEM__DG__EulerSolver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a>[iMarker_Monitoring] / (<a class="code" href="classCFEM__DG__EulerSolver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a>[iMarker_Monitoring] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a>[iMarker_Monitoring]  += Surface_CFx_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a>[iMarker_Monitoring]  += Surface_CFy_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a>[iMarker_Monitoring]  += Surface_CFz_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a>[iMarker_Monitoring]  += Surface_CMx_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a>[iMarker_Monitoring]  += Surface_CMy_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a>[iMarker_Monitoring]  += Surface_CMz_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a1d77cb51e0eb51dfb95735ac965ac176">  892</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a1d77cb51e0eb51dfb95735ac965ac176">CFEM_DG_NSSolver::SetTime_Step</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCSolver.html">CSolver</a> **solver_container, <a class="code" href="classCConfig.html">CConfig</a> *config,</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Iteration) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">/* Check whether or not a time stepping scheme is used. */</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> time_stepping = config-&gt;<a class="code" href="classCConfig.html#ac47e04d76ce865893a94dcedd3c9b6a5">GetTime_Marching</a>() == <a class="code" href="option__structure_8hpp.html#a75d7083b30c2dd99c3f11ddb57226342ae1a5d5fc9657888e43b4518cdf0e9b7b">TIME_MARCHING::TIME_STEPPING</a>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">/* Allocate the memory for the work array and initialize it to zero to avoid</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">     warnings in debug mode  about uninitialized memory when padding is applied. */</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  vector&lt;su2double&gt; workArrayVec(<a class="code" href="classCFEM__DG__EulerSolver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a>, 0.0);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *workArray = workArrayVec.data();</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, namely the ratio of</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">     thermal conductivity and viscosity. */</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam  = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Turb = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">/* Constant ratio of the second viscosity and the viscosity itself. */</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambdaOverMu = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="comment">/* The eigenvalues of the viscous Jacobian, scaled by the kinematic viscosity,</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">     are 1.0, 2.0 + lambdaOverMu and kOverCv/Mu. The last is variable due to the</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">     possible presence of an eddy viscosity, but the first two are constant and</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">     the maximum can be determined. */</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radOverNuTerm = max(1.0, 2.0+lambdaOverMu);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">/* Store the number of metric points per DOF, which depends</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">     on the number of dimensions. */</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 1;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment">/* Determine the number of elements that are treated simultaneously</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nElemSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">/* Initialize the minimum and maximum time step. */</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> = 1.e25; <a class="code" href="classCSolver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a> = 0.0;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">/* Easier storage of the CFL number. Note that if we are using explicit</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">   time stepping, the regular CFL condition has been overwritten with the</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">   unsteady CFL condition in the config post-processing (if non-zero). */</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> CFL = config-&gt;<a class="code" href="classCConfig.html#a327893f15ca36b27db6201a7cb787022">GetCFL</a>(iMesh);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">/*--- Explicit time stepping with imposed time step (eventually will</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">   allow for local time stepping with this value imposed as the time</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">   for syncing the cells). If the unsteady CFL is set to zero (default),</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">   it uses the defined unsteady time step, otherwise it computes the time</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">   step based on the provided unsteady CFL. Note that the regular CFL</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">   option in the config is always ignored with time stepping. ---*/</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">if</span> (time_stepping &amp;&amp; (config-&gt;<a class="code" href="classCConfig.html#ae57f903be939aa55dee4fb3298a249fb">GetUnst_CFL</a>() == 0.0)) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">/*--- Loop over the owned volume elements and set the fixed dt. ---*/</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="classCFEM__DG__EulerSolver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l] = config-&gt;<a class="code" href="classCConfig.html#a0acfef8e480970316e9e672eacd59e9b">GetDelta_UnstTimeND</a>();</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">/*--- Check for a compressible solver. ---*/</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span>(config-&gt;<a class="code" href="classCConfig.html#afbf664fbd8b2c75c5874432fdc185937">GetKind_Regime</a>() == <a class="code" href="option__structure_8hpp.html#a3d92e0a004752d2ef55cf6c1e2e3d6f0a4462c3537ac234334d1897fb8bacddcd">ENUM_REGIME::COMPRESSIBLE</a>) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="comment">/*--- Loop over the owned volume elements. Multiple elements are treated</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">            simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">            multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">            happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="classCFEM__DG__EulerSolver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>;) {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="comment">/* Determine the end index for this chunk of elements and the padded</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">           N value in the gemm computations. */</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>, l, <a class="code" href="classCFEM__DG__EulerSolver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>, nElemSimul, nPadMin,</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                            lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">/* Get the required data from the corresponding standard element. */</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs          = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matDerBasisSolDOFs = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#ac5299da576559652cc910b91541b243b">GetMatDerBasisFunctionsSolDOFs</a>();</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFs     = workArray;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradSolDOFs = solDOFs + nDOFs*NPad;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="comment">/* Determine the offset between the r-derivatives and s-derivatives, which is</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">           also the offset between s- and t-derivatives, of the solution in the DOFs. */</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivSol = NPad*<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="comment">/*--- Compute the gradients of the conserved variables if a subgrid</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">              scale model for LES is used. ---*/</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;          <span class="comment">/* Copy the solution of the DOFs into solDOFs for this chunk of elements. */</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="comment">/* Easier storage of the solution of this element. */</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lInd = l + ll;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol = <a class="code" href="classCFEM__DG__EulerSolver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                solDOFs[i*NPad+llNVar+mm] =  sol[i*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+mm];</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;          <span class="comment">/* Call the general function to carry out the matrix product to determine</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">             the gradients in the DOFs of this chunk of elements. */</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;          <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisSolDOFs, solDOFs, gradSolDOFs, config);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="comment">/*--- Make a distinction between 2D and 3D for optimal performance. ---*/</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="keywordflow">switch</span>( <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="comment">/*--- 2D simulation. Loop over the chunk of elements. ---*/</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;              <span class="comment">/* Compute the length scale of this element and initialize the</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">                 inviscid and viscous spectral radii to zero. */</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScaleInv = nPoly/<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale    = 1.0/lenScaleInv;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> charVel2Max = 0.0, radViscMax = 0.0;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;              <span class="comment">/* Loop over the DOFs of the element to determine the time step. */</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF  = <a class="code" href="classCFEM__DG__EulerSolver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                         + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data()</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                         + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                <span class="comment">/* Compute the velocities and the internal energy per unit mass. */</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = DensityInv*solDOF[3] - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                <span class="comment">/*--- Compute the maximum value of the wave speed. This is a rather</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">                      conservative estimate. ---*/</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> SoundSpeed2 = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a654e55c4c6bb3914b40fbc27410876ba">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> SoundSpeed  = <a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(fabs(SoundSpeed2));</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radx     = fabs(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>-gridVel[0]) + SoundSpeed;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rady     = fabs(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>-gridVel[1]) + SoundSpeed;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> charVel2 = radx*radx + rady*rady;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                charVel2Max = max(charVel2Max, charVel2);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                <span class="comment">/* Compute the laminar kinematic viscosity and check if an eddy</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">                   viscosity must be determined. */</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> muLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> muTurb      = 0.0;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                  <span class="comment">/* Set the pointers to the locations where the gradients</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">                     of this DOF start. */</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDr = gradSolDOFs + i*NPad + llNVar;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDs = solDOFDr    + offDerivSol;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                  <span class="comment">/* Compute the true value of the metric terms in this DOF. Note that in</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">                     metricTerms the metric terms scaled by the Jacobian are stored. */</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#ae6c47cde654970b624c84f026f604a67">metricTermsSolDOFs</a>.data()</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                                               + i*nMetricPerPoint;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> JacInv       = 1.0/metricTerms[0];</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = JacInv*metricTerms[3];</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = JacInv*metricTerms[4];</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                  <span class="comment">/*--- Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">                        variables from the gradients in parametric coordinates and the metric</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">                        terms in this DOF. ---*/</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                  <span class="comment">/*--- Compute the Cartesian gradients of the velocities. ---*/</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = DensityInv*(drudx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = DensityInv*(drvdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = DensityInv*(drudy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = DensityInv*(drvdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                  <span class="comment">/* Compute the eddy viscosity. */</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dist = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a6adc8d7d1588b7747b8f278fcd73b58f">wallDistanceSolDOFs</a>[i];</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                  muTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(solDOF[0], dudx, dudy,</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                                                             dvdx, dvdy, lenScale,</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                                             dist);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                <span class="comment">/*--- Determine the viscous spectral radius. ---*/</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> mu           = muLam + muTurb;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kOverCv      = muLam*factHeatFlux_Lam</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                                             + muTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux = kOverCv/mu;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radVisc = DensityInv*mu*max(radOverNuTerm, factHeatFlux);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                <span class="comment">/* Update the maximum value of the viscous spectral radius. */</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                radViscMax = max(radViscMax, radVisc);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;              }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;              <span class="comment">/*--- Compute the time step for the element and update the minimum and</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">                    maximum value. Take the factor for time accurate local time</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">                    stepping into account for the minimum and maximum. ---*/</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtInv = lenScaleInv*(<a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(charVel2Max) + radViscMax*lenScaleInv);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;              <a class="code" href="classCFEM__DG__EulerSolver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[lInd] = CFL/dtInv;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtEff = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#aa9c40460f4f77c1d43a99e7a77e595ca">factTimeLevel</a>*<a class="code" href="classCFEM__DG__EulerSolver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[lInd];</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;              <a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> = min(<a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;              <a class="code" href="classCSolver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a> = max(<a class="code" href="classCSolver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;          }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;          <span class="comment">/*------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="comment">/*--- 3D simulation. Loop over the chunk of elements. ---*/</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;              <span class="comment">/* Compute the length scale of this element and initialize the</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">                 inviscid and viscous spectral radii to zero. */</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScaleInv = nPoly/<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale    = 1.0/lenScaleInv;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> charVel2Max = 0.0, radViscMax = 0.0;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;              <span class="comment">/* Loop over the DOFs of the element to determine the time step. */</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF  = <a class="code" href="classCFEM__DG__EulerSolver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                         + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data()</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                                         + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                <span class="comment">/* Compute the velocities and the internal energy per unit mass. */</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> w            = DensityInv*solDOF[3];</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = DensityInv*solDOF[4] - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> + w*w);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                <span class="comment">/*--- Compute the maximum value of the wave speed. This is a rather</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">                      conservative estimate. ---*/</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> SoundSpeed2 = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a654e55c4c6bb3914b40fbc27410876ba">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> SoundSpeed  = <a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(fabs(SoundSpeed2));</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radx     = fabs(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>-gridVel[0]) + SoundSpeed;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rady     = fabs(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>-gridVel[1]) + SoundSpeed;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radz     = fabs(w-gridVel[2]) + SoundSpeed;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> charVel2 = radx*radx + rady*rady + radz*radz;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                charVel2Max = max(charVel2Max, charVel2);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <span class="comment">/* Compute the laminar kinematic viscosity and check if an eddy</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">                   viscosity must be determined. */</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> muLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> muTurb      = 0.0;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                  <span class="comment">/* Set the pointers to the locations where the gradients</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">                     of this DOF start. */</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDr = gradSolDOFs + i*NPad + llNVar;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDs = solDOFDr    + offDerivSol;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDt = solDOFDs    + offDerivSol;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                  <span class="comment">/* Compute the true value of the metric terms in this DOF. Note that in</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">                     metricTerms the metric terms scaled by the Jacobian are stored. */</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#ae6c47cde654970b624c84f026f604a67">metricTermsSolDOFs</a>.data()</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                               + i*nMetricPerPoint;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> JacInv       = 1.0/metricTerms[0];</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdz = JacInv*metricTerms[3];</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = JacInv*metricTerms[4];</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = JacInv*metricTerms[5];</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdz = JacInv*metricTerms[6];</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdx = JacInv*metricTerms[7];</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdy = JacInv*metricTerms[8];</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdz = JacInv*metricTerms[9];</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                  <span class="comment">/*--- Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">                        variables from the gradients in parametric coordinates and the metric</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">                        terms in this DOF. ---*/</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx + solDOFDt[0]*dtdx;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drux   = solDOFDr[1]*drdx + solDOFDs[1]*dsdx + solDOFDt[1]*dtdx;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvx   = solDOFDr[2]*drdx + solDOFDs[2]*dsdx + solDOFDt[2]*dtdx;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwx   = solDOFDr[3]*drdx + solDOFDs[3]*dsdx + solDOFDt[3]*dtdx;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy + solDOFDt[0]*dtdy;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> druy   = solDOFDr[1]*drdy + solDOFDs[1]*dsdy + solDOFDt[1]*dtdy;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvy   = solDOFDr[2]*drdy + solDOFDs[2]*dsdy + solDOFDt[2]*dtdy;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwy   = solDOFDr[3]*drdy + solDOFDs[3]*dsdy + solDOFDt[3]*dtdy;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodz = solDOFDr[0]*drdz + solDOFDs[0]*dsdz + solDOFDt[0]*dtdz;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> druz   = solDOFDr[1]*drdz + solDOFDs[1]*dsdz + solDOFDt[1]*dtdz;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvz   = solDOFDr[2]*drdz + solDOFDs[2]*dsdz + solDOFDt[2]*dtdz;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwz   = solDOFDr[3]*drdz + solDOFDs[3]*dsdz + solDOFDt[3]*dtdz;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                  <span class="comment">/*--- Compute the Cartesian gradients of the velocities. ---*/</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = DensityInv*(drux - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = DensityInv*(druy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudz = DensityInv*(druz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodz);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = DensityInv*(drvx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = DensityInv*(drvy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdz = DensityInv*(drvz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodz);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdx = DensityInv*(drwx - w*drhodx);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdy = DensityInv*(drwy - w*drhody);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdz = DensityInv*(drwz - w*drhodz);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                  <span class="comment">/* Compute the eddy viscosity. */</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dist = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a6adc8d7d1588b7747b8f278fcd73b58f">wallDistanceSolDOFs</a>[i];</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                  muTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(solDOF[0], dudx, dudy, dudz,</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                                             dvdx, dvdy, dvdz, dwdx, dwdy,</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                                                             dwdz, lenScale, dist);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                }</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                <span class="comment">/*--- Determine the viscous spectral radius. ---*/</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> mu           = muLam + muTurb;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kOverCv      = muLam*factHeatFlux_Lam</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                             + muTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux = kOverCv/mu;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radVisc = DensityInv*mu*max(radOverNuTerm, factHeatFlux);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                <span class="comment">/* Update the maximum value of the viscous spectral radius. */</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                radViscMax = max(radViscMax, radVisc);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;              }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;              <span class="comment">/*--- Compute the time step for the element and update the minimum and</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">                    maximum value. Take the factor for time accurate local time</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">                    stepping into account for the minimum and maximum. ---*/</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtInv = lenScaleInv*(<a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(charVel2Max) + radViscMax*lenScaleInv);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;              <a class="code" href="classCFEM__DG__EulerSolver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[lInd] = CFL/dtInv;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtEff = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#aa9c40460f4f77c1d43a99e7a77e595ca">factTimeLevel</a>*<a class="code" href="classCFEM__DG__EulerSolver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[lInd];</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;              <a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> = min(<a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;              <a class="code" href="classCSolver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a> = max(<a class="code" href="classCSolver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;          }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">           current chunk. */</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        l = lEnd;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="comment">/*--- Incompressible solver. ---*/</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <a class="code" href="classCBaseMPIWrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Incompressible solver not implemented yet&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="comment">/*--- Compute the max and the min dt (in parallel). Note that we only</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">     do this for steady calculations if the high verbosity is set, but we</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">     always perform the reduction for unsteady calculations where the CFL</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">     limit is used to set the global time step. ---*/</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="classCConfig.html#aa495414133c826e5f6651d4ce82d0ef6">GetComm_Level</a>() == <a class="code" href="option__structure_8hpp.html#a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074">COMM_FULL</a>) || time_stepping) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rbuf_time = <a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;rbuf_time, &amp;<a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa2fecfa16d35e8fa3894c512a527b73f">MPI_MIN</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      rbuf_time = <a class="code" href="classCSolver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;rbuf_time, &amp;<a class="code" href="classCSolver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">/*--- For explicit time stepping with an unsteady CFL imposed, use the</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">          minimum delta time of the entire mesh. As Min_Delta_Time is scaled to</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">          the time step of the largest time level, a correction must be used</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">          for the time level when time accurate local time stepping is used. ---*/</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span> (time_stepping) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="classCFEM__DG__EulerSolver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l)</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <a class="code" href="classCFEM__DG__EulerSolver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l] = <a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>/<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].factTimeLevel;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      config-&gt;<a class="code" href="classCConfig.html#a9d3085d222e6ab0b658d79c52b6477fc">SetDelta_UnstTimeND</a>(<a class="code" href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;}</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ADER_DG_AliasedPredictorResidual_2D(<a class="code" href="classCConfig.html">CConfig</a>              *config,</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                                           <a class="code" href="classCVolumeElementFEM.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                                           <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *sol,</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                                           <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>            *res,</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                                           <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>            *work) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector. */</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam  = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Turb = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160; </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="comment">/* Get the necessary information from the standard element. */</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matBasisInt            = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a51b506fa4dc4b72b40b32dd0c85590f9">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matDerBasisInt         = matBasisInt + nDOFs*nInt;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matDerBasisSolDOFs     = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#ac5299da576559652cc910b91541b243b">GetMatDerBasisFunctionsSolDOFs</a>();</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *basisFunctionsIntTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#affb3cc64405ea150788c7c9739d8d6d5">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *weights                = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="comment">/* Compute the length scale of the current element for the LES. */</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">/* Set the pointers for fluxes in the DOFs, the gradient of the fluxes in</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">     the integration points, the gradient of the solution in the DOFs and the</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">     divergence of the fluxes in the integration points. Note that some pointers</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">     point to the same physical location. This is because this memory can be</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">     used for different purposes. */</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxXDOF     = work;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxYDOF     = fluxXDOF + NPad*nDOFs;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxXInt = fluxYDOF + NPad*nDOFs;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxYInt = gradFluxXInt + <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradSolDOFs  = gradFluxXInt;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *divFlux      = work;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="comment">/* Determine the offset between the r-derivatives and s-derivatives of the</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">     fluxes in the integration points and the offset between the r-derivatives</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">     and s-derivatives of the solution in the DOFs. */</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivSol    = NPad*nDOFs;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivFluxes = NPad*nInt;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 5;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="comment">/*---          Construct the Cartesian fluxes in the DOFs.               ---*/</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="comment">/* Compute the derivatives of the solution variables w.r.t. the parametric</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">     coordinates in the DOFs. */</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisSolDOFs, sol, gradSolDOFs, config);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="comment">/*--- Loop over the DOFs to compute the Cartesian fluxes in the DOFs. ---*/</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="comment">/* Set the pointers for the solution, its gradients and the fluxes</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">         for this DOF. */</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDOF = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF     = sol         + offDOF;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDr   = gradSolDOFs + offDOF;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDs   = solDOFDr    + offDerivSol;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxX            = fluxXDOF    + offDOF;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxY            = fluxYDOF    + offDOF;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities at the location of the</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">         solution DOFS. THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">         MOTION IS SPECIFIED, THE DATA FOR THIS DOF FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + 2*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="comment">/* Compute the true value of the metric terms in this DOF. Note that in</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">         metricTerms the metric terms scaled by the Jacobian are stored. THIS</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">         IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED, THE</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">         DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#ae6c47cde654970b624c84f026f604a67">metricTermsSolDOFs</a>.data()</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                   + i*nMetricPerPoint;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> JacInv       = 1.0/metricTerms[0];</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = JacInv*metricTerms[3];</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = JacInv*metricTerms[4];</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution variables</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">         from the gradients in parametric coordinates and the metric terms. */</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdx  = solDOFDr[3]*drdx + solDOFDs[3]*dsdx;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdy  = solDOFDr[3]*drdy + solDOFDs[3]*dsdy;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="comment">/* Compute the velocities, pressure and laminar viscosity in this DOF. */</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = DensityInv*solDOF[3];</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Pressure     = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">GetPressure</a>();</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the velocities and static energy. */</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = DensityInv*(drudx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = DensityInv*(drvdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = DensityInv*(drudy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = DensityInv*(drvdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedx = DensityInv*(drEdx - TotalEnergy*drhodx) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedy = DensityInv*(drEdy - TotalEnergy*drhody) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="comment">/* Compute the eddy viscosity, if needed, and the total viscosity. */</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keywordflow">if</span>( SGSModelUsed )</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        ViscosityTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(solDOF[0], dudx, dudy,</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                                                          dvdx, dvdy, lenScale,</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                                                          elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a6adc8d7d1588b7747b8f278fcd73b58f">wallDistanceSolDOFs</a>[i]);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="comment">/* Compute the total thermal conductivity divided by Cv. */</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                              + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <span class="comment">/* Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">         term in the viscous normal stresses. */</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lamDivTerm =  lambda*(dudx + dvdy);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="comment">/* Compute the viscous stress tensor. */</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      <span class="comment">/* The Cartesian fluxes in the x-direction. */</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> uRel = <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> - gridVel[0];</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      fluxX[0] = solDOF[0]*uRel;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      fluxX[1] = solDOF[1]*uRel + Pressure - tauxx;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      fluxX[2] = solDOF[2]*uRel - tauxy;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      fluxX[3] = solDOF[3]*uRel + Pressure*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> - kOverCv*dedx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy;;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="comment">/* The Cartesian fluxes in the y-direction. */</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vRel = <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> - gridVel[1];</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      fluxY[0] = solDOF[0]*vRel;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      fluxY[1] = solDOF[1]*vRel - tauxy;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      fluxY[2] = solDOF[2]*vRel + Pressure - tauyy;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      fluxY[3] = solDOF[3]*vRel + Pressure*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> - kOverCv*dedy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyy;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">/*--- Compute the derivatives of the Cartesian fluxes w.r.t. the         ---*/</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="comment">/*--- parametric coordinates in the integration points.                  ---*/</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxXDOF, gradFluxXInt, config);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxYDOF, gradFluxYInt, config);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="comment">/*--- Compute the divergence of the fluxes in the integration points,    ---*/</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="comment">/*--- multiplied by the integration weight.                              ---*/</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxXDr = gradFluxXInt + offInt;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxXDs = gradFluxXDr  + offDerivFluxes;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxYDr = gradFluxYInt + offInt;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxYDs = gradFluxYDr  + offDerivFluxes;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *divFluxInt  = divFlux      + offInt;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">         THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">         BE TAKEN. */</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="comment">/* Compute the metric terms multiplied by the integration weight. Note that the</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">         first term in the metric terms is the Jacobian. */</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdx = weights[i]*metricTerms[1];</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdy = weights[i]*metricTerms[2];</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdx = weights[i]*metricTerms[3];</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdy = weights[i]*metricTerms[4];</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="comment">/* Compute the divergence of the fluxes, multiplied by the</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">         integration weight. */</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      divFluxInt[0] = gradFluxXDr[0]*wDrdx + gradFluxXDs[0]*wDsdx</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                    + gradFluxYDr[0]*wDrdy + gradFluxYDs[0]*wDsdy;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      divFluxInt[1] = gradFluxXDr[1]*wDrdx + gradFluxXDs[1]*wDsdx</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                    + gradFluxYDr[1]*wDrdy + gradFluxYDs[1]*wDsdy;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      divFluxInt[2] = gradFluxXDr[2]*wDrdx + gradFluxXDs[2]*wDsdx</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    + gradFluxYDr[2]*wDrdy + gradFluxYDs[2]*wDsdy;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      divFluxInt[3] = gradFluxXDr[3]*wDrdx + gradFluxXDs[3]*wDsdx</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                    + gradFluxYDr[3]*wDrdy + gradFluxYDs[3]*wDsdy;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="comment">/*--- Add the body force to the divergence of the fluxes, if such a      ---*/</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="comment">/*--- force is present.                                                  ---*/</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="classCConfig.html#a90249ccb3ccab165af6d95dc5d4fc68f">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">/* Easier storage of the body force. */</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *body_force_vector = config-&gt;<a class="code" href="classCConfig.html#adcfe24128655d4e063972fabd35b101e">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">/* Compute the solution in the integration points of the element.</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">       Use gradFluxYInt to store this solution. */</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solInt = gradFluxYInt;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; </div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt, NPad, nDOFs, matBasisInt, sol, solInt, config);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solThisInt = solInt  + offInt;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">           THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">           THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">           BE TAKEN. */</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        <span class="comment">/* Compute the velocities. */</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv = 1.0/solThisInt[0];</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>      = solThisInt[1]*rhoInv;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>      = solThisInt[2]*rhoInv;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">           equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">           integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">           the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">           velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        divFluxInt[1] -= weightJac*body_force_vector[0];</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        divFluxInt[2] -= weightJac*body_force_vector[1];</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        divFluxInt[3] -= weightJac*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*body_force_vector[0] + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*body_force_vector[1]);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="comment">/*--- Add the source terms of the manufactured solution to the divergence---*/</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="comment">/*--- of the fluxes, if a manufactured solution is used.                 ---*/</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a> ) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#ad236e991301c3037e45206d939deb668">IsManufacturedSolution</a>() ) {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;          <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;          <span class="comment">/* Set the pointer to the coordinates in this integration point.</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">             THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">             BE TAKEN. */</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *coor = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a51a6fc4be49459ff00b9391ba87291cd">coorIntegrationPoints</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;          <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">             THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">             BE TAKEN. */</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac    = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;          <span class="comment">/* Compute the source terms of the manufactured solution.</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. FOR AN ACTUAL TIME ACCURATE</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment">             SIMULATION THE CORRECT TIME MUST BE GIVEN TO THIS FUNCTION. */</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> sourceMan[4];</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#acb2e19001e55c60e498be21ff5c8a085">GetMMSSourceTerm</a>(coor, 0.0, sourceMan);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          <span class="comment">/* Add the source terms to the flux divergence. Note that the source</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">             terms are multiplied with minus the integration weight in order</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="comment">             to be consistent with the formulation of the residual. */</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;          divFluxInt[0] -= weightJac*sourceMan[0];</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;          divFluxInt[1] -= weightJac*sourceMan[1];</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;          divFluxInt[2] -= weightJac*sourceMan[2];</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;          divFluxInt[3] -= weightJac*sourceMan[3];</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      }</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    }</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160; </div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;}</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ADER_DG_AliasedPredictorResidual_3D(<a class="code" href="classCConfig.html">CConfig</a>              *config,</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                                                           <a class="code" href="classCVolumeElementFEM.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                                                           <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *sol,</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                                                           <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>            *res,</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                                                           <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>            *work) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector. */</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam  = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Turb = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="comment">/*--- Get the necessary information from the standard element. ---*/</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matBasisInt            = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a51b506fa4dc4b72b40b32dd0c85590f9">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matDerBasisInt         = matBasisInt + nDOFs*nInt;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matDerBasisSolDOFs     = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#ac5299da576559652cc910b91541b243b">GetMatDerBasisFunctionsSolDOFs</a>();</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *basisFunctionsIntTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#affb3cc64405ea150788c7c9739d8d6d5">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *weights                = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">/* Compute the length scale of the current element for the LES. */</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160; </div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="comment">/* Set the pointers for fluxes in the DOFs, the gradient of the fluxes in</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">     the integration points, the gradient of the solution in the DOFs and the</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">     divergence of the fluxes in the integration points. Note that some pointers</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">     point to the same physical location. This is because this memory can be</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">     used for different purposes. */</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxXDOF     = work;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxYDOF     = fluxXDOF + NPad*nDOFs;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxZDOF     = fluxYDOF + NPad*nDOFs;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxXInt = fluxZDOF + NPad*nDOFs;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxYInt = gradFluxXInt + <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxZInt = gradFluxYInt + <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradSolDOFs  = gradFluxXInt;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *divFlux      = work;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">/* Determine the offset between the r-derivatives and s-derivatives of the</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment">     fluxes in the integration points and the offset between the r-derivatives</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment">     and s-derivatives of the solution in the DOFs. */</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivSol    = NPad*nDOFs;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivFluxes = NPad*nInt;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="comment">/* Store the number of metric points per integration point/DOF for readability. */</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 10;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">/*---          Construct the Cartesian fluxes in the DOFs.               ---*/</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="comment">/* Compute the derivatives of the solution variables w.r.t. the parametric</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">     coordinates in the DOFs. */</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisSolDOFs, sol, gradSolDOFs, config);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="comment">/*--- Loop over the DOFs to compute the Cartesian fluxes in the DOFs. ---*/</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <span class="comment">/* Set the pointers for the solution, its gradients and the fluxes</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">         for this DOF. */</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDOF = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF     = sol         + offDOF;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDr   = gradSolDOFs + offDOF;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDs   = solDOFDr    + offDerivSol;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFDt   = solDOFDs    + offDerivSol;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxX            = fluxXDOF    + offDOF;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxY            = fluxYDOF    + offDOF;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxZ            = fluxZDOF    + offDOF;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities at the location of the</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">         solution DOFS. THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">         MOTION IS SPECIFIED, THE DATA FOR THIS DOF FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + 3*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <span class="comment">/* Compute the true value of the metric terms in this DOF. Note that in</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">         metricTerms the metric terms scaled by the Jacobian are stored. THIS</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">         IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED, THE</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment">         DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#ae6c47cde654970b624c84f026f604a67">metricTermsSolDOFs</a>.data()</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                   + i*nMetricPerPoint;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> JacInv       = 1.0/metricTerms[0];</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdz = JacInv*metricTerms[3];</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = JacInv*metricTerms[4];</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = JacInv*metricTerms[5];</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdz = JacInv*metricTerms[6];</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdx = JacInv*metricTerms[7];</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdy = JacInv*metricTerms[8];</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdz = JacInv*metricTerms[9];</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution variables</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">         from the gradients in parametric coordinates and the metric terms. */</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx + solDOFDt[0]*dtdx;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx + solDOFDt[1]*dtdx;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx + solDOFDt[2]*dtdx;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdx  = solDOFDr[3]*drdx + solDOFDs[3]*dsdx + solDOFDt[3]*dtdx;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdx  = solDOFDr[4]*drdx + solDOFDs[4]*dsdx + solDOFDt[4]*dtdx;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; </div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy + solDOFDt[0]*dtdy;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy + solDOFDt[1]*dtdy;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy + solDOFDt[2]*dtdy;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdy  = solDOFDr[3]*drdy + solDOFDs[3]*dsdy + solDOFDt[3]*dtdy;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdy  = solDOFDr[4]*drdy + solDOFDs[4]*dsdy + solDOFDt[4]*dtdy;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodz = solDOFDr[0]*drdz + solDOFDs[0]*dsdz + solDOFDt[0]*dtdz;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudz  = solDOFDr[1]*drdz + solDOFDs[1]*dsdz + solDOFDt[1]*dtdz;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdz  = solDOFDr[2]*drdz + solDOFDs[2]*dsdz + solDOFDt[2]*dtdz;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdz  = solDOFDr[3]*drdz + solDOFDs[3]*dsdz + solDOFDt[3]*dtdz;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdz  = solDOFDr[4]*drdz + solDOFDs[4]*dsdz + solDOFDt[4]*dtdz;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <span class="comment">/* Compute the velocities, pressure and laminar viscosity in this DOF. */</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> w            = DensityInv*solDOF[3];</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = DensityInv*solDOF[4];</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> + w*w);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Pressure     = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">GetPressure</a>();</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the velocities and static energy. */</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = DensityInv*(drudx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = DensityInv*(drudy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudz = DensityInv*(drudz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodz);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = DensityInv*(drvdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = DensityInv*(drvdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdz = DensityInv*(drvdz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodz);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdx = DensityInv*(drwdx - w*drhodx);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdy = DensityInv*(drwdy - w*drhody);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdz = DensityInv*(drwdz - w*drhodz);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedx = DensityInv*(drEdx - TotalEnergy*drhodx) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx - w*dwdx;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedy = DensityInv*(drEdy - TotalEnergy*drhody) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy - w*dwdy;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedz = DensityInv*(drEdz - TotalEnergy*drhodz) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdz - w*dwdz;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="comment">/* Compute the eddy viscosity, if needed, and the total viscosity. */</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="keywordflow">if</span>( SGSModelUsed )</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        ViscosityTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(solDOF[0], dudx, dudy, dudz,</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                                                          dvdx, dvdy, dvdz, dwdx,</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                                                          dwdy, dwdz, lenScale,</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                                                          elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a6adc8d7d1588b7747b8f278fcd73b58f">wallDistanceSolDOFs</a>[i]);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160; </div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="comment">/* Compute the total thermal conductivity divided by Cv. */</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                              + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <span class="comment">/* Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">         term in the viscous normal stresses. */</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lamDivTerm =  lambda*(dudx + dvdy + dwdz);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      <span class="comment">/* Compute the viscous stress tensor. */</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauzz = 2.0*Viscosity*dwdz + lamDivTerm;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxz = Viscosity*(dudz + dwdx);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyz = Viscosity*(dvdz + dwdy);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="comment">/* The Cartesian fluxes in the x-direction. */</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> uRel = <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> - gridVel[0];</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      fluxX[0] = solDOF[0]*uRel;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      fluxX[1] = solDOF[1]*uRel + Pressure - tauxx;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      fluxX[2] = solDOF[2]*uRel - tauxy;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      fluxX[3] = solDOF[3]*uRel - tauxz;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      fluxX[4] = solDOF[4]*uRel + Pressure*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> - kOverCv*dedx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy - w*tauxz;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="comment">/* The Cartesian fluxes in the y-direction. */</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vRel = <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> - gridVel[1];</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      fluxY[0] = solDOF[0]*vRel;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      fluxY[1] = solDOF[1]*vRel - tauxy;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      fluxY[2] = solDOF[2]*vRel + Pressure - tauyy;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      fluxY[3] = solDOF[3]*vRel - tauyz;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      fluxY[4] = solDOF[4]*vRel + Pressure*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> - kOverCv*dedy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyy - w*tauyz;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="comment">/* The Cartesian fluxes in the z-direction. */</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wRel = w - gridVel[2];</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      fluxZ[0] = solDOF[0]*wRel;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      fluxZ[1] = solDOF[1]*wRel - tauxz;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      fluxZ[2] = solDOF[2]*wRel - tauyz;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      fluxZ[3] = solDOF[3]*wRel + Pressure - tauzz;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      fluxZ[4] = solDOF[4]*wRel + Pressure*w - kOverCv*dedz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyz - w*tauzz;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  }</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="comment">/*--- Compute the derivatives of the Cartesian fluxes w.r.t. the         ---*/</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="comment">/*--- parametric coordinates in the integration points.                  ---*/</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxXDOF, gradFluxXInt, config);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxYDOF, gradFluxYInt, config);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxZDOF, gradFluxZInt, config);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="comment">/*--- Compute the divergence of the fluxes in the integration points,    ---*/</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="comment">/*--- multiplied by the integration weight.                              ---*/</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxXDr = gradFluxXInt + offInt;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxXDs = gradFluxXDr  + offDerivFluxes;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxXDt = gradFluxXDs  + offDerivFluxes;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxYDr = gradFluxYInt + offInt;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxYDs = gradFluxYDr  + offDerivFluxes;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxYDt = gradFluxYDs  + offDerivFluxes;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxZDr = gradFluxZInt + offInt;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxZDs = gradFluxZDr  + offDerivFluxes;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradFluxZDt = gradFluxZDs  + offDerivFluxes;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *divFluxInt  = divFlux      + offInt;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="comment">/* Compute the metric terms multiplied by the integration weight. Note that the</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="comment">         first term in the metric terms is the Jacobian. */</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdx = weights[i]*metricTerms[1];</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdy = weights[i]*metricTerms[2];</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdz = weights[i]*metricTerms[3];</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160; </div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdx = weights[i]*metricTerms[4];</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdy = weights[i]*metricTerms[5];</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdz = weights[i]*metricTerms[6];</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; </div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDtdx = weights[i]*metricTerms[7];</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDtdy = weights[i]*metricTerms[8];</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDtdz = weights[i]*metricTerms[9];</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="comment">/* Compute the divergence of the fluxes, multiplied by the integration weight. */</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      divFluxInt[0] = gradFluxXDr[0]*wDrdx + gradFluxXDs[0]*wDsdx + gradFluxXDt[0]*wDtdx</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                    + gradFluxYDr[0]*wDrdy + gradFluxYDs[0]*wDsdy + gradFluxYDt[0]*wDtdy</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                    + gradFluxZDr[0]*wDrdz + gradFluxZDs[0]*wDsdz + gradFluxZDt[0]*wDtdz;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      divFluxInt[1] = gradFluxXDr[1]*wDrdx + gradFluxXDs[1]*wDsdx + gradFluxXDt[1]*wDtdx</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                    + gradFluxYDr[1]*wDrdy + gradFluxYDs[1]*wDsdy + gradFluxYDt[1]*wDtdy</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                    + gradFluxZDr[1]*wDrdz + gradFluxZDs[1]*wDsdz + gradFluxZDt[1]*wDtdz;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      divFluxInt[2] = gradFluxXDr[2]*wDrdx + gradFluxXDs[2]*wDsdx + gradFluxXDt[2]*wDtdx</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                    + gradFluxYDr[2]*wDrdy + gradFluxYDs[2]*wDsdy + gradFluxYDt[2]*wDtdy</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                    + gradFluxZDr[2]*wDrdz + gradFluxZDs[2]*wDsdz + gradFluxZDt[2]*wDtdz;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      divFluxInt[3] = gradFluxXDr[3]*wDrdx + gradFluxXDs[3]*wDsdx + gradFluxXDt[3]*wDtdx</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                    + gradFluxYDr[3]*wDrdy + gradFluxYDs[3]*wDsdy + gradFluxYDt[3]*wDtdy</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                    + gradFluxZDr[3]*wDrdz + gradFluxZDs[3]*wDsdz + gradFluxZDt[3]*wDtdz;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      divFluxInt[4] = gradFluxXDr[4]*wDrdx + gradFluxXDs[4]*wDsdx + gradFluxXDt[4]*wDtdx</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                    + gradFluxYDr[4]*wDrdy + gradFluxYDs[4]*wDsdy + gradFluxYDt[4]*wDtdy</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                    + gradFluxZDr[4]*wDrdz + gradFluxZDs[4]*wDsdz + gradFluxZDt[4]*wDtdz;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    }</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="comment">/*--- Add the body force to the divergence of the fluxes, if such a      ---*/</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="comment">/*--- force is present.                                                  ---*/</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="classCConfig.html#a90249ccb3ccab165af6d95dc5d4fc68f">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="comment">/* Easier storage of the body force. */</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *body_force_vector = config-&gt;<a class="code" href="classCConfig.html#adcfe24128655d4e063972fabd35b101e">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">/* Compute the solution in the integration points of the element.</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">       Use gradFluxYInt to store this solution. */</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solInt = gradFluxYInt;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt, NPad, nDOFs, matBasisInt, sol, solInt, config);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160; </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solThisInt = solInt  + offInt;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment">           THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="comment">           THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment">           BE TAKEN. */</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        <span class="comment">/* Compute the velocities. */</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv = 1.0/solThisInt[0];</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>      = solThisInt[1]*rhoInv;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>      = solThisInt[2]*rhoInv;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> w      = solThisInt[3]*rhoInv;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment">           equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="comment">           integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="comment">           the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="comment">           velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160; </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        divFluxInt[1] -= weightJac*body_force_vector[0];</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        divFluxInt[2] -= weightJac*body_force_vector[1];</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        divFluxInt[3] -= weightJac*body_force_vector[2];</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        divFluxInt[4] -= weightJac*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*body_force_vector[0] + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*body_force_vector[1]</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                       +            w*body_force_vector[2]);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    }</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="comment">/*--- Add the source terms of the manufactured solution to the divergence---*/</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="comment">/*--- of the fluxes, if a manufactured solution is used.                 ---*/</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a> ) {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#ad236e991301c3037e45206d939deb668">IsManufacturedSolution</a>() ) {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;          <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;          <span class="comment">/* Set the pointer to the coordinates in this integration point.</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">             THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">             BE TAKEN. */</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *coor = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a51a6fc4be49459ff00b9391ba87291cd">coorIntegrationPoints</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; </div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;          <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">             THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment">             BE TAKEN. */</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac    = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;          <span class="comment">/* Compute the source terms of the manufactured solution.</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. FOR AN ACTUAL TIME ACCURATE</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment">             SIMULATION THE CORRECT TIME MUST BE GIVEN TO THIS FUNCTION. */</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> sourceMan[5];</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;          <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#acb2e19001e55c60e498be21ff5c8a085">GetMMSSourceTerm</a>(coor, 0.0, sourceMan);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;          <span class="comment">/* Add the source terms to the flux divergence. Note that the source</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">             terms are multiplied with minus the integration weight in order</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">             to be consistent with the formulation of the residual. */</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;          divFluxInt[0] -= weightJac*sourceMan[0];</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;          divFluxInt[1] -= weightJac*sourceMan[1];</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;          divFluxInt[2] -= weightJac*sourceMan[2];</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;          divFluxInt[3] -= weightJac*sourceMan[3];</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;          divFluxInt[4] -= weightJac*sourceMan[4];</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        }</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  }</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;}</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ADER_DG_NonAliasedPredictorResidual_2D(<a class="code" href="classCConfig.html">CConfig</a>              *config,</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                                                              <a class="code" href="classCVolumeElementFEM.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *sol,</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                                                              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>            *res,</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                                                              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>            *work) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, the inverse of</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">     the specific heat at constant volume and ratio lambdaOverMu. */</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam  =  <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Turb =  <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant      =  config-&gt;<a class="code" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> CvInv             =  <a class="code" href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>/Gas_Constant;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambdaOverMu      = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160; </div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <span class="comment">/*--- Get the necessary information from the standard element. ---*/</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matBasisInt            = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a51b506fa4dc4b72b40b32dd0c85590f9">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *mat2ndDerBasisInt      = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a4c15d676cd2b35367cbeea38f4a634b6">GetMat2ndDerBasisFunctionsInt</a>();</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *basisFunctionsIntTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#affb3cc64405ea150788c7c9739d8d6d5">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *weights                = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <span class="comment">/* Check if a body force is present and set it accordingly. */</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> bodyForceX = 0.0, bodyForceY = 0.0;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="classCConfig.html#a90249ccb3ccab165af6d95dc5d4fc68f">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *body_force_vector = config-&gt;<a class="code" href="classCConfig.html#adcfe24128655d4e063972fabd35b101e">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    bodyForceX = body_force_vector[0];</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    bodyForceY = body_force_vector[1];</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="comment">/* Compute the length scale of the current element for the LES. */</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">/* Set the pointers for solAndGradInt and divFlux to work. The same array</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">     can be used for both help arrays. */</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solAndGradInt = work;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *divFlux       = work;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="comment">/* Determine the offset between the solution variables and the r-derivatives,</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">     which is also the offset between the r- and s-derivatives in the</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">     integration points. */</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivInt = NPad*nInt;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="comment">/* Set the pointer for the second derivatives such that they are stored</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">     after the first derivatives. */</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *secDerSol = solAndGradInt + 3*NPad*nInt;   <span class="comment">/*(nDim+1)*NPad*nInt. */</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 5;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="comment">/* Store the number of additional metric points per integration point, which</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">     are needed to compute the second derivatives. These terms take the</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">     non-constant metric into account. */</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetric2ndDerPerPoint = 6; <span class="comment">/*nDim*(nDim + nDim*(nDim-1)/2). */</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="comment">/*--- Interpolate the solution variables to the integration points and   ---*/</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="comment">/*--- also determine the first and second derivatives of these variables ---*/</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="comment">/*--- in the integration points. All derivatives are w.r.t. the          ---*/</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="comment">/*--- parametric coordinates.                                            ---*/</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="comment">/* Compute the solution and the derivatives w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="comment">     in the integration points. The first argument is nInt*(nDim+1). */</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*3, NPad, nDOFs, matBasisInt, sol, solAndGradInt, config);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="comment">/* Compute the second derivatives w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment">     in the integration points. */</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*3, NPad, nDOFs, mat2ndDerBasisInt, sol, secDerSol, config);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; </div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <span class="comment">/*--- Compute the divergence of viscous fluxes, multiplied by the        ---*/</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="comment">/*--- integration weight in the integration points of the element.       ---*/</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160; </div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="comment">/*--- Loop over the integration points. ---*/</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      <span class="comment">/* Easier storage of the locations where the solution and the gradient</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment">         data of this integration point start. */</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = NPad*i + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol   = solAndGradInt + offInt;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDr = sol   + offDerivInt;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDs = solDr + offDerivInt;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160; </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      <span class="comment">/* Easier storage of the locations where the second derivatives are</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">         stored for this integration point. */</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDrDr = secDerSol + offInt;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDrDs = solDrDr   + offDerivInt;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDsDs = solDrDs   + offDerivInt;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <span class="comment">/* Compute the velocities, pressure and total enthalpy</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">         in this integration point. */</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rho = sol[0];</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ru  = sol[1];</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rv  = sol[2];</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rE  = sol[3];</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv       = 1.0/rho;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = rhoInv*ru;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = rhoInv*rv;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kinEnergy    = 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = rhoInv*rE;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - kinEnergy;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160; </div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(rho, StaticEnergy);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Pressure = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">GetPressure</a>();</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Htot     = rhoInv*(rE + Pressure);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; </div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      <span class="comment">/* Compute the laminar viscosity and its derivative w.r.t. temperature. */</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscLamdT   = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#abe5c1bbc7a5822be2ca700a296a0090a">GetdmudT_rho</a>();</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities in this integration point.</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + 2*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160; </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="comment">/* Compute the true metric terms. Note in metricTerms the actual metric</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment">         terms multiplied by the Jacobian are stored. */</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Jac    = metricTerms[0];</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> JacInv = 1.0/Jac;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = JacInv*metricTerms[3];</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = JacInv*metricTerms[4];</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="comment">         variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment">         metric terms in this integration point. */</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodx = solDr[0]*drdx + solDs[0]*dsdx;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudx  = solDr[1]*drdx + solDs[1]*dsdx;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdx  = solDr[2]*drdx + solDs[2]*dsdx;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdx  = solDr[3]*drdx + solDs[3]*dsdx;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhody = solDr[0]*drdy + solDs[0]*dsdy;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudy  = solDr[1]*drdy + solDs[1]*dsdy;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdy  = solDr[2]*drdy + solDs[2]*dsdy;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdy  = solDr[3]*drdy + solDs[3]*dsdy;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <span class="comment">/* Pointer to the necessary additional metric terms needed to compute</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">         the Cartesian second derivatives for this integration point.</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">         HIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms2ndDer = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a4dce50854c91ee9d721a72bbadd50254">metricTerms2ndDer</a>.data()</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                                         + i*nMetric2ndDerPerPoint;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160; </div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <span class="comment">/* Compute the Cartesian second derivatives of the independent solution</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">         variables from the gradients and second derivatives in parametric</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">         coordinates and the metric terms and its derivatives w.r.t. the</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">         parametric coordinates. */</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodxdx = solDrDr[0]*drdx*drdx + solDsDs[0]*dsdx*dsdx</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                                + 2.0*solDrDs[0]*drdx*dsdx</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                                + solDr[0]*metricTerms2ndDer[0] + solDs[0]*metricTerms2ndDer[1];</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudxdx  = solDrDr[1]*drdx*drdx + solDsDs[1]*dsdx*dsdx</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                                + 2.0*solDrDs[1]*drdx*dsdx</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                                + solDr[1]*metricTerms2ndDer[0] + solDs[1]*metricTerms2ndDer[1];</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdxdx  = solDrDr[2]*drdx*drdx + solDsDs[2]*dsdx*dsdx</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                                + 2.0*solDrDs[2]*drdx*dsdx</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                                + solDr[2]*metricTerms2ndDer[0] + solDs[2]*metricTerms2ndDer[1];</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rEdxdx  = solDrDr[3]*drdx*drdx + solDsDs[3]*dsdx*dsdx</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                                + 2.0*solDrDs[3]*drdx*dsdx</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                                + solDr[3]*metricTerms2ndDer[0] + solDs[3]*metricTerms2ndDer[1];</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodydy = solDrDr[0]*drdy*drdy + solDsDs[0]*dsdy*dsdy</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                                + 2.0*solDrDs[0]*drdy*dsdy</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                                + solDr[0]*metricTerms2ndDer[4] + solDs[0]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudydy  = solDrDr[1]*drdy*drdy + solDsDs[1]*dsdy*dsdy</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                                + 2.0*solDrDs[1]*drdy*dsdy</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                                + solDr[1]*metricTerms2ndDer[4] + solDs[1]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdydy  = solDrDr[2]*drdy*drdy + solDsDs[2]*dsdy*dsdy</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                                + 2.0*solDrDs[2]*drdy*dsdy</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                                + solDr[2]*metricTerms2ndDer[4] + solDs[2]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rEdydy  = solDrDr[3]*drdy*drdy + solDsDs[3]*dsdy*dsdy</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                                + 2.0*solDrDs[3]*drdy*dsdy</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                                + solDr[3]*metricTerms2ndDer[4] + solDs[3]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodxdy = solDrDr[0]*drdx*drdy + solDsDs[0]*dsdx*dsdy</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                                + solDrDs[0]*(drdx*dsdy + dsdx*drdy)</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                                + solDr[0]*metricTerms2ndDer[2] + solDs[0]*metricTerms2ndDer[3];</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudxdy  = solDrDr[1]*drdx*drdy + solDsDs[1]*dsdx*dsdy</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                                + solDrDs[1]*(drdx*dsdy + dsdx*drdy)</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                                + solDr[1]*metricTerms2ndDer[2] + solDs[1]*metricTerms2ndDer[3];</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdxdy  = solDrDr[2]*drdx*drdy + solDsDs[2]*dsdx*dsdy</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                                + solDrDs[2]*(drdx*dsdy + dsdx*drdy)</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                                + solDr[2]*metricTerms2ndDer[2] + solDs[2]*metricTerms2ndDer[3];</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the pressure, velocity components,</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">         static energy and dynamic viscosity. */</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dpdx = <a class="code" href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdx + kinEnergy*drhodx</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                           -                  <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drvdx);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dpdy = <a class="code" href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdy + kinEnergy*drhody</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                           -                  <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drvdy);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = rhoInv*(drudx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = rhoInv*(drudy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = rhoInv*(drvdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx);</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = rhoInv*(drvdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedx = rhoInv*(drEdx - TotalEnergy*drhodx) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedy = rhoInv*(drEdy - TotalEnergy*drhody) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160; </div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscLamdx = CvInv*dedx*dViscLamdT;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscLamdy = CvInv*dedy*dViscLamdT;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      <span class="comment">/* Compute the second derivatives of the velocity components. */</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udxdx = rhoInv*(d2rudxdx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodxdx</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                              +         2.0*rhoInv*drhodx*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx - drudx));</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udydy = rhoInv*(d2rudydy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodydy</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                              +         2.0*rhoInv*drhody*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody - drudy));</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udxdy = rhoInv*(d2rudxdy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodxdy</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                              +         rhoInv*(drhodx*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody - drudy)</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                              +                 drhody*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx - drudx)));</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdxdx = rhoInv*(d2rvdxdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodxdx</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                              +         2.0*rhoInv*drhodx*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx - drvdx));</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdydy = rhoInv*(d2rvdydy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodydy</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                              +         2.0*rhoInv*drhody*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody - drvdy));</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdxdy = rhoInv*(d2rvdxdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodxdy</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                              +         rhoInv*(drhodx*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody - drvdy)</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                              +                 drhody*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx - drvdx)));</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160; </div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <span class="comment">/* Compute the second derivatives of the static energy. Note that this</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">         term appears in the heat flux and therefore only the pure second</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">         derivatives are needed. Hence, the cross-derivatives are omitted. */</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2edxdx = rhoInv*(d2rEdxdx - TotalEnergy*d2rhodxdx</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                              +         2.0*rhoInv*drhodx*(TotalEnergy*drhodx - drEdx))</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                              -         <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2udxdx - dudx*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2vdxdx - dvdx*dvdx;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2edydy = rhoInv*(d2rEdydy - TotalEnergy*d2rhodydy</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                              +         2.0*rhoInv*drhody*(TotalEnergy*drhody - drEdy))</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                              -         <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2udydy - dudy*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2vdydy - dvdy*dvdy;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <span class="comment">/* If an SGS model is used the eddy viscosity and its spatial</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">         derivatives must be computed. */</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscTurbdx = 0.0, dViscTurbdy = 0.0;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dist = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#abcd8ed2e51e1429b0f164086419a40ff">wallDistance</a>[i];</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        ViscosityTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(rho, dudx, dudy, dvdx,</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                                                          dvdy, lenScale, dist);</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        SGSModel-&gt;<a class="code" href="classCSGSModel.html#a32de4fde5231a347640bf08d5be8876a">ComputeGradEddyViscosity_2D</a>(rho, drhodx, drhody, dudx, dudy,</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                                              dvdx, dvdy, d2udxdx, d2udydy, d2udxdy,</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                                              d2vdxdx, d2vdydy, d2vdxdy, lenScale,</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                                              dist, dViscTurbdx, dViscTurbdy);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      }</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      <span class="comment">/* Compute the total viscosity, the total heat conductivity and their</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">         gradients. Note that the heat conductivity is divided by the Cv,</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">         because gradients of internal energy are computed and not temperature. */</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                              + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160; </div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscDx = dViscLamdx + dViscTurbdx;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscDy = dViscLamdy + dViscTurbdy;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dkOverCvdx = dViscLamdx *factHeatFlux_Lam</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                                 + dViscTurbdx*factHeatFlux_Turb;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dkOverCvdy = dViscLamdy *factHeatFlux_Lam</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                                 + dViscTurbdy*factHeatFlux_Turb;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; </div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      <span class="comment">/* Abbreviations, which make it easier to compute the divergence term. */</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv1 = drudx + drvdy;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv2 = <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv3 = <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*(drEdx + dpdx) + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*(drEdy + dpdy);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv4 = dudx + dvdy;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160; </div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      <span class="comment">/* Compute the divergence of the grid velocity.</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="comment">         SET TO ZERO FOR NOW. THIS IS NOT CORRECT!!!!. */</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> divGridVel = 0.0;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160; </div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      <span class="comment">/* Set the pointer to store the divergence terms for this integration</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">         point and compute these terms, multiplied by the integration weight</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment">         and Jacobian. */</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *divFluxInt     = divFlux + offInt;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      divFluxInt[0] = weightJac*(abv1 - rho*divGridVel</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                    -            gridVel[0]*drhodx - gridVel[1]*drhody);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      divFluxInt[1] = weightJac*(dpdx + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*(abv1-abv2) - lambdaOverMu*abv4*dViscDx</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                    +            <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drudx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drudy</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdx + d2vdxdy)</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                    -            Viscosity*(2.0*d2udxdx + d2udydy + d2vdxdy)</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                    -            2.0*dViscDx*dudx - dViscDy*(dudy+dvdx)</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                    -            ru*divGridVel</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                    -            gridVel[0]*drudx - gridVel[1]*drudy);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      divFluxInt[2] = weightJac*(dpdy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*(abv1-abv2) - lambdaOverMu*abv4*dViscDy</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                    +            <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drvdx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drvdy</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdy + d2vdydy)</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                    -            Viscosity*(2.0*d2vdydy + d2vdxdx + d2udxdy)</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                    -            dViscDx*(dudy + dvdx) - 2.0*dViscDy*dvdy</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                    -            rv*divGridVel</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                    -            gridVel[0]*drvdx - gridVel[1]*drvdy);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      divFluxInt[3] = weightJac*(abv3 + Htot*(abv1 - abv2)</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                    -            abv4*lambdaOverMu*(Viscosity*abv4 + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dViscDx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dViscDy)</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                    -            dkOverCvdx*dedx - dkOverCvdy*dedy - kOverCv*(d2edxdx + d2edydy)</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                    -            (Viscosity*dudx + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dViscDx)*2.0*dudx</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                    -            (Viscosity*dvdy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dViscDy)*2.0*dvdy</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                    -            (Viscosity*dudy + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dViscDy + Viscosity*dvdx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dViscDx)*(dudy + dvdx)</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                    -            Viscosity*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*(d2udxdx+d2udydy + (1.0+lambdaOverMu)*(d2udxdx+d2vdxdy))</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                    -            Viscosity*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*(d2vdxdx+d2vdydy + (1.0+lambdaOverMu)*(d2udxdy+d2vdydy))</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                    -            rE*divGridVel</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                    -            gridVel[0]*drEdx - gridVel[1]*drEdy);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; </div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">         equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment">         integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">         the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">         velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      divFluxInt[1] -= weightJac*bodyForceX;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      divFluxInt[2] -= weightJac*bodyForceY;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      divFluxInt[3] -= weightJac*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*bodyForceX + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*bodyForceY);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    }</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  }</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="comment">/*--- Add the source terms of the manufactured solution to the divergence---*/</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <span class="comment">/*--- of the fluxes, if a manufactured solution is used.                 ---*/</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a> ) {</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#ad236e991301c3037e45206d939deb668">IsManufacturedSolution</a>() ) {</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160; </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;          <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160; </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;          <span class="comment">/* Set the pointer to the coordinates in this integration point.</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment">             THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">             BE TAKEN. */</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *coor = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a51a6fc4be49459ff00b9391ba87291cd">coorIntegrationPoints</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160; </div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;          <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="comment">             THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment">             BE TAKEN. */</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac    = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;          <span class="comment">/* Compute the source terms of the manufactured solution.</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. FOR AN ACTUAL TIME ACCURATE</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">             SIMULATION THE CORRECT TIME MUST BE GIVEN TO THIS FUNCTION. */</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> sourceMan[4];</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;          <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#acb2e19001e55c60e498be21ff5c8a085">GetMMSSourceTerm</a>(coor, 0.0, sourceMan);</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; </div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;          <span class="comment">/* Add the source terms to the flux divergence. Note that the source</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">             terms are multiplied with minus the integration weight in order</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">             to be consistent with the formulation of the residual. */</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;          divFluxInt[0] -= weightJac*sourceMan[0];</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;          divFluxInt[1] -= weightJac*sourceMan[1];</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;          divFluxInt[2] -= weightJac*sourceMan[2];</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;          divFluxInt[3] -= weightJac*sourceMan[3];</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        }</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      }</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  }</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160; </div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;}</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ADER_DG_NonAliasedPredictorResidual_3D(<a class="code" href="classCConfig.html">CConfig</a>              *config,</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                                                              <a class="code" href="classCVolumeElementFEM.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *sol,</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                                                              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>            *res,</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                                                              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>            *work) {</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, the inverse of</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">     the specific heat at constant volume and ratio lambdaOverMu. */</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam  =  <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Turb =  <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant      =  config-&gt;<a class="code" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> CvInv             =  <a class="code" href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>/Gas_Constant;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambdaOverMu      = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  <span class="comment">/*--- Get the necessary information from the standard element. ---*/</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matBasisInt            = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a51b506fa4dc4b72b40b32dd0c85590f9">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *mat2ndDerBasisInt      = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a4c15d676cd2b35367cbeea38f4a634b6">GetMat2ndDerBasisFunctionsInt</a>();</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *basisFunctionsIntTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#affb3cc64405ea150788c7c9739d8d6d5">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *weights                = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160; </div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;  <span class="comment">/* Check if a body force is present and set it accordingly. */</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> bodyForceX = 0.0, bodyForceY = 0.0, bodyForceZ = 0.0;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="classCConfig.html#a90249ccb3ccab165af6d95dc5d4fc68f">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *body_force_vector = config-&gt;<a class="code" href="classCConfig.html#adcfe24128655d4e063972fabd35b101e">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    bodyForceX = body_force_vector[0];</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    bodyForceY = body_force_vector[1];</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    bodyForceZ = body_force_vector[2];</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  }</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; </div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  <span class="comment">/* Compute the length scale of the current element for the LES. */</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  <span class="comment">/* Set the pointers for solAndGradInt and divFlux to work. The same array</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">     can be used for both help arrays. */</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solAndGradInt = work;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *divFlux       = work;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160; </div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  <span class="comment">/* Determine the offset between the solution variables and the r-derivatives,</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">     which is also the offset between the r- and s-derivatives in the</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">     integration points. */</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivInt = NPad*nInt;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  <span class="comment">/* Set the pointer for the second derivatives such that they are stored</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">     after the first derivatives. */</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *secDerSol = solAndGradInt + 4*NPad*nInt;  <span class="comment">/*(nDim+1)*NPad*nInt. */</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 10;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160; </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="comment">/* Store the number of additional metric points per integration point, which</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment">     are needed to compute the second derivatives. These terms take the</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment">     non-constant metric into account. */</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetric2ndDerPerPoint = 18; <span class="comment">/*nDim*(nDim + nDim*(nDim-1)/2). */</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  <span class="comment">/*--- Interpolate the solution variables to the integration points and   ---*/</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="comment">/*--- also determine the first and second derivatives of these variables ---*/</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  <span class="comment">/*--- in the integration points. All derivatives are w.r.t. the          ---*/</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;  <span class="comment">/*--- parametric coordinates.                                            ---*/</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;  <span class="comment">/* Compute the solution and the derivatives w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">     in the integration points. The first argument is nInt*(nDim+1). */</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*4, NPad, nDOFs, matBasisInt, sol, solAndGradInt, config);</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160; </div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;  <span class="comment">/* Compute the second derivatives w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="comment">     in the integration points. */</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*6, NPad, nDOFs, mat2ndDerBasisInt, sol, secDerSol, config);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160; </div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  <span class="comment">/*--- Compute the divergence of viscous fluxes, multiplied by the        ---*/</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  <span class="comment">/*--- integration weight in the integration points of the element.       ---*/</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160; </div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="comment">/*--- Loop over the integration points. ---*/</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160; </div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="comment">/* Easier storage of the locations where the solution and the gradient</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="comment">         data of this integration point start. */</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = NPad*i + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol   = solAndGradInt + offInt;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDr = sol   + offDerivInt;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDs = solDr + offDerivInt;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDt = solDs + offDerivInt;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      <span class="comment">/* Easier storage of the locations where the second derivatives are</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">         stored for this integration point. */</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDrDr = secDerSol + offInt;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDrDs = solDrDr   + offDerivInt;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDsDs = solDrDs   + offDerivInt;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDrDt = solDsDs   + offDerivInt;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDsDt = solDrDt   + offDerivInt;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDtDt = solDsDt   + offDerivInt;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160; </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <span class="comment">/* Compute the velocities, pressure and total enthalpy</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">         in this integration point. */</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rho = sol[0];</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ru  = sol[1];</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rv  = sol[2];</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rw  = sol[3];</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rE  = sol[4];</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv       = 1.0/rho;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = rhoInv*ru;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = rhoInv*rv;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> w            = rhoInv*rw;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kinEnergy    = 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> + w*w);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = rhoInv*rE;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - kinEnergy;</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160; </div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(rho, StaticEnergy);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Pressure = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">GetPressure</a>();</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Htot     = rhoInv*(rE + Pressure);</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160; </div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;       <span class="comment">/* Compute the laminar viscosity and its derivative w.r.t. temperature. */</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscLamdT   = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#abe5c1bbc7a5822be2ca700a296a0090a">GetdmudT_rho</a>();</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160; </div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities in this integration point.</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + 3*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160; </div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160; </div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      <span class="comment">/* Compute the true metric terms. Note in metricTerms the actual metric</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="comment">         terms multiplied by the Jacobian are stored. */</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Jac    = metricTerms[0];</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> JacInv = 1.0/Jac;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160; </div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdz = JacInv*metricTerms[3];</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160; </div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = JacInv*metricTerms[4];</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = JacInv*metricTerms[5];</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdz = JacInv*metricTerms[6];</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160; </div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdx = JacInv*metricTerms[7];</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdy = JacInv*metricTerms[8];</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdz = JacInv*metricTerms[9];</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160; </div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">         variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="comment">         metric terms in this integration point. */</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodx = solDr[0]*drdx + solDs[0]*dsdx + solDt[0]*dtdx;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudx  = solDr[1]*drdx + solDs[1]*dsdx + solDt[1]*dtdx;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdx  = solDr[2]*drdx + solDs[2]*dsdx + solDt[2]*dtdx;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdx  = solDr[3]*drdx + solDs[3]*dsdx + solDt[3]*dtdx;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdx  = solDr[4]*drdx + solDs[4]*dsdx + solDt[4]*dtdx;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160; </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhody = solDr[0]*drdy + solDs[0]*dsdy + solDt[0]*dtdy;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudy  = solDr[1]*drdy + solDs[1]*dsdy + solDt[1]*dtdy;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdy  = solDr[2]*drdy + solDs[2]*dsdy + solDt[2]*dtdy;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdy  = solDr[3]*drdy + solDs[3]*dsdy + solDt[3]*dtdy;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdy  = solDr[4]*drdy + solDs[4]*dsdy + solDt[4]*dtdy;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160; </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drhodz = solDr[0]*drdz + solDs[0]*dsdz + solDt[0]*dtdz;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drudz  = solDr[1]*drdz + solDs[1]*dsdz + solDt[1]*dtdz;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drvdz  = solDr[2]*drdz + solDs[2]*dsdz + solDt[2]*dtdz;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drwdz  = solDr[3]*drdz + solDs[3]*dsdz + solDt[3]*dtdz;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drEdz  = solDr[4]*drdz + solDs[4]*dsdz + solDt[4]*dtdz;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160; </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      <span class="comment">/* Pointer to the necessary additional metric terms needed to compute</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment">         the Cartesian second derivatives for this integration point.</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment">         HIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms2ndDer = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a4dce50854c91ee9d721a72bbadd50254">metricTerms2ndDer</a>.data()</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                                         + i*nMetric2ndDerPerPoint;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160; </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <span class="comment">/* Compute the Cartesian second derivatives of the independent solution</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment">         variables from the gradients and second derivatives in parametric</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment">         coordinates and the metric terms and its derivatives w.r.t. the</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment">         parametric coordinates. */</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodxdx = solDrDr[0]*drdx*drdx + solDsDs[0]*dsdx*dsdx + solDtDt[0]*dtdx*dtdx</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                                + 2.0*(solDrDs[0]*drdx*dsdx + solDrDt[0]*drdx*dtdx + solDsDt[0]*dsdx*dtdx)</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                                + solDr[0]*metricTerms2ndDer[0] + solDs[0]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                                + solDt[0]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudxdx  = solDrDr[1]*drdx*drdx + solDsDs[1]*dsdx*dsdx + solDtDt[1]*dtdx*dtdx</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                                + 2.0*(solDrDs[1]*drdx*dsdx + solDrDt[1]*drdx*dtdx + solDsDt[1]*dsdx*dtdx)</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                                + solDr[1]*metricTerms2ndDer[0] + solDs[1]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                                + solDt[1]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdxdx  = solDrDr[2]*drdx*drdx + solDsDs[2]*dsdx*dsdx + solDtDt[2]*dtdx*dtdx</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                                + 2.0*(solDrDs[2]*drdx*dsdx + solDrDt[2]*drdx*dtdx + solDsDt[2]*dsdx*dtdx)</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                                + solDr[2]*metricTerms2ndDer[0] + solDs[2]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                                + solDt[2]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rwdxdx  = solDrDr[3]*drdx*drdx + solDsDs[3]*dsdx*dsdx + solDtDt[3]*dtdx*dtdx</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                                + 2.0*(solDrDs[3]*drdx*dsdx + solDrDt[3]*drdx*dtdx + solDsDt[3]*dsdx*dtdx)</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                                + solDr[3]*metricTerms2ndDer[0] + solDs[3]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                                + solDt[3]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rEdxdx  = solDrDr[4]*drdx*drdx + solDsDs[4]*dsdx*dsdx + solDtDt[4]*dtdx*dtdx</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                                + 2.0*(solDrDs[4]*drdx*dsdx + solDrDt[4]*drdx*dtdx + solDsDt[4]*dsdx*dtdx)</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                                + solDr[4]*metricTerms2ndDer[0] + solDs[4]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                                + solDt[4]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodydy = solDrDr[0]*drdy*drdy + solDsDs[0]*dsdy*dsdy + solDtDt[0]*dtdy*dtdy</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                                + 2.0*(solDrDs[0]*drdy*dsdy + solDrDt[0]*drdy*dtdy + solDsDt[0]*dsdy*dtdy)</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                                + solDr[0]*metricTerms2ndDer[6] + solDs[0]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                                + solDt[0]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudydy  = solDrDr[1]*drdy*drdy + solDsDs[1]*dsdy*dsdy + solDtDt[1]*dtdy*dtdy</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                                + 2.0*(solDrDs[1]*drdy*dsdy + solDrDt[1]*drdy*dtdy + solDsDt[1]*dsdy*dtdy)</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                                + solDr[1]*metricTerms2ndDer[6] + solDs[1]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                                + solDt[1]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdydy  = solDrDr[2]*drdy*drdy + solDsDs[2]*dsdy*dsdy + solDtDt[2]*dtdy*dtdy</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                                + 2.0*(solDrDs[2]*drdy*dsdy + solDrDt[2]*drdy*dtdy + solDsDt[2]*dsdy*dtdy)</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                                + solDr[2]*metricTerms2ndDer[6] + solDs[2]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                                + solDt[2]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rwdydy  = solDrDr[3]*drdy*drdy + solDsDs[3]*dsdy*dsdy + solDtDt[3]*dtdy*dtdy</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;                                + 2.0*(solDrDs[3]*drdy*dsdy + solDrDt[3]*drdy*dtdy + solDsDt[3]*dsdy*dtdy)</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                                + solDr[3]*metricTerms2ndDer[6] + solDs[3]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                                + solDt[3]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rEdydy  = solDrDr[4]*drdy*drdy + solDsDs[4]*dsdy*dsdy + solDtDt[4]*dtdy*dtdy</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;                                + 2.0*(solDrDs[4]*drdy*dsdy + solDrDt[4]*drdy*dtdy + solDsDt[4]*dsdy*dtdy)</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                                + solDr[4]*metricTerms2ndDer[6] + solDs[4]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                                + solDt[4]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodzdz = solDrDr[0]*drdz*drdz + solDsDs[0]*dsdz*dsdz + solDtDt[0]*dtdz*dtdz</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                                + 2.0*(solDrDs[0]*drdz*dsdz + solDrDt[0]*drdz*dtdz + solDsDt[0]*dsdz*dtdz)</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                                + solDr[0]*metricTerms2ndDer[15] + solDs[0]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;                                + solDt[0]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudzdz  = solDrDr[1]*drdz*drdz + solDsDs[1]*dsdz*dsdz + solDtDt[1]*dtdz*dtdz</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;                                + 2.0*(solDrDs[1]*drdz*dsdz + solDrDt[1]*drdz*dtdz + solDsDt[1]*dsdz*dtdz)</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;                                + solDr[1]*metricTerms2ndDer[15] + solDs[1]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                                + solDt[1]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdzdz  = solDrDr[2]*drdz*drdz + solDsDs[2]*dsdz*dsdz + solDtDt[2]*dtdz*dtdz</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;                                + 2.0*(solDrDs[2]*drdz*dsdz + solDrDt[2]*drdz*dtdz + solDsDt[2]*dsdz*dtdz)</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;                                + solDr[2]*metricTerms2ndDer[15] + solDs[2]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                                + solDt[2]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rwdzdz  = solDrDr[3]*drdz*drdz + solDsDs[3]*dsdz*dsdz + solDtDt[3]*dtdz*dtdz</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                                + 2.0*(solDrDs[3]*drdz*dsdz + solDrDt[3]*drdz*dtdz + solDsDt[3]*dsdz*dtdz)</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                                + solDr[3]*metricTerms2ndDer[15] + solDs[3]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                                + solDt[3]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rEdzdz  = solDrDr[4]*drdz*drdz + solDsDs[4]*dsdz*dsdz + solDtDt[4]*dtdz*dtdz</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                                + 2.0*(solDrDs[4]*drdz*dsdz + solDrDt[4]*drdz*dtdz + solDsDt[4]*dsdz*dtdz)</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                                + solDr[4]*metricTerms2ndDer[15] + solDs[4]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                                + solDt[4]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160; </div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodxdy = solDrDr[0]*drdx*drdy + solDsDs[0]*dsdx*dsdy + solDtDt[0]*dtdx*dtdy</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;                                + solDrDs[0]*(drdx*dsdy + dsdx*drdy) + solDrDt[0]*(drdx*dtdy + dtdx*drdy)</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;                                + solDsDt[0]*(dsdx*dtdy + dtdx*dsdy) + solDr[0]*metricTerms2ndDer[3]</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;                                + solDs[0]*metricTerms2ndDer[4] + solDt[0]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudxdy  = solDrDr[1]*drdx*drdy + solDsDs[1]*dsdx*dsdy + solDtDt[1]*dtdx*dtdy</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                                + solDrDs[1]*(drdx*dsdy + dsdx*drdy) + solDrDt[1]*(drdx*dtdy + dtdx*drdy)</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                                + solDsDt[1]*(dsdx*dtdy + dtdx*dsdy) + solDr[1]*metricTerms2ndDer[3]</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                                + solDs[1]*metricTerms2ndDer[4] + solDt[1]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdxdy  = solDrDr[2]*drdx*drdy + solDsDs[2]*dsdx*dsdy + solDtDt[2]*dtdx*dtdy</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                                + solDrDs[2]*(drdx*dsdy + dsdx*drdy) + solDrDt[2]*(drdx*dtdy + dtdx*drdy)</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                                + solDsDt[2]*(dsdx*dtdy + dtdx*dsdy) + solDr[2]*metricTerms2ndDer[3]</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                                + solDs[2]*metricTerms2ndDer[4] + solDt[2]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rwdxdy  = solDrDr[3]*drdx*drdy + solDsDs[3]*dsdx*dsdy + solDtDt[3]*dtdx*dtdy</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                                + solDrDs[3]*(drdx*dsdy + dsdx*drdy) + solDrDt[3]*(drdx*dtdy + dtdx*drdy)</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                                + solDsDt[3]*(dsdx*dtdy + dtdx*dsdy) + solDr[3]*metricTerms2ndDer[3]</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                                + solDs[3]*metricTerms2ndDer[4] + solDt[3]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodxdz = solDrDr[0]*drdx*drdz + solDsDs[0]*dsdx*dsdz + solDtDt[0]*dtdx*dtdz</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                                + solDrDs[0]*(drdx*dsdz + dsdx*drdz) + solDrDt[0]*(drdx*dtdz + dtdx*drdz)</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                                + solDsDt[0]*(dsdx*dtdz + dtdx*dsdz) + solDr[0]*metricTerms2ndDer[9]</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                                + solDs[0]*metricTerms2ndDer[10] + solDt[0]*metricTerms2ndDer[11];</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudxdz  = solDrDr[1]*drdx*drdz + solDsDs[1]*dsdx*dsdz + solDtDt[1]*dtdx*dtdz</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                                + solDrDs[1]*(drdx*dsdz + dsdx*drdz) + solDrDt[1]*(drdx*dtdz + dtdx*drdz)</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                                + solDsDt[1]*(dsdx*dtdz + dtdx*dsdz) + solDr[1]*metricTerms2ndDer[9]</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                                + solDs[1]*metricTerms2ndDer[10] + solDt[1]*metricTerms2ndDer[11];</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdxdz  = solDrDr[2]*drdx*drdz + solDsDs[2]*dsdx*dsdz + solDtDt[2]*dtdx*dtdz</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                                + solDrDs[2]*(drdx*dsdz + dsdx*drdz) + solDrDt[2]*(drdx*dtdz + dtdx*drdz)</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                                + solDsDt[2]*(dsdx*dtdz + dtdx*dsdz) + solDr[2]*metricTerms2ndDer[9]</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                                + solDs[2]*metricTerms2ndDer[10] + solDt[2]*metricTerms2ndDer[11];</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rwdxdz  = solDrDr[3]*drdx*drdz + solDsDs[3]*dsdx*dsdz + solDtDt[3]*dtdx*dtdz</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;                                + solDrDs[3]*(drdx*dsdz + dsdx*drdz) + solDrDt[3]*(drdx*dtdz + dtdx*drdz)</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                                + solDsDt[3]*(dsdx*dtdz + dtdx*dsdz) + solDr[3]*metricTerms2ndDer[9]</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                                + solDs[3]*metricTerms2ndDer[10] + solDt[3]*metricTerms2ndDer[11];</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160; </div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rhodydz = solDrDr[0]*drdy*drdz + solDsDs[0]*dsdy*dsdz + solDtDt[0]*dtdy*dtdz</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                                + solDrDs[0]*(drdy*dsdz + dsdy*drdz) + solDrDt[0]*(drdy*dtdz + dtdy*drdz)</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                                + solDsDt[0]*(dsdy*dtdz + dtdy*dsdz) + solDr[0]*metricTerms2ndDer[12]</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                                + solDs[0]*metricTerms2ndDer[13] + solDt[0]*metricTerms2ndDer[14];</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rudydz  = solDrDr[1]*drdy*drdz + solDsDs[1]*dsdy*dsdz + solDtDt[1]*dtdy*dtdz</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                                + solDrDs[1]*(drdy*dsdz + dsdy*drdz) + solDrDt[1]*(drdy*dtdz + dtdy*drdz)</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                                + solDsDt[1]*(dsdy*dtdz + dtdy*dsdz) + solDr[1]*metricTerms2ndDer[12]</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                                + solDs[1]*metricTerms2ndDer[13] + solDt[1]*metricTerms2ndDer[14];</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rvdydz  = solDrDr[2]*drdy*drdz + solDsDs[2]*dsdy*dsdz + solDtDt[2]*dtdy*dtdz</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                                + solDrDs[2]*(drdy*dsdz + dsdy*drdz) + solDrDt[2]*(drdy*dtdz + dtdy*drdz)</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;                                + solDsDt[2]*(dsdy*dtdz + dtdy*dsdz) + solDr[2]*metricTerms2ndDer[12]</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;                                + solDs[2]*metricTerms2ndDer[13] + solDt[2]*metricTerms2ndDer[14];</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2rwdydz  = solDrDr[3]*drdy*drdz + solDsDs[3]*dsdy*dsdz + solDtDt[3]*dtdy*dtdz</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                                + solDrDs[3]*(drdy*dsdz + dsdy*drdz) + solDrDt[3]*(drdy*dtdz + dtdy*drdz)</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                                + solDsDt[3]*(dsdy*dtdz + dtdy*dsdz) + solDr[3]*metricTerms2ndDer[12]</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                                + solDs[3]*metricTerms2ndDer[13] + solDt[3]*metricTerms2ndDer[14];</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160; </div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the pressure, velocity components,</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="comment">         static energy and dynamic viscosity. */</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dpdx = <a class="code" href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdx + kinEnergy*drhodx</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                           -                  <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drvdx - w*drwdx);</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dpdy = <a class="code" href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdy + kinEnergy*drhody</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                           -                  <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drvdy - w*drwdy);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dpdz = <a class="code" href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdz + kinEnergy*drhodz</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                           -                  <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drudz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drvdz - w*drwdz);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160; </div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = rhoInv*(drudx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx);</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = rhoInv*(drudy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudz = rhoInv*(drudz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodz);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160; </div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = rhoInv*(drvdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = rhoInv*(drvdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdz = rhoInv*(drvdz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodz);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; </div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdx = rhoInv*(drwdx - w*drhodx);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdy = rhoInv*(drwdy - w*drhody);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdz = rhoInv*(drwdz - w*drhodz);</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160; </div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedx = rhoInv*(drEdx - TotalEnergy*drhodx) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx - w*dwdx;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedy = rhoInv*(drEdy - TotalEnergy*drhody) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy - w*dwdy;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dedz = rhoInv*(drEdz - TotalEnergy*drhodz) - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdz - w*dwdz;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160; </div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscLamdx = CvInv*dedx*dViscLamdT;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscLamdy = CvInv*dedy*dViscLamdT;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscLamdz = CvInv*dedz*dViscLamdT;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      <span class="comment">/*--- Compute the second derivatives of the velocity components. ---*/</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udxdx = rhoInv*(d2rudxdx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodxdx</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                              +         2.0*rhoInv*drhodx*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx - drudx));</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udydy = rhoInv*(d2rudydy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodydy</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                              +         2.0*rhoInv*drhody*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody - drudy));</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udzdz = rhoInv*(d2rudzdz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodzdz</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                              +         2.0*rhoInv*drhodz*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodz - drudz));</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udxdy = rhoInv*(d2rudxdy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodxdy</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                              +         rhoInv*(drhodx*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody - drudy)</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                              +                 drhody*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx - drudx)));</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udxdz = rhoInv*(d2rudxdz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodxdz</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                              +         rhoInv*(drhodx*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodz - drudz)</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                              +                 drhodz*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx - drudx)));</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2udydz = rhoInv*(d2rudydz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2rhodydz</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                              +         rhoInv*(drhody*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodz - drudz)</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                              +                 drhodz*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhody - drudy)));</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdxdx = rhoInv*(d2rvdxdx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodxdx</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                              +         2.0*rhoInv*drhodx*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx - drvdx));</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdydy = rhoInv*(d2rvdydy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodydy</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                              +         2.0*rhoInv*drhody*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody - drvdy));</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdzdz = rhoInv*(d2rvdzdz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodzdz</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                              +         2.0*rhoInv*drhodz*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodz - drvdz));</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdxdy = rhoInv*(d2rvdxdy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodxdy</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                              +         rhoInv*(drhodx*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody - drvdy)</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                              +                 drhody*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx - drvdx)));</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdxdz = rhoInv*(d2rvdxdz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodxdz</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                              +         rhoInv*(drhodx*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodz - drvdz)</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                              +                 drhodz*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodx - drvdx)));</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2vdydz = rhoInv*(d2rvdydz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2rhodydz</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                              +         rhoInv*(drhody*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhodz - drvdz)</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                              +                 drhodz*(<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody - drvdy)));</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160; </div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2wdxdx = rhoInv*(d2rwdxdx - w*d2rhodxdx</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                              +         2.0*rhoInv*drhodx*(w*drhodx - drwdx));</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2wdydy = rhoInv*(d2rwdydy - w*d2rhodydy</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                              +         2.0*rhoInv*drhody*(w*drhody - drwdy));</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2wdzdz = rhoInv*(d2rwdzdz - w*d2rhodzdz</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                              +         2.0*rhoInv*drhodz*(w*drhodz - drwdz));</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2wdxdy = rhoInv*(d2rwdxdy - w*d2rhodxdy</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                              +         rhoInv*(drhodx*(w*drhody - drwdy)</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                              +                 drhody*(w*drhodx - drwdx)));</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2wdxdz = rhoInv*(d2rwdxdz - w*d2rhodxdz</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                              +         rhoInv*(drhodx*(w*drhodz - drwdz)</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                              +                 drhodz*(w*drhodx - drwdx)));</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2wdydz = rhoInv*(d2rwdydz - w*d2rhodydz</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                              +         rhoInv*(drhody*(w*drhodz - drwdz)</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                              +                 drhodz*(w*drhody - drwdy)));</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160; </div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      <span class="comment">/* Compute the second derivatives of the static energy. Note that this</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment">         term appears in the heat flux and therefore only the pure second</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment">         derivatives are needed. Hence, the cross-derivatives are omitted. */</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2edxdx = rhoInv*(d2rEdxdx - TotalEnergy*d2rhodxdx</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                              +         2.0*rhoInv*drhodx*(TotalEnergy*drhodx - drEdx))</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                              -         <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2udxdx - dudx*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2vdxdx - dvdx*dvdx</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                              -         w*d2wdxdx - dwdx*dwdx;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2edydy = rhoInv*(d2rEdydy - TotalEnergy*d2rhodydy</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                              +         2.0*rhoInv*drhody*(TotalEnergy*drhody - drEdy))</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                              -         <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2udydy - dudy*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2vdydy - dvdy*dvdy</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                              -         w*d2wdydy - dwdy*dwdy;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> d2edzdz = rhoInv*(d2rEdzdz - TotalEnergy*d2rhodzdz</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                              +         2.0*rhoInv*drhodz*(TotalEnergy*drhodz - drEdz))</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                              -         <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*d2udzdz - dudz*dudz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*d2vdzdz - dvdz*dvdz</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                              -         w*d2wdzdz - dwdz*dwdz;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160; </div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;      <span class="comment">/*--- If an SGS model is used the eddy viscosity and its spatial</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment">            derivatives must be computed. ---*/</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscTurbdx = 0.0, dViscTurbdy = 0.0, dViscTurbdz = 0.0;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dist = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#abcd8ed2e51e1429b0f164086419a40ff">wallDistance</a>[i];</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        ViscosityTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(rho, dudx, dudy, dudz,</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                                                          dvdx, dvdy, dvdz, dwdx,</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                                                          dwdy, dwdz, lenScale, dist);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        SGSModel-&gt;<a class="code" href="classCSGSModel.html#a2d935e92d5cb774b14e5763ca6389a99">ComputeGradEddyViscosity_3D</a>(rho, drhodx, drhody, drhodz, dudx, dudy,</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                                              dudz, dvdx, dvdy, dvdz, dwdx, dwdy, dwdz,</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                                              d2udxdx, d2udydy, d2udzdz, d2udxdy,</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                                              d2udxdz, d2udydz, d2vdxdx, d2vdydy,</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                                              d2vdzdz, d2vdxdy, d2vdxdz, d2vdydz,</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                                              d2wdxdx, d2wdydy, d2wdzdz, d2wdxdy,</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                                              d2wdxdz, d2wdydz, lenScale, dist,</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                                              dViscTurbdx, dViscTurbdy, dViscTurbdz);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      }</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160; </div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      <span class="comment">/*--- Compute the total viscosity, the total heat conductivity and their</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="comment">            gradients. Note that the heat conductivity is divided by the Cv,</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="comment">            because gradients of internal energy are computed and not temperature. ---*/</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                              + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160; </div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscDx = dViscLamdx + dViscTurbdx;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscDy = dViscLamdy + dViscTurbdy;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dViscDz = dViscLamdz + dViscTurbdz;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160; </div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dkOverCvdx = dViscLamdx *factHeatFlux_Lam</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                                 + dViscTurbdx*factHeatFlux_Turb;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dkOverCvdy = dViscLamdy *factHeatFlux_Lam</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                                 + dViscTurbdy*factHeatFlux_Turb;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dkOverCvdz = dViscLamdz *factHeatFlux_Lam</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                                 + dViscTurbdz*factHeatFlux_Turb;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160; </div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      <span class="comment">/* Abbreviations, which make it easier to compute the divergence term. */</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv1 = drudx + drvdy + drwdz;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv2 = <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drhodx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drhody + w*drhodz;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv3 = <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*(drEdx + dpdx) + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*(drEdy + dpdy) + w*(drEdz + dpdz);</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv4 = dudx + dvdy + dwdz;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;      <span class="comment">/*--- Compute the divergence of the grid velocity.</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="comment">            SET TO ZERO FOR NOW. THIS IS NOT CORRECT!!!!. ---*/</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> divGridVel = 0.0;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160; </div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      <span class="comment">/* Set the pointer to store the divergence terms for this integration</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment">         point and compute these terms, multiplied by the integration weight</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment">         and Jacobian. */</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *divFluxInt     = divFlux + offInt;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160; </div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      divFluxInt[0] = weightJac*(abv1 - rho*divGridVel - gridVel[0]*drhodx</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;                    -            gridVel[1]*drhody - gridVel[2]*drhodz);</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      divFluxInt[1] = weightJac*(dpdx + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*(abv1-abv2) - lambdaOverMu*abv4*dViscDx</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                    +            <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drudx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drudy + w*drudz</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdx + d2vdxdy + d2wdxdz)</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;                    -            Viscosity*(2.0*d2udxdx + d2udydy + d2vdxdy + d2udzdz + d2wdxdz)</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                    -            2.0*dViscDx*dudx - dViscDy*(dudy+dvdx) - dViscDz*(dudz+dwdx)</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;                    -            ru*divGridVel</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                    -            gridVel[0]*drudx - gridVel[1]*drudy - gridVel[2]*drudz);</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;      divFluxInt[2] = weightJac*(dpdy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*(abv1-abv2) - lambdaOverMu*abv4*dViscDy</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                    +            <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drvdx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drvdy + w*drvdz</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdy + d2vdydy + d2wdydz)</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                    -            Viscosity*(d2udxdy + d2vdxdx + 2.0*d2vdydy + d2vdzdz + d2wdydz)</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;                    -            dViscDx*(dudy + dvdx) - 2.0*dViscDy*dvdy - dViscDz*(dvdz+dwdy)</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;                    -            rv*divGridVel</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                    -            gridVel[0]*drvdx - gridVel[1]*drvdy - gridVel[2]*drvdz);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      divFluxInt[3] = weightJac*(dpdz + w*(abv1-abv2) - lambdaOverMu*abv4*dViscDz</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                    +            <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*drwdx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*drwdy + w*drwdz</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdz + d2vdydz + d2wdzdz)</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                    -            Viscosity*(d2udxdz + d2wdxdx + d2vdydz + d2wdydy + 2.0*d2wdzdz)</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;                    -            dViscDx*(dudz+dwdx) - dViscDy*(dvdz+dwdy) - 2.0*dViscDz*dwdz</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                    -            rw*divGridVel</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                    -            gridVel[0]*drwdx - gridVel[1]*drwdy - gridVel[2]*drwdz);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;      divFluxInt[4] = weightJac*(abv3 + Htot*(abv1 - abv2)</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                    -            abv4*lambdaOverMu*(Viscosity*abv4 + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dViscDx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dViscDy + w*dViscDz)</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                    -            dkOverCvdx*dedx - dkOverCvdy*dedy - dkOverCvdz*dedz</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                    -            kOverCv*(d2edxdx + d2edydy + d2edzdz)</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                    -            (Viscosity*dudx + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dViscDx)*2.0*dudx</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                    -            (Viscosity*dvdy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dViscDy)*2.0*dvdy</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                    -            (Viscosity*dwdz + w*dViscDz)*2.0*dwdz</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                    -            (Viscosity*dudy + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dViscDy + Viscosity*dvdx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dViscDx)*(dudy + dvdx)</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                    -            (Viscosity*dudz + <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dViscDz + Viscosity*dwdx + w*dViscDx)*(dudz + dwdx)</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                    -            (Viscosity*dvdz + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dViscDz + Viscosity*dwdy + w*dViscDy)*(dvdz + dwdy)</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                    -            Viscosity*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*(d2udxdx+d2udydy+d2udzdz + (1.0+lambdaOverMu)*(d2udxdx+d2vdxdy+d2wdxdz))</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                    -            Viscosity*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*(d2vdxdx+d2vdydy+d2vdzdz + (1.0+lambdaOverMu)*(d2udxdy+d2vdydy+d2wdydz))</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                    -            Viscosity*w*(d2wdxdx+d2wdydy+d2wdzdz + (1.0+lambdaOverMu)*(d2udxdz+d2vdydz+d2wdzdz))</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                    -            rE*divGridVel</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                    -            gridVel[0]*drEdx - gridVel[1]*drEdy - gridVel[2]*drEdz);</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160; </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;      <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;<span class="comment">         equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="comment">         integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="comment">         the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;<span class="comment">         velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      divFluxInt[1] -= weightJac*bodyForceX;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      divFluxInt[2] -= weightJac*bodyForceY;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      divFluxInt[3] -= weightJac*bodyForceZ;</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      divFluxInt[4] -= weightJac*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*bodyForceX + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*bodyForceY + w*bodyForceZ);</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    }</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;  }</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  <span class="comment">/*--- Add the source terms of the manufactured solution to the divergence---*/</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <span class="comment">/*--- of the fluxes, if a manufactured solution is used.                 ---*/</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160; </div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a> ) {</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#ad236e991301c3037e45206d939deb668">IsManufacturedSolution</a>() ) {</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160; </div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160; </div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160; </div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160; </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;          <span class="comment">/* Set the pointer to the coordinates in this integration point.</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;<span class="comment">             THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment">             BE TAKEN. */</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *coor = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a51a6fc4be49459ff00b9391ba87291cd">coorIntegrationPoints</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160; </div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;          <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment">             THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;<span class="comment">             BE TAKEN. */</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = elem-&gt;<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac    = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160; </div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          <span class="comment">/* Compute the source terms of the manufactured solution.</span></div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;<span class="comment">             THIS IS A TEMPORARY IMPLEMENTATION. FOR AN ACTUAL TIME ACCURATE</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="comment">             SIMULATION THE CORRECT TIME MUST BE GIVEN TO THIS FUNCTION. */</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> sourceMan[5];</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;          <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#acb2e19001e55c60e498be21ff5c8a085">GetMMSSourceTerm</a>(coor, 0.0, sourceMan);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160; </div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;          <span class="comment">/* Add the source terms to the flux divergence. Note that the source</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="comment">             terms are multiplied with minus the integration weight in order</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;<span class="comment">             to be consistent with the formulation of the residual. */</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;          divFluxInt[0] -= weightJac*sourceMan[0];</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;          divFluxInt[1] -= weightJac*sourceMan[1];</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;          divFluxInt[2] -= weightJac*sourceMan[2];</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;          divFluxInt[3] -= weightJac*sourceMan[3];</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;          divFluxInt[4] -= weightJac*sourceMan[4];</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      }</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    }</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  }</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160; </div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160; </div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;}</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160; </div>
<div class="line"><a name="l02971"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#ac91dc7ef6eb5a6ede92a91708201e782"> 2971</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#ac91dc7ef6eb5a6ede92a91708201e782">CFEM_DG_NSSolver::Shock_Capturing_DG</a>(<a class="code" href="classCConfig.html">CConfig</a>             *config,</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                                          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>           *workArray) {</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160; </div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;  <span class="comment">/*--- Run shock capturing algorithm ---*/</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;  <span class="keywordflow">switch</span>( config-&gt;<a class="code" href="classCConfig.html#afa721d24bb2ffcb31bc0743f64dd33ee">GetKind_FEM_DG_Shock</a>() ) {</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a6f734d2019596d01b1a7bfad33a96d47ab50339a10e1de285ac99d4c3990b8693">FEM_SHOCK_CAPTURING_DG::NONE</a>:</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a6f734d2019596d01b1a7bfad33a96d47af19f3665dab8ceb999b7b0a1e972e332">FEM_SHOCK_CAPTURING_DG::PERSSON</a>:</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <a class="code" href="classCFEM__DG__NSSolver.html#a04fa3111afb642b208d97efe113ff1cf">Shock_Capturing_DG_Persson</a>(elemBeg, elemEnd, workArray);</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;  }</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160; </div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;}</div>
<div class="line"><a name="l02986"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a04fa3111afb642b208d97efe113ff1cf"> 2986</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a04fa3111afb642b208d97efe113ff1cf">CFEM_DG_NSSolver::Shock_Capturing_DG_Persson</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>           *workArray) {</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160; </div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  <span class="comment">/*--- Dummy variable for storing shock sensor value temporarily ---*/</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> sensorVal, sensorLowerBound, machNorm, machMax;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv, Velocity2, StaticEnergy, SoundSpeed2, Velocity2Rel;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160; </div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  <span class="keywordtype">bool</span> shockExist;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsPm1;       <span class="comment">// Number of DOFs up to polynomial degree p-1</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160; </div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;  <span class="comment">/*--- Loop over the given range of elements to sense the shock. If shock exists,</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="comment">        add artificial viscosity for DG FEM formulation to the residual.  ---*/</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd; ++l) {</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160; </div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <span class="comment">/* Get the data from the corresponding standard element. */</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind          = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs        = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> VTK_TypeElem = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#a2d8cb0d23c35d78eb7f0a1ebc95be2c1">VTK_Type</a>;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly        = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matVanderInv     = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#af525d0cd36565e5d1a452eaf927e14d0">GetMatVandermondeInv</a>();</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160; </div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    <span class="comment">/*--- Step 1: Calculate the number of DOFs up to polynomial degree p-1.    ---*/</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    <span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160; </div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    nDOFsPm1 = 0;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="keywordflow">switch</span>( VTK_TypeElem ) {</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a2fd33892864d1c342d3bead2f2d9ad56">TRIANGLE</a>:</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;        nDOFsPm1 = nPoly*(nPoly+1)/2;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a626d2901e9e521eb60f5681ada30849c">QUADRILATERAL</a>:</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        nDOFsPm1 = nPoly*nPoly;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977ad447314c433c39f567ca6bd240eae16a">TETRAHEDRON</a>:</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        nDOFsPm1 = nPoly*(nPoly+1)*(nPoly+2)/6;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a3fcd053f6577a9c10a59c3d3595658eb">PYRAMID</a>:</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        nDOFsPm1 = nPoly*(nPoly+1)*(2*nPoly+1)/6;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a4cc31b3ed970e3f26bfd2d491b8d7946">PRISM</a>:</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;        nDOFsPm1 = nPoly*nPoly*(nPoly+1)/2;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977aa67bd73e46a66076a9980159f8011a02">HEXAHEDRON</a>:</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;        nDOFsPm1 = nPoly*nPoly*nPoly;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    }</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160; </div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    <span class="comment">/*---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    <span class="comment">/*--- Step 2: Calculate the shock sensor value for this element.    ---*/</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;    <span class="comment">/*---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160; </div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    <span class="comment">/* Initialize dummy variable for this volume element */</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    sensorVal = 0;</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    machMax = -1;</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    shockExist = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    sensorLowerBound = 1.e15;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160; </div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    <span class="comment">/* Easier storage of the solution variables for this element. */</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFs = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;                             + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160; </div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <span class="comment">/* Temporary storage of mach number for DOFs in this element. */</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *machSolDOFs = workArray;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *vecTemp     = machSolDOFs + nDOFs;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; </div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    <span class="comment">/* Calculate primitive variables and mach number for DOFs in this element.</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="comment">       Also, track the maximum mach number in this element. */</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iInd=0; iInd&lt;nDOFs; ++iInd) {</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160; </div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol     = solDOFs + iInd*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + iInd*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;      DensityInv = 1.0/sol[0];</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      Velocity2 = 0.0;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;      Velocity2Rel = 0.0;</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=1; iDim&lt;=<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel    = sol[iDim]*DensityInv;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velRel = vel - gridVel[iDim-1];</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        Velocity2    += vel*vel;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        Velocity2Rel += velRel*velRel;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;      }</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160; </div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;      StaticEnergy = sol[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*DensityInv - 0.5*Velocity2;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160; </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;      SoundSpeed2 = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a654e55c4c6bb3914b40fbc27410876ba">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      machSolDOFs[iInd] = <a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>( Velocity2Rel/SoundSpeed2 );</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      machMax = max(machSolDOFs[iInd],machMax);</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    }</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160; </div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;    <span class="comment">/* Change the solution coefficients to modal form from nodal form */</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      vecTemp[i] = 0.0;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFs; ++j)</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;        vecTemp[i] += matVanderInv[i+j*nDOFs]*machSolDOFs[j];</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    }</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160; </div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    <span class="comment">/* Get the L2 norm of solution coefficients for the highest polynomial order. */</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=nDOFsPm1; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;        sensorVal += vecTemp[i]*vecTemp[i];</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    }</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="comment">/* If the maximum mach number is greater than 1.0, try to calculate the shockSensorValue.</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;<span class="comment">       Otherwise, assign default value. */</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <span class="keywordflow">if</span> ( machMax &gt; 1.0) {</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      <span class="comment">// !!!!!Threshold value for sensorVal should be further investigated</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;      <span class="keywordflow">if</span>(sensorVal &gt; 1.e-15) {</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        machNorm = 0.0;</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160; </div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;        <span class="comment">/*--- Get L2 norm square of vecTemp ---*/</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;          machNorm += vecTemp[i]*vecTemp[i];</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;        }</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;        <span class="keywordflow">if</span> (machNorm &lt; 1.e-15) {</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;          <span class="comment">// This should not happen</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;          <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#afee7aa41b9ef5cb33a6239ef2961fc57">shockSensorValue</a> = 1000.0;</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;        }</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;          <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#afee7aa41b9ef5cb33a6239ef2961fc57">shockSensorValue</a> = log(sensorVal/machNorm);</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;          shockExist = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        }</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      }</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;        <span class="comment">// There is no shock in this element</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;        <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#afee7aa41b9ef5cb33a6239ef2961fc57">shockSensorValue</a> = -1000.0;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      }</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    }</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#afee7aa41b9ef5cb33a6239ef2961fc57">shockSensorValue</a> = -1000.0;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160; </div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <span class="comment">/*---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="comment">/*--- Step 3: Determine artificial viscosity for this element.      ---*/</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="comment">/*---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <span class="keywordflow">if</span> (shockExist) {</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      <span class="comment">// Following if-else clause is purely empirical from NACA0012 case.</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <span class="comment">// Need to develop thorough method for general problems.</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      <span class="keywordflow">switch</span> ( nPoly ) {</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        <span class="keywordflow">case</span> 1:  sensorLowerBound =  -6.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        <span class="keywordflow">case</span> 2:  sensorLowerBound = -12.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        <span class="keywordflow">case</span> 3:  sensorLowerBound = -12.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        <span class="keywordflow">case</span> 4:  sensorLowerBound = -17.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        <span class="keywordflow">default</span>: sensorLowerBound = -17.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      }</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      <span class="comment">// Assign artificial viscosity based on shockSensorValue</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].shockSensorValue &gt; sensorLowerBound ) {</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        <span class="comment">// Following value is initial guess.</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#af8d803542e4530244295b095f0e40dcb">shockArtificialViscosity</a> = 1.e-10;</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      }</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#af8d803542e4530244295b095f0e40dcb">shockArtificialViscosity</a> = 0.0;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      }</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    }</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#af8d803542e4530244295b095f0e40dcb">shockArtificialViscosity</a> = 0.0;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    }</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;  }</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;}</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160; </div>
<div class="line"><a name="l03147"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#ace5ac45857734f2e764b4072249e5c2d"> 3147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#ace5ac45857734f2e764b4072249e5c2d">CFEM_DG_NSSolver::Volume_Residual</a>(<a class="code" href="classCConfig.html">CConfig</a>             *config,</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                                       <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>           *workArray) {</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160; </div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;  <span class="comment">/*--- Determine whether a body force term is present. ---*/</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;  <span class="keywordtype">bool</span> body_force = config-&gt;<a class="code" href="classCConfig.html#a90249ccb3ccab165af6d95dc5d4fc68f">GetBody_Force</a>();</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *body_force_vector = body_force ? config-&gt;<a class="code" href="classCConfig.html#adcfe24128655d4e063972fabd35b101e">GetBody_Force_Vector</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160; </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;  <span class="comment">/*--- Get the physical time if necessary. ---*/</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> time = 0.0;</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#ac47e04d76ce865893a94dcedd3c9b6a5">GetTime_Marching</a>() != <a class="code" href="option__structure_8hpp.html#a75d7083b30c2dd99c3f11ddb57226342ad1e7fb475a6de2107e56a5d516df332d">TIME_MARCHING::STEADY</a>) time = config-&gt;<a class="code" href="classCConfig.html#a4f4842f072c0484236e776956ff41cbb">GetPhysicalTime</a>();</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160; </div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector. */</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam  = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Turb = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160; </div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;  <span class="comment">/* Determine the number of elements that are treated simultaneously</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nElemSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160; </div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160; </div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  <span class="comment">/* Store the number of metric points per integration point, which depends</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment">     on the number of dimensions. */</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 1;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160; </div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;  <span class="comment">/*--- Loop over the given element range to compute the contribution of the</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">        volume integral in the DG FEM formulation to the residual. Multiple</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">        elements are treated simultaneously to improve the performance</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">        of the matrix multiplications. As a consequence, the update of the</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">        counter l happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd;) {</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160; </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="comment">/* Determine the end index for this chunk of elements and the padded</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160; </div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>, l, elemEnd, nElemSimul, nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160; </div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <span class="comment">/* Get the required data from the corresponding standard element. */</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt            = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs           = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matBasisInt         = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a51b506fa4dc4b72b40b32dd0c85590f9">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matDerBasisIntTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#acaed7911bdb18d3a9a0de508869d2670">GetDerMatBasisFunctionsIntTrans</a>();</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *matBasisIntTrans    = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#affb3cc64405ea150788c7c9739d8d6d5">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *weights             = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160; </div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFs       = workArray;</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sources       = solDOFs       + nDOFs*NPad;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solAndGradInt = sources       + nInt *NPad;</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxes        = solAndGradInt + nInt *NPad*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160; </div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    <span class="comment">/*--- Step 1: Determine the solution variables and their gradients     ---*/</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    <span class="comment">/*---         w.r.t. the parametric coordinates in the integration     ---*/</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="comment">/*---         points of the element.                                   ---*/</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160; </div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="comment">/* Copy the solution of the DOFs into solDOFs for this chunk of elements. */</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160; </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      <span class="comment">/* Easier storage of the solution variables for this element. */</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lInd = l + ll;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFsElem = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                                   + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160; </div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;          solDOFs[i*NPad+llNVar+mm] = solDOFsElem[i*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+mm];</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    }</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160; </div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product to determine</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="comment">       the solution and gradients in the integration points of the chunk</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;<span class="comment">       of elements. */</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1), NPad, nDOFs, matBasisInt, solDOFs, solAndGradInt, config);</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    <span class="comment">/*--- Step 2: Compute the total fluxes (inviscid fluxes minus the      ---*/</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="comment">/*---         viscous fluxes), multiplied by minus the integration     ---*/</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    <span class="comment">/*---         weight, in the integration points.                       ---*/</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160; </div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;    <span class="comment">/* Determine the offset between the solution variables and the r-derivatives,</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="comment">       which is also the offset between the r- and s-derivatives and the offset</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="comment">       between s- and t-derivatives. */</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160; </div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;    <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="comment">        in order to have the most efficient code. */</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160; </div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;      <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160; </div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        <span class="comment">/* 2D simulation. Loop over the chunk of elements and loop over the</span></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="comment">           integration points of the elements to compute the fluxes. */</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160; </div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160; </div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;            <span class="comment">/* Easier storage of the metric terms and grid velocities in this</span></div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment">               integration point and compute the inverse of the Jacobian. */</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                                         + i*nMetricPerPoint;</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel     = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Jac          = metricTerms[0];</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> JacInv       = 1.0/Jac;</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160; </div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;            <span class="comment">/* Compute the true metric terms in this integration point. */</span></div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160; </div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = JacInv*metricTerms[3];</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = JacInv*metricTerms[4];</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160; </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;            <span class="comment">/* Compute the metric terms multiplied by minus the integration weight.</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="comment">               The minus sign comes from the integration by parts in the weak</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;<span class="comment">               formulation. */</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdx = -weights[i]*metricTerms[1];</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdy = -weights[i]*metricTerms[2];</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160; </div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdx = -weights[i]*metricTerms[3];</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdy = -weights[i]*metricTerms[4];</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160; </div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            <span class="comment">/* Easier storage of the location where the solution data of this</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="comment">               integration point starts. */</span></div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol    = solAndGradInt + iNPad + llNVar;</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDr = sol    + offDeriv;</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDs = dSolDr + offDeriv;</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160; </div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;            <span class="comment">/*--- Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;<span class="comment">                  variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="comment">                  metric terms in this integration point. ---*/</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoDx  = dSolDr[0]*drdx + dSolDs[0]*dsdx;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoUDx = dSolDr[1]*drdx + dSolDs[1]*dsdx;</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoVDx = dSolDr[2]*drdx + dSolDs[2]*dsdx;</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoEDx = dSolDr[3]*drdx + dSolDs[3]*dsdx;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160; </div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoDy  = dSolDr[0]*drdy + dSolDs[0]*dsdy;</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoUDy = dSolDr[1]*drdy + dSolDs[1]*dsdy;</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoVDy = dSolDr[2]*drdy + dSolDs[2]*dsdy;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoEDy = dSolDr[3]*drdy + dSolDs[3]*dsdy;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160; </div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;            <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv       = 1.0/sol[0];</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = sol[1]*rhoInv;</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = sol[2]*rhoInv;</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = sol[3]*rhoInv;</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>);</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160; </div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;            <span class="comment">/*--- Compute the Cartesian gradients of the velocities and static energy</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;<span class="comment">                  in this integration point and also the divergence of the velocity. ---*/</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = rhoInv*(dRhoUDx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dRhoDx);</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = rhoInv*(dRhoUDy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dRhoDy);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160; </div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = rhoInv*(dRhoVDx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dRhoDx);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = rhoInv*(dRhoVDy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dRhoDy);</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160; </div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDx = rhoInv*(dRhoEDx - TotalEnergy*dRhoDx)</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;                                            - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDy = rhoInv*(dRhoEDy - TotalEnergy*dRhoDy)</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;                                            - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160; </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> divVel = dudx + dvdy;</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160; </div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;            <span class="comment">/*--- Compute the pressure and the laminar viscosity. ---*/</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;            <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Pressure     = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">GetPressure</a>();</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160; </div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;            <span class="comment">/*--- If an SGS model is used the eddy viscosity must be computed. ---*/</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;            <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;              ViscosityTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(sol[0], dudx, dudy,</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                                                                dvdx, dvdy, lenScale,</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                                                                <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].wallDistance[i]);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;            }</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160; </div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;            <span class="comment">/* Compute the total viscosity and heat conductivity. Note that the heat</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="comment">               conductivity is divided by the Cv, because gradients of internal energy</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<span class="comment">               are computed and not temperature. */</span></div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;                                    + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160; </div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;            <span class="comment">/*--- Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="comment">                  term in the viscous normal stresses. ---*/</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160; </div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;            <span class="comment">/*--- Compute the viscous stress tensor and minus the heatflux vector. ---*/</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160; </div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qx = kOverCv*dStaticEnergyDx;</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qy = kOverCv*dStaticEnergyDy;</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160; </div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;            <span class="comment">/* Compute the relative velocities w.r.t. the grid. */</span></div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> uRel = <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> - gridVel[0];</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vRel = <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> - gridVel[1];</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160; </div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;            <span class="comment">/* Compute the viscous normal stress minus the pressure. */</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxxMP = tauxx - Pressure;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyyMP = tauyy - Pressure;</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160; </div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;            <span class="comment">/* Set the pointer for the fluxes in this integration point. */</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *flux = fluxes + <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*iNPad + llNVar;</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160; </div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            <span class="comment">/*--- Fluxes in r-direction. */</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Ur = uRel*wDrdx + vRel*wDrdy;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160; </div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;            flux[0] = sol[0]*Ur;</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;            flux[1] = sol[1]*Ur - tauxxMP*wDrdx - tauxy*wDrdy;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;            flux[2] = sol[2]*Ur - tauxy*wDrdx - tauyyMP*wDrdy;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;            flux[3] = sol[3]*Ur - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxxMP + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy + qx)*wDrdx</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                                - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyyMP + qy)*wDrdy;</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160; </div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;            <span class="comment">/*--- Fluxes in s-direction. */</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Us = uRel*wDsdx + vRel*wDsdy;</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160; </div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;            flux[0] = sol[0]*Us;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;            flux[1] = sol[1]*Us - tauxxMP*wDsdx - tauxy*wDsdy;</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;            flux[2] = sol[2]*Us - tauxy*wDsdx - tauyyMP*wDsdy;</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;            flux[3] = sol[3]*Us - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxxMP + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy + qx)*wDsdx</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                                - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyyMP + qy)*wDsdy;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160; </div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            <span class="comment">/*--- If needed, compute the body forces in this integration point.</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="comment">                  Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;<span class="comment">                  integration weight in order to be consistent with the</span></div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;<span class="comment">                  formulation of the residual. Note that for the energy source</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;<span class="comment">                  term the absolute velocity must be taken and not the</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;<span class="comment">                  relative. ---*/</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;            <span class="keywordflow">if</span>( body_force ) {</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *source         = sources + iNPad + llNVar;</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160; </div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;              source[0] =  0.0;</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;              source[1] = -weightJac*body_force_vector[0];</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;              source[2] = -weightJac*body_force_vector[1];</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;              source[3] = -weightJac*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*body_force_vector[0] + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*body_force_vector[1]);</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            }</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;          }</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;        }</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160; </div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;      }</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160; </div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;      <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160; </div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;      <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160; </div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;        <span class="comment">/* 3D simulation. Loop over the chunk of elements and loop over the</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="comment">           integration points of the elements to compute the fluxes. */</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160; </div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160; </div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;            <span class="comment">/* Easier storage of the metric terms and grid velocities in this</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="comment">               integration point and compute the inverse of the Jacobian. */</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;                                         + i*nMetricPerPoint;</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel     = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Jac          = metricTerms[0];</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> JacInv       = 1.0/Jac;</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160; </div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;            <span class="comment">/* Compute the true metric terms in this integration point. */</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdz = JacInv*metricTerms[3];</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160; </div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = JacInv*metricTerms[4];</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = JacInv*metricTerms[5];</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdz = JacInv*metricTerms[6];</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160; </div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdx = JacInv*metricTerms[7];</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdy = JacInv*metricTerms[8];</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdz = JacInv*metricTerms[9];</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160; </div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;            <span class="comment">/* Compute the metric terms multiplied by minus the integration weight.</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;<span class="comment">               The minus sign comes from the integration by parts in the weak</span></div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;<span class="comment">               formulation. */</span></div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdx = -weights[i]*metricTerms[1];</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdy = -weights[i]*metricTerms[2];</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDrdz = -weights[i]*metricTerms[3];</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160; </div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdx = -weights[i]*metricTerms[4];</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdy = -weights[i]*metricTerms[5];</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDsdz = -weights[i]*metricTerms[6];</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160; </div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDtdx = -weights[i]*metricTerms[7];</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDtdy = -weights[i]*metricTerms[8];</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wDtdz = -weights[i]*metricTerms[9];</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160; </div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;            <span class="comment">/* Easier storage of the location where the solution data of this</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;<span class="comment">               integration point starts. */</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol    = solAndGradInt + iNPad + llNVar;</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDr = sol    + offDeriv;</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDs = dSolDr + offDeriv;</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDt = dSolDs + offDeriv;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160; </div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;            <span class="comment">/*--- Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="comment">                  variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment">                  metric terms in this integration point. ---*/</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoDx  = dSolDr[0]*drdx + dSolDs[0]*dsdx + dSolDt[0]*dtdx;</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoUDx = dSolDr[1]*drdx + dSolDs[1]*dsdx + dSolDt[1]*dtdx;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoVDx = dSolDr[2]*drdx + dSolDs[2]*dsdx + dSolDt[2]*dtdx;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoWDx = dSolDr[3]*drdx + dSolDs[3]*dsdx + dSolDt[3]*dtdx;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoEDx = dSolDr[4]*drdx + dSolDs[4]*dsdx + dSolDt[4]*dtdx;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160; </div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoDy  = dSolDr[0]*drdy + dSolDs[0]*dsdy + dSolDt[0]*dtdy;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoUDy = dSolDr[1]*drdy + dSolDs[1]*dsdy + dSolDt[1]*dtdy;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoVDy = dSolDr[2]*drdy + dSolDs[2]*dsdy + dSolDt[2]*dtdy;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoWDy = dSolDr[3]*drdy + dSolDs[3]*dsdy + dSolDt[3]*dtdy;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoEDy = dSolDr[4]*drdy + dSolDs[4]*dsdy + dSolDt[4]*dtdy;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160; </div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoDz  = dSolDr[0]*drdz + dSolDs[0]*dsdz + dSolDt[0]*dtdz;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoUDz = dSolDr[1]*drdz + dSolDs[1]*dsdz + dSolDt[1]*dtdz;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoVDz = dSolDr[2]*drdz + dSolDs[2]*dsdz + dSolDt[2]*dtdz;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoWDz = dSolDr[3]*drdz + dSolDs[3]*dsdz + dSolDt[3]*dtdz;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dRhoEDz = dSolDr[4]*drdz + dSolDs[4]*dsdz + dSolDt[4]*dtdz;</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160; </div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv       = 1.0/sol[0];</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>            = sol[1]*rhoInv;</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>            = sol[2]*rhoInv;</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> w            = sol[3]*rhoInv;</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = sol[4]*rhoInv;</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> + w*w);</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160; </div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;            <span class="comment">/*--- Compute the Cartesian gradients of the velocities and static energy</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="comment">                  in this integration point and also the divergence of the velocity. ---*/</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = rhoInv*(dRhoUDx - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dRhoDx);</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = rhoInv*(dRhoUDy - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dRhoDy);</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudz = rhoInv*(dRhoUDz - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dRhoDz);</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160; </div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = rhoInv*(dRhoVDx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dRhoDx);</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = rhoInv*(dRhoVDy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dRhoDy);</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdz = rhoInv*(dRhoVDz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dRhoDz);</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160; </div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdx = rhoInv*(dRhoWDx - w*dRhoDx);</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdy = rhoInv*(dRhoWDy - w*dRhoDy);</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdz = rhoInv*(dRhoWDz - w*dRhoDz);</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160; </div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDx = rhoInv*(dRhoEDx - TotalEnergy*dRhoDx)</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;                                            - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx - w*dwdx;</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDy = rhoInv*(dRhoEDy - TotalEnergy*dRhoDy)</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;                                            - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy - w*dwdy;</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDz = rhoInv*(dRhoEDz - TotalEnergy*dRhoDz)</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;                                            - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdz - w*dwdz;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160; </div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> divVel = dudx + dvdy + dwdz;</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160; </div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;            <span class="comment">/*--- Compute the pressure and the laminar viscosity. ---*/</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Pressure     = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">GetPressure</a>();</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160; </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;            <span class="comment">/*--- If an SGS model is used the eddy viscosity must be computed. ---*/</span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;            <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;              ViscosityTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(sol[0], dudx, dudy, dudz,</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;                                                                dvdx, dvdy, dvdz, dwdx,</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                                                                dwdy, dwdz, lenScale,</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;                                                                <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].wallDistance[i]);</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;            }</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160; </div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;            <span class="comment">/* Compute the total viscosity and heat conductivity. Note that the heat</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;<span class="comment">               conductivity is divided by the Cv, because gradients of internal energy</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="comment">               are computed and not temperature. */</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                                    + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160; </div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;            <span class="comment">/*--- Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="comment">                  term in the viscous normal stresses. ---*/</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160; </div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;            <span class="comment">/*--- Compute the viscous stress tensor and minus the heatflux vector. ---*/</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauzz = 2.0*Viscosity*dwdz + lamDivTerm;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160; </div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxz = Viscosity*(dudz + dwdx);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyz = Viscosity*(dvdz + dwdy);</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160; </div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qx = kOverCv*dStaticEnergyDx;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qy = kOverCv*dStaticEnergyDy;</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qz = kOverCv*dStaticEnergyDz;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160; </div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            <span class="comment">/* Compute the relative velocities w.r.t. the grid. */</span></div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> uRel = <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> - gridVel[0];</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vRel = <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> - gridVel[1];</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wRel = w - gridVel[2];</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160; </div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;            <span class="comment">/* Compute the viscous normal stress minus the pressure. */</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxxMP = tauxx - Pressure;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyyMP = tauyy - Pressure;</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauzzMP = tauzz - Pressure;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160; </div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;            <span class="comment">/* Set the pointer for the fluxes in this integration point. */</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *flux = fluxes + <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*iNPad + llNVar;</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160; </div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;            <span class="comment">/*--- Fluxes in r-direction. */</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Ur = uRel*wDrdx + vRel*wDrdy + wRel*wDrdz;</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160; </div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;            flux[0] = sol[0]*Ur;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            flux[1] = sol[1]*Ur - tauxxMP*wDrdx - tauxy*wDrdy - tauxz*wDrdz;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;            flux[2] = sol[2]*Ur - tauxy*wDrdx - tauyyMP*wDrdy - tauyz*wDrdz;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;            flux[3] = sol[3]*Ur - tauxz*wDrdx - tauyz*wDrdy - tauzzMP*wDrdz;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;            flux[4] = sol[4]*Ur - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxxMP + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy + w*tauxz + qx)*wDrdx</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;                                - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyyMP + w*tauyz + qy)*wDrdy</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;                                - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxz + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyz + w*tauzzMP + qz)*wDrdz;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160; </div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;            <span class="comment">/*--- Fluxes in s-direction. */</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Us = uRel*wDsdx + vRel*wDsdy + wRel*wDsdz;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160; </div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;            flux[0] = sol[0]*Us;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;            flux[1] = sol[1]*Us - tauxxMP*wDsdx - tauxy*wDsdy - tauxz*wDsdz;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;            flux[2] = sol[2]*Us - tauxy*wDsdx - tauyyMP*wDsdy - tauyz*wDsdz;</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;            flux[3] = sol[3]*Us - tauxz*wDsdx - tauyz*wDsdy - tauzzMP*wDsdz;</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;            flux[4] = sol[4]*Us - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxxMP + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy + w*tauxz + qx)*wDsdx</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                                - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyyMP + w*tauyz + qy)*wDsdy</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;                                - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxz + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyz + w*tauzzMP + qz)*wDsdz;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160; </div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;            <span class="comment">/*--- Fluxes in t-direction. */</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Ut = uRel*wDtdx + vRel*wDtdy + wRel*wDtdz;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160; </div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;            flux[0] = sol[0]*Ut;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            flux[1] = sol[1]*Ut - tauxxMP*wDtdx - tauxy*wDtdy - tauxz*wDtdz;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            flux[2] = sol[2]*Ut - tauxy*wDtdx - tauyyMP*wDtdy - tauyz*wDtdz;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            flux[3] = sol[3]*Ut - tauxz*wDtdx - tauyz*wDtdy - tauzzMP*wDtdz;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;            flux[4] = sol[4]*Ut - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxxMP + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy + w*tauxz + qx)*wDtdx</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                                - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyyMP + w*tauyz + qy)*wDtdy</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                                - (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxz + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyz + w*tauzzMP + qz)*wDtdz;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160; </div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;            <span class="comment">/*--- If needed, compute the body forces in this integration point.</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;<span class="comment">                  Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;<span class="comment">                  integration weight in order to be consistent with the</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;<span class="comment">                  formulation of the residual. Note that for the energy source</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;<span class="comment">                  term the absolute velocity must be taken and not the</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;<span class="comment">                  relative. ---*/</span></div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;            <span class="keywordflow">if</span>( body_force ) {</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *source         = sources + iNPad + llNVar;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160; </div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;              source[0] =  0.0;</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;              source[1] = -weightJac*body_force_vector[0];</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;              source[2] = -weightJac*body_force_vector[1];</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;              source[3] = -weightJac*body_force_vector[2];</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;              source[4] = -weightJac*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*body_force_vector[0] + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*body_force_vector[1]</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;                        +             w*body_force_vector[2]);</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;            }</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;          }</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;        }</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160; </div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      }</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    }</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160; </div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;    <span class="comment">/* Initialize addSourceTerms to body_force. The value of addSourceTerms</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;<span class="comment">       is set to true when a manufactured solution is computed. */</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    <span class="keywordtype">bool</span> addSourceTerms = body_force;</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160; </div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;    <span class="comment">/* Check whether or not a manufactured solution is used. */</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a> ) {</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#ad236e991301c3037e45206d939deb668">IsManufacturedSolution</a>() ) {</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160; </div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;        <span class="comment">/*--- For the manufactured solutions a source term must be added. If a</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="comment">              standard source term has not been specified, initialize the source</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<span class="comment">              terms to zero and set addSourceTerms to true. ---*/</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;        addSourceTerms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        <span class="keywordflow">if</span>( !body_force ) {</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(nInt*NPad); ++i)</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;            sources[i] = 0.0;</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;        }</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160; </div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;        <span class="comment">/*--- Loop over the chunk of elements and its integration points. ---*/</span></div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160; </div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;            <span class="comment">/* Determine the integration weight multiplied by the Jacobian. */</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                                         + i*nMetricPerPoint;</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> weightJac    = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160; </div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;            <span class="comment">/* Set the pointer to the coordinates in this integration point and</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;<span class="comment">               call the function to compute the source terms for the manufactured</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="comment">               solution. */</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *coor = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a51a6fc4be49459ff00b9391ba87291cd">coorIntegrationPoints</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160; </div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> sourceMan[5];</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160; </div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;            <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#acb2e19001e55c60e498be21ff5c8a085">GetMMSSourceTerm</a>(coor, time, sourceMan);</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160; </div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;            <span class="comment">/*--- Subtract the source term of the manufactured solution, multiplied</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;<span class="comment">                  by the appropriate weight, from the possibly earlier computed</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;<span class="comment">                  source term. It is subtracted in order to be consistent with</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;<span class="comment">                  the definition of the residual used in this code. ---*/</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *source = sources + iNPad + llNVar;</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k)</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;              source[k] -= weightJac*sourceMan[k];</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;          }</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;        }</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;      }</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    }</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160; </div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;    <span class="comment">/*--- Step 3: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    <span class="comment">/*---         integration over the volume element.                     ---*/</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160; </div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product.</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;<span class="comment">       Use solDOFs as a temporary storage for the matrix product. */</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs, NPad, nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, matDerBasisIntTrans, fluxes, solDOFs, config);</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160; </div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    <span class="comment">/* Add the contribution from the source terms, if needed. Use solAndGradInt</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;<span class="comment">       as temporary storage for the matrix product. */</span></div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    <span class="keywordflow">if</span>( addSourceTerms ) {</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160; </div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;      <span class="comment">/* Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs, NPad, nInt, matBasisIntTrans, sources, solAndGradInt, config);</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160; </div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      <span class="comment">/* Add the residuals due to source terms to the volume residuals */</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(nDOFs*NPad); ++i)</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;        solDOFs[i] += solAndGradInt[i];</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    }</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160; </div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    <span class="comment">/* Loop over the elements in this chunk to store the residuals</span></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;<span class="comment">       in the appropriate locations. */</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160; </div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;      <span class="comment">/* Easier storage of the residuals for this volume element. */</span></div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *res = <a class="code" href="classCFEM__DG__EulerSolver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data() + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160; </div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;           res[i*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+mm] = solDOFs[i*NPad+llNVar+mm];</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    }</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160; </div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;  }</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;}</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160; </div>
<div class="line"><a name="l03723"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a407d8b7c0f6944c2f08ee7fb9b28aa0c"> 3723</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a407d8b7c0f6944c2f08ee7fb9b28aa0c">CFEM_DG_NSSolver::ResidualFaces</a>(<a class="code" href="classCConfig.html">CConfig</a>             *config,</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indFaceBeg,</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indFaceEnd,</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;                                     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>       &amp;indResFaces,</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;                                     <a class="code" href="classCNumerics.html">CNumerics</a>           *numerics,</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                                     <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>           *workArray) {</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160; </div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160; </div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160; </div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;  <span class="comment">/*--- Loop over the requested range of matching faces. Multiple faces</span></div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=indFaceBeg; l&lt;indFaceEnd;) {</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160; </div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160; </div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(<a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>, l, indFaceEnd, nFaceSimul,</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160; </div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *weights  = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160; </div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace0 = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#acd4208ae47226c5917479d6a232b7584">GetNDOFsFaceSide0</a>();</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace1 = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#a0e3ff97b8c11ca92ede562565eec7041">GetNDOFsFaceSide1</a>();</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160; </div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem0  = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#a0719e8b18410e4720f58449ac28e8c38">GetNDOFsElemSide0</a>();</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem1  = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#a043294eff88a9374a936fefaca0ea860">GetNDOFsElemSide1</a>();</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160; </div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeFluxes = nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;    sizeFluxes = NPad*max(sizeFluxes, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) max(nDOFsElem0, nDOFsElem1));</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160; </div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeGradSolInt = nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad;</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160; </div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL       = workArray;</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR       = solIntL       + NPad*max(nInt, nDOFsElem0);</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscosityIntL = solIntR       + NPad*max(nInt, nDOFsElem1);</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *kOverCvIntL   = viscosityIntL + llEnd*nInt;</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscosityIntR = kOverCvIntL   + llEnd*nInt;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *kOverCvIntR   = viscosityIntR + llEnd*nInt;</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradSolInt    = kOverCvIntR   + llEnd*nInt;</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxes        = gradSolInt    + sizeGradSolInt;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscFluxes    = fluxes        + sizeFluxes;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160; </div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    <span class="comment">/*--- Step 1: Compute the inviscid fluxes in the integration points of ---*/</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;    <span class="comment">/*---         this chunk of matching faces.                            ---*/</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160; </div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ab7546cb31b73191bbac2b338c88cfbc4">InviscidFluxesInternalMatchingFace</a>(config, l, lEnd, NPad,</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;                                       solIntL, solIntR, fluxes, numerics);</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160; </div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;    <span class="comment">/*--- Step 2: Compute the viscous fluxes in the integration points of  ---*/</span></div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;    <span class="comment">/*---         this chunk of matching faces and subtract them from the  ---*/</span></div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;    <span class="comment">/*---         already computed inviscid fluxes.                        ---*/</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160; </div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;    <span class="comment">/*---------------------------*/</span></div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;    <span class="comment">/*--- Side 0 of the face. ---*/</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    <span class="comment">/*---------------------------*/</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160; </div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    <span class="comment">/* Get the matrix, which contains the derivatives w.r.t. the</span></div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;<span class="comment">       parametric coordinates of the basis functions. */</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *derBasisElem = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#a657e76ad82d82dbf95b2939d36f15c04">GetMatDerBasisElemIntegrationSide0</a>();</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160; </div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;    <span class="comment">/* Set the pointer solElem to viscFluxes. This is just for readability,</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;<span class="comment">       as the same memory can be used for the storage of the solution of the</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="comment">       DOFs of the element and the viscous fluxes to be computed. */</span></div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solElem = viscFluxes;</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160; </div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to set the conserved variables</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="comment">          in the DOFs of the faces. */</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel  = ll - l;</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = llRel*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160; </div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;      <span class="comment">/* Determine the time level of the face, which is the minimum</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<span class="comment">         of the levels of the adjacent elements. */</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID0 = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID1 = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevelFace = min(<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].timeLevel,</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;                                               <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].timeLevel);</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160; </div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;      <span class="comment">/* Determine the offset that must be applied to access the correct data</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;<span class="comment">         for this elemID0 in the working vector of the solution. If the element</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="comment">         has the same time level as the face offsetDOFsSolThisTimeLevel is used,</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;<span class="comment">         otherwise offsetDOFsSolPrevTimeLevel is the correct value. */</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset;</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].timeLevel == timeLevelFace) {</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;        offset = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;               - <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      }</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;        offset = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;               - <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="classCVolumeElementFEM.html#aca2a1ae12ad274b8c2494ffb69bd73f1">offsetDOFsSolPrevTimeLevel</a>;</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      }</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160; </div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      <span class="comment">/*--- Store the solution of the DOFs of the elemID0 in the correct</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="comment">            sequence, such that a generalized approach is possible. ---*/</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFsElem = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#aaf7209a1e287371117f9e525f6aae3e6">DOFsSolElementSide0</a>.data();</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem0; ++i) {</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevelFace].data()</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;                                + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFsElem[i] - offset);</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *sol    = solElem + NPad*i + llNVar;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;          sol[mm] = solDOF[mm];</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      }</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;    }</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160; </div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;    <span class="comment">/* Compute the gradients w.r.t. the parametric coordinates in the integration</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;<span class="comment">       points. Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem0, derBasisElem, solElem, gradSolInt, config);</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160; </div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to compute the viscous flux</span></div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;<span class="comment">          vector for side 0. */</span></div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160; </div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      <span class="comment">/* Determine the ID of the adjacent element. */</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID0 = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160; </div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <span class="comment">/* Call the general function to compute the viscous flux in normal</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;<span class="comment">         direction for side 0. */</span></div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      ViscousNormalFluxFace(&amp;<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0], llRel, nInt, NPad,</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;                            0.0, <span class="keyword">false</span>, solIntL, gradSolInt,</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;                            <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricCoorDerivFace0.data(),</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                            <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#ad986a0eec8bc2e27e76046f64cec1046">metricNormalsFace</a>.data(),</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                            <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#afec7875eae117cffa907fa22b0dfd2b7">wallDistance</a>.data(),</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;                            viscFluxes, viscosityIntL, kOverCvIntL);</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;    }</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160; </div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;    <span class="comment">/*--- Subtract half of the viscous fluxes from the inviscid fluxes. The</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;<span class="comment">          factor 0.5 comes from the fact that the average of the viscous fluxes</span></div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="comment">          of side 0 and side 1 must be taken in the DG-FEM formulation. ---*/</span></div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] -= 0.5*viscFluxes[j];</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160; </div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <span class="comment">/*---------------------------*/</span></div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    <span class="comment">/*--- Side 1 of the face. ---*/</span></div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    <span class="comment">/*---------------------------*/</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160; </div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;    <span class="comment">/* Get the matrix, which contains the derivatives w.r.t. the</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;<span class="comment">       parametric coordinates of the basis functions. */</span></div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    derBasisElem = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#a024d56c5e3414c6bd22b278cea961ed8">GetMatDerBasisElemIntegrationSide1</a>();</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160; </div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to set the conserved variables</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="comment">          in the DOFs of the faces. */</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel  = ll - l;</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = llRel*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160; </div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;      <span class="comment">/* Determine the time level of the face, which is the minimum</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;<span class="comment">         of the levels of the adjacent elements. */</span></div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID0 = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID1 = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevelFace = min(<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].timeLevel,</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;                                               <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].timeLevel);</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160; </div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <span class="comment">/* Determine the offset that must be applied to access the correct data</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;<span class="comment">         for this elemID0 in the working vector of the solution. If the element</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;<span class="comment">         has the same time level as the face offsetDOFsSolThisTimeLevel is used,</span></div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;<span class="comment">         otherwise offsetDOFsSolPrevTimeLevel is the correct value. */</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset;</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].timeLevel == timeLevelFace) {</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;        offset = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;               - <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      }</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;        offset = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;               - <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="classCVolumeElementFEM.html#aca2a1ae12ad274b8c2494ffb69bd73f1">offsetDOFsSolPrevTimeLevel</a>;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;      }</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160; </div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;      <span class="comment">/*--- Store the solution of the DOFs of the elemID1 in the correct</span></div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;<span class="comment">            sequence, such that a generalized approach is possible. ---*/</span></div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFsElem = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#ab6c86e670d9d1ae338a04795a5638b1f">DOFsSolElementSide1</a>.data();</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem1; ++i) {</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevelFace].data()</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;                                + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFsElem[i] - offset);</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *sol    = solElem + NPad*i + llNVar;</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;          sol[mm] = solDOF[mm];</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;      }</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;    }</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160; </div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;    <span class="comment">/* Compute the gradients w.r.t. the parametric coordinates in the integration</span></div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;<span class="comment">       points. Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem1, derBasisElem, solElem, gradSolInt, config);</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160; </div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to compute the viscous flux</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;<span class="comment">          vector for side 1. */</span></div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160; </div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;      <span class="comment">/* Determine the ID of the adjacent element. */</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID1 = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160; </div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;      <span class="comment">/* Call the general function to compute the viscous flux in normal</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;<span class="comment">         direction for side 1. */</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;      ViscousNormalFluxFace(&amp;<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1], llRel, nInt, NPad,</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                            0.0, <span class="keyword">false</span>, solIntR, gradSolInt,</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                            <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricCoorDerivFace1.data(),</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                            <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#ad986a0eec8bc2e27e76046f64cec1046">metricNormalsFace</a>.data(),</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                            <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#afec7875eae117cffa907fa22b0dfd2b7">wallDistance</a>.data(),</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                            viscFluxes, viscosityIntR, kOverCvIntR);</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    }</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160; </div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    <span class="comment">/*--- Subtract half of the viscous fluxes from the inviscid fluxes. ---*/</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] -= 0.5*viscFluxes[j];</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160; </div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    <span class="comment">/*--- Step 3: Compute the penalty terms in the integration points of   ---*/</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;    <span class="comment">/*---         this chunk of matching faces and add them to the already ---*/</span></div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    <span class="comment">/*---         stored inviscid and viscous fluxes.                      ---*/</span></div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160; </div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;    <span class="comment">/* Get the required constant needed for the penalty terms. */</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ConstPenFace = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#ab40a08956d8e1bd5a19c7e166b63d3ee">GetPenaltyConstant</a>();</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160; </div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to compute the penalty fluxes. ---*/</span></div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160; </div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      <span class="comment">/* Get the length scales of the adjacent elements. */</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID0 = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID1 = <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="structCInternalFaceElementFEM.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160; </div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale0 = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale1 = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160; </div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      <span class="comment">/* Call the function PenaltyTermsFluxFace to compute the actual penalty</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="comment">         terms. Use the array viscFluxes as storage. */</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;      PenaltyTermsFluxFace(llRel, nInt, NPad, solIntL, solIntR, viscosityIntL,</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                           viscosityIntR, kOverCvIntL, kOverCvIntR,</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                           ConstPenFace, lenScale0, lenScale1,</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;                           <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricNormalsFace.data(),</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;                           viscFluxes);</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    }</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160; </div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;    <span class="comment">/* Add the penalty fluxes to the earlier computed fluxes. */</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] += viscFluxes[j];</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160; </div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    <span class="comment">/* Multiply the fluxes with the integration weight of the corresponding</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;<span class="comment">       integration point. */</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *flux = fluxes + i*NPad;</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160; </div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;NPad; ++j)</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;        flux[j] *= weights[i];</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    }</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160; </div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    <span class="comment">/*--- Step 4: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    <span class="comment">/*---         integration over this internal matching face.            ---*/</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160; </div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    <span class="comment">/* Set the value of the offset of the residual between each of the fused</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="comment">       faces. This depends whether or not symmetrizing terms are stored.</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;<span class="comment">       Also set the location where the symmetrizing terms of the first face</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;<span class="comment">       must be stored. */</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offsetRes = nDOFsFace0 + nDOFsFace1;</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCFEM__DG__EulerSolver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) offsetRes += nDOFsElem0 + nDOFsElem1;</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160; </div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResSym = indResFaces + nDOFsFace0 + nDOFsFace1;</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160; </div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <span class="comment">/* Get the correct form of the basis functions needed for the matrix</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="comment">       multiplication to compute the residual. Use gradSolInt as a temporary</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="comment">       buffer to store this product. */</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *basisFaceTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#acb4d942925e07bfc13a241aa0ec34c4a">GetBasisFaceIntegrationTransposeSide0</a>();</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *resSide0 = gradSolInt;</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160; </div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFsFace0, NPad, nInt, basisFaceTrans, fluxes, resSide0, config);</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160; </div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;    <span class="comment">/* Check if the number of DOFs on both sides of the face is different.</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="comment">       In that case also the matrix product with the basis functions on side 1</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="comment">       must be carried out. Use viscFluxes as a temporary buffer to store</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;<span class="comment">       this product. */</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *resSide1 = viscFluxes;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    <span class="keywordflow">if</span>(nDOFsFace1 != nDOFsFace0) {</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      basisFaceTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#a0d2d6958c0259607615f6715754eede8">GetBasisFaceIntegrationTransposeSide1</a>();</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFsFace1, NPad, nInt, basisFaceTrans, fluxes, resSide1, config);</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;    }</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160; </div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;    <span class="comment">/* Loop over the number of faces in this chunk. */</span></div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160; </div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      <span class="comment">/* Set the pointer in the residual array where the residual of side 0</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="comment">         and side 1 of this face must be stored. Update the counter. */</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *resFace0 = <a class="code" href="classCFEM__DG__EulerSolver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + indResFaces*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *resFace1 = <a class="code" href="classCFEM__DG__EulerSolver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + (indResFaces+nDOFsFace0)*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;      indResFaces        += offsetRes;</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160; </div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data for side 0. */</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace0; ++i)</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;          resFace0[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i+mm] = resSide0[NPad*i+llNVar+mm];</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160; </div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;      <span class="comment">/* If the number of DOFs on both sides is the same, then the residual</span></div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;<span class="comment">         of side 1 is obtained by simply negating the residual of side 0.</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;<span class="comment">         Otherwise a copy must be carried out and the residual negated,</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;<span class="comment">         because the normal is pointing into the adjacent element for side 1. */</span></div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;      <span class="keywordflow">if</span>(nDOFsFace1 == nDOFsFace0) {</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*nDOFsFace1); ++i)</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;          resFace1[i] = -resFace0[i];</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      }</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace1; ++i)</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;            resFace1[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i+mm] = -resSide1[NPad*i+llNVar+mm];</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;      }</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    }</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160; </div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;    <span class="comment">/*--- Step 5: Compute and distribute the symmetrizing terms, if        ---*/</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    <span class="comment">/*---         present. Note that these terms must be distributed to    ---*/</span></div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="comment">/*---         DOFs of the adjacent element, not only of the face.      ---*/</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160; </div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCFEM__DG__EulerSolver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) {</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160; </div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;      <span class="comment">/* Use gradSolInt as a buffer to store the parametric fluxes. */</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *paramFluxes = gradSolInt;</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160; </div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;      <span class="comment">/* The symmetrizing fluxes will be multiplied by 0.5 times the theta</span></div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;<span class="comment">         parameter. Store this factor a bit easier. */</span></div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> halfTheta = 0.5*config-&gt;<a class="code" href="classCConfig.html#a1c1aa8ce41b9bfffea9cbf502ad08188">GetTheta_Interior_Penalty_DGFEM</a>();</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160; </div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;      <span class="comment">/* Loop over the faces in this chunk to compute the symmetrizing fluxes. */</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160; </div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <span class="comment">/* Compute the symmetrizing fluxes in the nDim directions in the</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;<span class="comment">           integration points of the face. */</span></div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;        SymmetrizingFluxesFace(llRel, nInt, NPad, solIntL, solIntR, viscosityIntL,</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;                               viscosityIntR, kOverCvIntL, kOverCvIntR,</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;                               <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricNormalsFace.data(),</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                               fluxes);</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160; </div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;        <span class="comment">/* Transform the fluxes, such that they must be multiplied with the</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;<span class="comment">           gradients w.r.t. the parametric coordinates rather than the</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;<span class="comment">           Cartesian coordinates of the basis functions. Also a multiplication</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;<span class="comment">           with the integration weight and the theta parameter is carried out.</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;<span class="comment">           In this loop only side 0 of the face is treated. */</span></div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;        TransformSymmetrizingFluxes(llRel, nInt, NPad, halfTheta, fluxes, weights,</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                                    <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricCoorDerivFace0.data(),</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                                    paramFluxes);</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;      }</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160; </div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;      <span class="comment">/* Call the general function to carry out the matrix product to compute</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;<span class="comment">         the residual for side 0. Use solIntL as storage for the residual. */</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *derBasisElemTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#a0e31bf5a95fe57e837c1cbcf30e0ccb4">GetMatDerBasisElemIntegrationTransposeSide0</a>();</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFsElem0, NPad, nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, derBasisElemTrans, paramFluxes, solIntL, config);</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160; </div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;      <span class="comment">/* Loop over the faces in this chunk to compute the transformed</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="comment">         symmetrizing fluxes for side 1. */</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;        TransformSymmetrizingFluxes(llRel, nInt, NPad, halfTheta, fluxes, weights,</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;                                    <a class="code" href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricCoorDerivFace1.data(),</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                                    paramFluxes);</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;      }</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160; </div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;      <span class="comment">/* Call the general function to carry out the matrix product to compute</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;<span class="comment">         the residual for side 1. Note that the symmetrizing residual should not</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="comment">         be negated, because two minus signs enter the formulation for side 1,</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="comment">         which cancel each other. Use solIntR as storage for the residual. */</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;      derBasisElemTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="classCFEMStandardInternalFace.html#a7a774000d08e4a5bdaae5ff73053911a">GetMatDerBasisElemIntegrationTransposeSide1</a>();</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFsElem1, NPad, nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, derBasisElemTrans, paramFluxes, solIntR, config);</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160; </div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;      <span class="comment">/* Loop over the number of faces in this chunk. */</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160; </div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;        <span class="comment">/* Set the pointer in the residual array where the residual of side 0</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="comment">           and side 1 of this face must be stored. Update the counter. */</span></div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *resElem0 = <a class="code" href="classCFEM__DG__EulerSolver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + indResSym*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *resElem1 = <a class="code" href="classCFEM__DG__EulerSolver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + (indResSym+nDOFsElem0)*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;        indResSym          += offsetRes;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160; </div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;        <span class="comment">/* Loop over the DOFs of the element and copy the data for side 0. */</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem0; ++i)</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;            resElem0[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i+mm] = solIntL[NPad*i+llNVar+mm];</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160; </div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;        <span class="comment">/* Loop over the DOFs of the element and copy the data for side 1. */</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem1; ++i)</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;            resElem1[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i+mm] = solIntR[NPad*i+llNVar+mm];</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;      }</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    }</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160; </div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;  }</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;}</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160; </div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ViscousNormalFluxFace(<span class="keyword">const</span> <a class="code" href="classCVolumeElementFEM.html">CVolumeElementFEM</a> *adjVolElem,</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>    indFaceChunk,</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>    nInt,</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>    NPad,</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         Wall_HeatFlux,</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">bool</span>              HeatFlux_Prescribed,</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         *solInt,</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         *gradSolInt,</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         *metricCoorDerivFace,</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         *metricNormalsFace,</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         *wallDistanceInt,</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;                                                   <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         *viscNormFluxes,</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;                                                   <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         *viscosityInt,</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;                                                   <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>         *kOverCvInt) {</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160; </div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;  <span class="comment">/* Multiplication factor for the heat flux. It is set to zero if the wall heat flux</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<span class="comment">     is prescribed, such that the computed heat flux is zero, and to one otherwise. */</span></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux = HeatFlux_Prescribed ? <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>(0.0): <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>(1.0);</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160; </div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;  <span class="comment">/* Set the value of the prescribed heat flux for the same reason. */</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> HeatFlux = HeatFlux_Prescribed ? Wall_HeatFlux : <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>(0.0);</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160; </div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;  <span class="comment">/* Compute the length scale for the LES of the adjacent element. */</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iind  = adjVolElem-&gt;<a class="code" href="classCVolumeElementFEM.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>       nPoly = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[iind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160; </div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale_LES = adjVolElem-&gt;<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160; </div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;  <span class="comment">/* Determine the offset between r- and -s-derivatives, which is also the</span></div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="comment">     offset between s- and t-derivatives. */</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160; </div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;  <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="comment">     in order to have the most efficient code. */</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;  <span class="keywordflow">switch</span>( <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160; </div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160; </div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;      <span class="comment">/* 2D simulation. Loop over the integration points to</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="comment">         compute the viscous fluxes. */</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160; </div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;        <span class="comment">/* Easier storage of the metric terms needed to compute the Cartesian</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;<span class="comment">           gradients in this integration point and the starting locations of</span></div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;<span class="comment">           the solution and the gradients, w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;<span class="comment">           of this solution. */</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = metricCoorDerivFace + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol         = solInt     + offPointer;</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDr      = gradSolInt + offPointer;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDs      = dSolDr     + offDeriv;</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160; </div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point. */</span></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160; </div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = metricTerms[2];</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = metricTerms[3];</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160; </div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;        <span class="comment">/*--- Compute the Cartesian gradients of the solution. ---*/</span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> solGradCart[4][2];</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160; </div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;        solGradCart[0][0] = dSolDr[0]*drdx + dSolDs[0]*dsdx;</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;        solGradCart[1][0] = dSolDr[1]*drdx + dSolDs[1]*dsdx;</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;        solGradCart[2][0] = dSolDr[2]*drdx + dSolDs[2]*dsdx;</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;        solGradCart[3][0] = dSolDr[3]*drdx + dSolDs[3]*dsdx;</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160; </div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;        solGradCart[0][1] = dSolDr[0]*drdy + dSolDs[0]*dsdy;</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;        solGradCart[1][1] = dSolDr[1]*drdy + dSolDs[1]*dsdy;</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;        solGradCart[2][1] = dSolDr[2]*drdy + dSolDs[2]*dsdy;</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;        solGradCart[3][1] = dSolDr[3]*drdy + dSolDs[3]*dsdy;</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160; </div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        <span class="comment">/*--- Call the function ViscousNormalFluxIntegrationPoint to compute the</span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;<span class="comment">              actual normal viscous flux. The viscosity and thermal conductivity</span></div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;<span class="comment">              are stored for later use. ---*/</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normal  = metricNormalsFace + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normalFlux    = viscNormFluxes + offPointer;</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wallDist = wallDistanceInt ? wallDistanceInt[i] : 0.0;</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160; </div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity, kOverCv;</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160; </div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;        ViscousNormalFluxIntegrationPoint_2D(sol, solGradCart, normal, HeatFlux,</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                                             factHeatFlux, wallDist, lenScale_LES,</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                                             Viscosity, kOverCv, normalFlux);</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160; </div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;        viscosityInt[ind] = Viscosity;</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;        kOverCvInt[ind]   = kOverCv;</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;      }</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160; </div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    }</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160; </div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160; </div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160; </div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      <span class="comment">/* 3D simulation. Loop over the integration points to</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;<span class="comment">         compute the viscous fluxes. */</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160; </div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        <span class="comment">/* Easier storage of the metric terms needed to compute the Cartesian</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;<span class="comment">           gradients in this integration point and the starting locations of</span></div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;<span class="comment">           the solution and the gradients, w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;<span class="comment">           of this solution. */</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = metricCoorDerivFace + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol         = solInt     + offPointer;</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDr      = gradSolInt + offPointer;</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDs      = dSolDr     + offDeriv;</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dSolDt      = dSolDs     + offDeriv;</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160; </div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point. */</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdz = metricTerms[2];</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160; </div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = metricTerms[3];</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = metricTerms[4];</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdz = metricTerms[5];</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160; </div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdx = metricTerms[6];</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdy = metricTerms[7];</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdz = metricTerms[8];</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160; </div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        <span class="comment">/*--- Compute the Cartesian gradients of the solution. ---*/</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> solGradCart[5][3];</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160; </div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;        solGradCart[0][0] = dSolDr[0]*drdx + dSolDs[0]*dsdx + dSolDt[0]*dtdx;</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;        solGradCart[1][0] = dSolDr[1]*drdx + dSolDs[1]*dsdx + dSolDt[1]*dtdx;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        solGradCart[2][0] = dSolDr[2]*drdx + dSolDs[2]*dsdx + dSolDt[2]*dtdx;</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;        solGradCart[3][0] = dSolDr[3]*drdx + dSolDs[3]*dsdx + dSolDt[3]*dtdx;</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;        solGradCart[4][0] = dSolDr[4]*drdx + dSolDs[4]*dsdx + dSolDt[4]*dtdx;</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160; </div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;        solGradCart[0][1] = dSolDr[0]*drdy + dSolDs[0]*dsdy + dSolDt[0]*dtdy;</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;        solGradCart[1][1] = dSolDr[1]*drdy + dSolDs[1]*dsdy + dSolDt[1]*dtdy;</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;        solGradCart[2][1] = dSolDr[2]*drdy + dSolDs[2]*dsdy + dSolDt[2]*dtdy;</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;        solGradCart[3][1] = dSolDr[3]*drdy + dSolDs[3]*dsdy + dSolDt[3]*dtdy;</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;        solGradCart[4][1] = dSolDr[4]*drdy + dSolDs[4]*dsdy + dSolDt[4]*dtdy;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160; </div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;        solGradCart[0][2] = dSolDr[0]*drdz + dSolDs[0]*dsdz + dSolDt[0]*dtdz;</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;        solGradCart[1][2] = dSolDr[1]*drdz + dSolDs[1]*dsdz + dSolDt[1]*dtdz;</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;        solGradCart[2][2] = dSolDr[2]*drdz + dSolDs[2]*dsdz + dSolDt[2]*dtdz;</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;        solGradCart[3][2] = dSolDr[3]*drdz + dSolDs[3]*dsdz + dSolDt[3]*dtdz;</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;        solGradCart[4][2] = dSolDr[4]*drdz + dSolDs[4]*dsdz + dSolDt[4]*dtdz;</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160; </div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;        <span class="comment">/*--- Call the function ViscousNormalFluxIntegrationPoint to compute the</span></div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;<span class="comment">              actual normal viscous flux. The viscosity and thermal conductivity</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="comment">              are stored for later use. ---*/</span></div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normal  = metricNormalsFace + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normalFlux    = viscNormFluxes + offPointer;</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wallDist = wallDistanceInt ? wallDistanceInt[i] : 0.0;</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160; </div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity, kOverCv;</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160; </div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;        ViscousNormalFluxIntegrationPoint_3D(sol, solGradCart, normal, HeatFlux,</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                                             factHeatFlux, wallDist, lenScale_LES,</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;                                             Viscosity, kOverCv, normalFlux);</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160; </div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;        viscosityInt[ind] = Viscosity;</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;        kOverCvInt[ind]   = kOverCv;</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      }</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160; </div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    }</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  }</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;}</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160; </div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ViscousNormalFluxIntegrationPoint_2D(<span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol,</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> solGradCart[4][2],</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normal,</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> HeatFlux,</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux,</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wallDist,</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale_LES,</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                                                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> &amp;Viscosity,</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;                                                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> &amp;kOverCv,</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                                                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normalFlux) {</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160; </div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, namely the ratio of</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;<span class="comment">     thermal conductivity and viscosity. */</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam  = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Turb = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160; </div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;  <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv = 1.0/sol[0];</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> = rhoInv*sol[1];</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> = rhoInv*sol[2];</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160; </div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = rhoInv*sol[3];</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>);</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160; </div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;  <span class="comment">/*--- Compute the Cartesian gradients of the velocities and static energy</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;<span class="comment">        in this integration point and also the divergence of the velocity. ---*/</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = rhoInv*(solGradCart[1][0] - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*solGradCart[0][0]);</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = rhoInv*(solGradCart[1][1] - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*solGradCart[0][1]);</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160; </div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = rhoInv*(solGradCart[2][0] - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*solGradCart[0][0]);</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = rhoInv*(solGradCart[2][1] - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*solGradCart[0][1]);</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160; </div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDx = rhoInv*(solGradCart[3][0]</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;                                  -         TotalEnergy*solGradCart[0][0])</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;                                  - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx;</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDy = rhoInv*(solGradCart[3][1]</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;                                  -         TotalEnergy*solGradCart[0][1])</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;                                  - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160; </div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> divVel = dudx + dvdy;</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160; </div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;  <span class="comment">/*--- Compute the laminar viscosity. ---*/</span></div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160; </div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;  <span class="comment">/*--- Compute the eddy viscosity, if needed. ---*/</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  <span class="keywordflow">if</span>( SGSModelUsed )</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    ViscosityTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(sol[0], dudx, dudy, dvdx,</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;                                                      dvdy, lenScale_LES, wallDist);</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160; </div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;  <span class="comment">/* Compute the total viscosity and heat conductivity. Note that the heat</span></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;<span class="comment">     conductivity is divided by the Cv, because gradients of internal energy</span></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;<span class="comment">     are computed and not temperature. */</span></div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;  Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;  kOverCv   = ViscosityLam*factHeatFlux_Lam + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160; </div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;  <span class="comment">/*--- Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;<span class="comment">        term in the viscous normal stresses. ---*/</span></div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160; </div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;  <span class="comment">/*--- Compute the viscous stress tensor and minus the heatflux vector.</span></div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;<span class="comment">        The heat flux vector is multiplied by factHeatFlux, such that the</span></div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;<span class="comment">        case of a prescribed heat flux is treated correctly. ---*/</span></div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160; </div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qx = factHeatFlux*kOverCv*dStaticEnergyDx;</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qy = factHeatFlux*kOverCv*dStaticEnergyDy;</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160; </div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;  <span class="comment">/* Compute the unscaled normal vector. */</span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nx = normal[0]*normal[2];</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ny = normal[1]*normal[2];</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160; </div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;  <span class="comment">/*--- Compute the viscous normal flux. Note that the energy flux get a</span></div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;<span class="comment">        contribution from both the prescribed and the computed heat flux.</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;<span class="comment">        At least one of these terms is zero. ---*/</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;  normalFlux[0] = 0.0;</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;  normalFlux[1] = tauxx*nx + tauxy*ny;</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  normalFlux[2] = tauxy*nx + tauyy*ny;</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;  normalFlux[3] = normal[2]*HeatFlux</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;                + (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy + qx)*nx + (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyy + qy)*ny;</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;}</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160; </div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ViscousNormalFluxIntegrationPoint_3D(<span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol,</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> solGradCart[5][3],</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normal,</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> HeatFlux,</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux,</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wallDist,</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale_LES,</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;                                                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> &amp;Viscosity,</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;                                                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> &amp;kOverCv,</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;                                                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normalFlux) {</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160; </div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, namely the ratio of</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;<span class="comment">     thermal conductivity and viscosity. */</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Lam  = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux_Turb = <a class="code" href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160; </div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;  <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv = 1.0/sol[0];</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> = rhoInv*sol[1];</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> = rhoInv*sol[2];</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> w = rhoInv*sol[3];</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160; </div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TotalEnergy  = rhoInv*sol[4];</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = TotalEnergy - 0.5*(<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a> + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*<a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a> + w*w);</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160; </div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;  <span class="comment">/*--- Compute the Cartesian gradients of the velocities and static energy</span></div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;<span class="comment">        in this integration point and also the divergence of the velocity. ---*/</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudx = rhoInv*(solGradCart[1][0] - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*solGradCart[0][0]);</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudy = rhoInv*(solGradCart[1][1] - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*solGradCart[0][1]);</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dudz = rhoInv*(solGradCart[1][2] - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*solGradCart[0][2]);</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160; </div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdx = rhoInv*(solGradCart[2][0] - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*solGradCart[0][0]);</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdy = rhoInv*(solGradCart[2][1] - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*solGradCart[0][1]);</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dvdz = rhoInv*(solGradCart[2][2] - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*solGradCart[0][2]);</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160; </div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdx = rhoInv*(solGradCart[3][0] - w*solGradCart[0][0]);</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdy = rhoInv*(solGradCart[3][1] - w*solGradCart[0][1]);</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dwdz = rhoInv*(solGradCart[3][2] - w*solGradCart[0][2]);</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160; </div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDx = rhoInv*(solGradCart[4][0]</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;                                  -         TotalEnergy*solGradCart[0][0])</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;                                  - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudx - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdx - w*dwdx;</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDy = rhoInv*(solGradCart[4][1]</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;                                  -         TotalEnergy*solGradCart[0][1])</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;                                  - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudy - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdy - w*dwdy;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dStaticEnergyDz = rhoInv*(solGradCart[4][2]</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;                                  -         TotalEnergy*solGradCart[0][2])</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                                  - <a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*dudz - <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*dvdz - w*dwdz;</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160; </div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> divVel = dudx + dvdy + dwdz;</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160; </div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;  <span class="comment">/*--- Compute the laminar viscosity. ---*/</span></div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityLam = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160; </div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;  <span class="comment">/*--- Compute the eddy viscosity, if needed. ---*/</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;  <span class="keywordflow">if</span>( SGSModelUsed )</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    ViscosityTurb = SGSModel-&gt;<a class="code" href="classCSGSModel.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(sol[0], dudx, dudy, dudz,</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;                                                      dvdx, dvdy, dvdz, dwdx,</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;                                                      dwdy, dwdz, lenScale_LES,</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;                                                      wallDist);</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160; </div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;  <span class="comment">/* Compute the total viscosity and heat conductivity. Note that the heat</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="comment">     conductivity is divided by the Cv, because gradients of internal energy</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;<span class="comment">     are computed and not temperature. */</span></div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;  Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;  kOverCv   = ViscosityLam*factHeatFlux_Lam + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160; </div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;  <span class="comment">/*--- Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;<span class="comment">        term in the viscous normal stresses. ---*/</span></div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160; </div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;  <span class="comment">/*--- Compute the viscous stress tensor and minus the heatflux vector.</span></div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;<span class="comment">        The heat flux vector is multiplied by factHeatFlux, such that the</span></div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;<span class="comment">        case of a prescribed heat flux is treated correctly. ---*/</span></div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauzz = 2.0*Viscosity*dwdz + lamDivTerm;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160; </div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauxz = Viscosity*(dudz + dwdx);</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauyz = Viscosity*(dvdz + dwdy);</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160; </div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qx = factHeatFlux*kOverCv*dStaticEnergyDx;</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qy = factHeatFlux*kOverCv*dStaticEnergyDy;</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> qz = factHeatFlux*kOverCv*dStaticEnergyDz;</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160; </div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;  <span class="comment">/* Compute the unscaled normal vector. */</span></div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nx = normal[0]*normal[3];</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ny = normal[1]*normal[3];</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nz = normal[2]*normal[3];</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160; </div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;  <span class="comment">/*--- Compute the viscous normal flux. Note that the energy flux get a</span></div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;<span class="comment">        contribution from both the prescribed and the computed heat flux.</span></div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;<span class="comment">        At least one of these terms is zero. ---*/</span></div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;  normalFlux[0] = 0.0;</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;  normalFlux[1] = tauxx*nx + tauxy*ny + tauxz*nz;</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  normalFlux[2] = tauxy*nx + tauyy*ny + tauyz*nz;</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;  normalFlux[3] = tauxz*nx + tauyz*ny + tauzz*nz;</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;  normalFlux[4] = normal[3]*HeatFlux</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;                + (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxx + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauxy + w*tauxz + qx)*nx</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;                + (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxy + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyy + w*tauyz + qy)*ny</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;                + (<a class="code" href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a>*tauxz + <a class="code" href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a>*tauyz + w*tauzz + qz)*nz;</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;}</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160; </div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::PenaltyTermsFluxFace(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indFaceChunk,</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt,</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *solInt0,</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *solInt1,</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *viscosityInt0,</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *viscosityInt1,</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *kOverCvInt0,</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *kOverCvInt1,</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      ConstPenFace,</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      lenScale0,</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      lenScale1,</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *metricNormalsFace,</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;                                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *penaltyFluxes) {</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160; </div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;  <span class="comment">/* Constant ratio of the second viscosity and the viscosity itself. */</span></div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambdaOverMu = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160; </div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;  <span class="comment">/* The eigenvalues of the viscous Jacobian, scaled by the kinematic viscosity,</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;<span class="comment">     are 1.0, 2.0 + lambdaOverMu and kOverCv/Mu. The last is variable due to the</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;<span class="comment">     possible presence of an eddy viscosity, but the first two are constant and</span></div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;<span class="comment">     the maximum can be determined. */</span></div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radOverNuTerm = max(1.0, 2.0+lambdaOverMu);</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160; </div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;  <span class="comment">/*--- Make a distinction between 2D and 3D for efficiency. ---*/</span></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;  <span class="keywordflow">switch</span> ( <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160; </div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;      <span class="comment">/* 2D simulation. Loop over the integration points to compute</span></div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;<span class="comment">         the penalty fluxes. */</span></div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160; </div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;        <span class="comment">/* Easier storage of the variables for this integration point. */</span></div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol0   = solInt0 + offPointer;</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol1   = solInt1 + offPointer;</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normal = metricNormalsFace + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *flux   = penaltyFluxes + offPointer;</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160; </div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;        <span class="comment">/* Determine the ratio of kOverCv and mu for both sides and compute the</span></div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;<span class="comment">           spectral radius of the viscous terms, scaled by kinematic viscosity. */</span></div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux0 = kOverCvInt0[ind]/viscosityInt0[ind];</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux1 = kOverCvInt1[ind]/viscosityInt1[ind];</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160; </div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radOverNu0 = max(radOverNuTerm, factHeatFlux0);</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radOverNu1 = max(radOverNuTerm, factHeatFlux1);</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160; </div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;        <span class="comment">/* Compute the kinematic viscosities of both sides. Multiply it by</span></div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;<span class="comment">           ConstPenFace and divide by the length scale. */</span></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nu0 = ConstPenFace*viscosityInt0[ind]/(lenScale0*sol0[0]);</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nu1 = ConstPenFace*viscosityInt1[ind]/(lenScale1*sol1[0]);</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160; </div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;        <span class="comment">/* Compute the penalty parameter of this face as the maximum of the</span></div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;<span class="comment">           penalty parameter from both sides. Multiply by the area to obtain the</span></div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;<span class="comment">           correct expression. */</span></div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> pen0 = radOverNu0*nu0;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> pen1 = radOverNu1*nu1;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160; </div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> penFace = normal[2]*max(pen0, pen1);</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160; </div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;        <span class="comment">/* Compute the penalty flux, where it is assumed that the normal points from</span></div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;<span class="comment">           side 0 to side 1. */</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;        flux[0] = penFace*(sol0[0] - sol1[0]);</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;        flux[1] = penFace*(sol0[1] - sol1[1]);</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;        flux[2] = penFace*(sol0[2] - sol1[2]);</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;        flux[3] = penFace*(sol0[3] - sol1[3]);</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;      }</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160; </div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;    }</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160; </div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;    <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160; </div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160; </div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;      <span class="comment">/* 3D simulation. Loop over the integration points to compute</span></div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;<span class="comment">         the penalty fluxes. */</span></div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160; </div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;        <span class="comment">/* Easier storage of the variables for this integration point. */</span></div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol0   = solInt0 + offPointer;</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol1   = solInt1 + offPointer;</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normal = metricNormalsFace + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *flux   = penaltyFluxes + offPointer;</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160; </div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;        <span class="comment">/* Determine the ratio of kOverCv and mu for both sides and compute the</span></div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;<span class="comment">           spectral radius of the viscous terms, scaled by kinematic viscosity. */</span></div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux0 = kOverCvInt0[ind]/viscosityInt0[ind];</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factHeatFlux1 = kOverCvInt1[ind]/viscosityInt1[ind];</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160; </div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radOverNu0 = max(radOverNuTerm, factHeatFlux0);</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> radOverNu1 = max(radOverNuTerm, factHeatFlux1);</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160; </div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;        <span class="comment">/* Compute the kinematic viscosities of both sides. Multiply it by</span></div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;<span class="comment">           ConstPenFace and divide by the length scale. */</span></div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nu0 = ConstPenFace*viscosityInt0[ind]/(lenScale0*sol0[0]);</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nu1 = ConstPenFace*viscosityInt1[ind]/(lenScale1*sol1[0]);</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160; </div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;        <span class="comment">/* Compute the penalty parameter of this face as the maximum of the</span></div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;<span class="comment">           penalty parameter from both sides. Multiply by the area to obtain the</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;<span class="comment">           correct expression. */</span></div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> pen0 = radOverNu0*nu0;</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> pen1 = radOverNu1*nu1;</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160; </div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> penFace = normal[3]*max(pen0, pen1);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160; </div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;        <span class="comment">/* Compute the penalty flux, where it is assumed that the normal points from</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;<span class="comment">           side 0 to side 1. */</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;        flux[0] = penFace*(sol0[0] - sol1[0]);</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;        flux[1] = penFace*(sol0[1] - sol1[1]);</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;        flux[2] = penFace*(sol0[2] - sol1[2]);</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;        flux[3] = penFace*(sol0[3] - sol1[3]);</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;        flux[4] = penFace*(sol0[4] - sol1[4]);</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;      }</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160; </div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;    }</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;  }</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;}</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160; </div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::SymmetrizingFluxesFace(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indFaceChunk,</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt,</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *solInt0,</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *solInt1,</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *viscosityInt0,</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *viscosityInt1,</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *kOverCvInt0,</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *kOverCvInt1,</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *metricNormalsFace,</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;                                                    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *symmFluxes) {</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160; </div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;  <span class="comment">/* Constant ratio of the second viscosity and the viscosity itself. */</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambdaOverMu = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160; </div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;  <span class="comment">/*--- Set two factors such that either the original or the transposed diffusion</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;<span class="comment">        tensor is taken in the symmetrizing fluxes. ---*/</span></div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160; </div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;  <span class="comment">/* Use the following line for the original formulation. */</span></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> alpha = lambdaOverMu;</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160; </div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;  <span class="comment">/* Use the following line for the transposed formulation. */</span></div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;  <span class="comment">//const su2double alpha = 1.0;</span></div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160; </div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;  <span class="comment">/* Other constants, which appear in the symmetrizing fluxes. */</span></div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> beta     = lambdaOverMu + 1.0 - alpha;</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> alphaP1  = alpha + 1.0;</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lambdaP1 = lambdaOverMu + 1.0;</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160; </div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;  <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;<span class="comment">     in order to have the most efficient code. */</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;  <span class="keywordflow">switch</span>( <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160; </div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160; </div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;      <span class="comment">/*--- 2D simulation. Loop over the number of integration points</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;<span class="comment">            of the face. ---*/</span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160; </div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;        <span class="comment">/* Easier storage of the variables for this integration point. */</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol0   = solInt0 + offPointer;</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol1   = solInt1 + offPointer;</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normal = metricNormalsFace + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160; </div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *flux = symmFluxes + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160; </div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;         <span class="comment">/* Determine the difference in conservative variables. Multiply these</span></div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;<span class="comment">           differences by the length of the normal vector to obtain the correct</span></div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;<span class="comment">           dimensions for the symmetrizing fluxes. */</span></div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSol[] = {normal[2]*(sol0[0] - sol1[0]),</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;                                  normal[2]*(sol0[1] - sol1[1]),</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;                                  normal[2]*(sol0[2] - sol1[2]),</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;                                  normal[2]*(sol0[3] - sol1[3])};</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160; </div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;        <span class="comment">/*--- Compute the terms that occur in the symmetrizing fluxes</span></div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;<span class="comment">              for state 0 and state 1. ---*/</span></div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160; </div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv0 = 1.0/sol0[0],             DensityInv1 = 1.0/sol1[0];</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Etot0 = DensityInv0*sol0[3],           Etot1 = DensityInv1*sol1[3];</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nu0 = DensityInv0*viscosityInt0[ind],  nu1 = DensityInv1*viscosityInt1[ind];</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kScal0 = DensityInv0*kOverCvInt0[ind], kScal1 = DensityInv1*kOverCvInt1[ind];</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160; </div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel0[] = {DensityInv0*sol0[1], DensityInv0*sol0[2]};</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel1[] = {DensityInv1*sol1[1], DensityInv1*sol1[2]};</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160; </div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velNorm0 = vel0[0]*normal[0] + vel0[1]*normal[1];</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velNorm1 = vel1[0]*normal[0] + vel1[1]*normal[1];</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160; </div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velSquared0 = vel0[0]*vel0[0] + vel0[1]*vel0[1];</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velSquared1 = vel1[0]*vel1[0] + vel1[1]*vel1[1];</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160; </div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;        <span class="comment">/*--- Compute the average of the terms that occur in the symmetrizing</span></div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;<span class="comment">              fluxes. The average of the left and right terms is taken, rather</span></div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;<span class="comment">              than the terms evaluated at the average state, because the viscous</span></div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;<span class="comment">              fluxes are also computed as the average of the fluxes and not the</span></div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;<span class="comment">              fluxes of the averaged state. ---*/</span></div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuAvg    = 0.5*(nu0    + nu1);</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kScalAvg = 0.5*(kScal0 + kScal1);</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuVelSquaredAvg     = 0.5*(nu0*velSquared0 + nu1*velSquared1);</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuVelNormAve        = 0.5*(nu0*velNorm0    + nu1*velNorm1);</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kScalEminVelSquaredAve = 0.5*(kScal0*(Etot0-velSquared0)</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;                                               +      kScal1*(Etot1-velSquared1));</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160; </div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuVelAvg[] = {0.5*(nu0*vel0[0] + nu1*vel1[0]),</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;                                      0.5*(nu0*vel0[1] + nu1*vel1[1])};</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kScalVelAvg[] = {0.5*(kScal0*vel0[0] + kScal1*vel1[0]),</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;                                         0.5*(kScal0*vel0[1] + kScal1*vel1[1])};</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuVelVelAvg[] = {0.5*(nu0*vel0[0]*velNorm0 + nu1*vel1[0]*velNorm1),</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;                                         0.5*(nu0*vel0[1]*velNorm0 + nu1*vel1[1]*velNorm1)};</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160; </div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;        <span class="comment">/*--- Abbreviations to make the flux computations a bit more efficient. ---*/</span></div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv1 = normal[0]  *dSol[1] + normal[1]  *dSol[2];</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv2 = nuVelAvg[0]*dSol[1] + nuVelAvg[1]*dSol[2];</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160; </div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv2kScal = kScalVelAvg[0]*dSol[1] + kScalVelAvg[1]*dSol[2];</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160; </div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv3 = beta*(nuAvg*abv1 - nuVelNormAve*dSol[0]);</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv4 = kScalAvg*dSol[3] - abv2kScal</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;                             - kScalEminVelSquaredAve*dSol[0] + abv2;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160; </div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in x-direction. ---*/</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;        flux[1] = abv3 + alphaP1*normal[0]*(nuAvg*dSol[1] - nuVelAvg[0]*dSol[0]);</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;        flux[2] = nuAvg*(normal[0]*dSol[2] + alpha*normal[1]*dSol[1])</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;                - (normal[0]*nuVelAvg[1] + alpha*normal[1]*nuVelAvg[0])*dSol[0];</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;        flux[3] = normal[0]*abv4</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;                - (lambdaP1*nuVelVelAvg[0] + nuVelSquaredAvg*normal[0])*dSol[0]</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;                + alpha*nuVelNormAve*dSol[1] + beta*nuVelAvg[0]*abv1;</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160; </div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in y-direction. */</span></div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;        flux = flux + NPad;</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;        flux[1] = nuAvg*(normal[1]*dSol[1] + alpha*normal[0]*dSol[2])</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;                - (normal[1]*nuVelAvg[0] + alpha*normal[0]*nuVelAvg[1])*dSol[0];</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;        flux[2] = abv3 + alphaP1*normal[1]*(nuAvg*dSol[2] - nuVelAvg[1]*dSol[0]);</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;        flux[3] = normal[1]*abv4</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;                - (lambdaP1*nuVelVelAvg[1] + nuVelSquaredAvg*normal[1])*dSol[0]</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;                + alpha*nuVelNormAve*dSol[2] + beta*nuVelAvg[1]*abv1;</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      }</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160; </div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;    }</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160; </div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160; </div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160; </div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      <span class="comment">/*--- 3D simulation. Loop over the number of integration points</span></div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;<span class="comment">            of the face. ---*/</span></div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160; </div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;        <span class="comment">/* Easier storage of the variables for this integration point. */</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol0   = solInt0 + offPointer;</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *sol1   = solInt1 + offPointer;</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normal = metricNormalsFace + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160; </div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *flux = symmFluxes + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160; </div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;        <span class="comment">/* Determine the difference in conservative variables. Multiply these</span></div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;<span class="comment">           differences by the length of the normal vector to obtain the correct</span></div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;<span class="comment">           dimensions for the symmetrizing fluxes. */</span></div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSol[] = {normal[3]*(sol0[0] - sol1[0]),</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;                                  normal[3]*(sol0[1] - sol1[1]),</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;                                  normal[3]*(sol0[2] - sol1[2]),</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;                                  normal[3]*(sol0[3] - sol1[3]),</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                                  normal[3]*(sol0[4] - sol1[4])};</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160; </div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;        <span class="comment">/*--- Compute the terms that occur in the symmetrizing fluxes</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;<span class="comment">              for state 0 and state 1. ---*/</span></div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160; </div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv0 = 1.0/sol0[0],             DensityInv1 = 1.0/sol1[0];</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Etot0 = DensityInv0*sol0[4],           Etot1 = DensityInv1*sol1[4];</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nu0 = DensityInv0*viscosityInt0[ind],  nu1 = DensityInv1*viscosityInt1[ind];</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kScal0 = DensityInv0*kOverCvInt0[ind], kScal1 = DensityInv1*kOverCvInt1[ind];</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160; </div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel0[] = {DensityInv0*sol0[1], DensityInv0*sol0[2], DensityInv0*sol0[3]};</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel1[] = {DensityInv1*sol1[1], DensityInv1*sol1[2], DensityInv1*sol1[3]};</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160; </div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velNorm0 = vel0[0]*normal[0] + vel0[1]*normal[1] + vel0[2]*normal[2];</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velNorm1 = vel1[0]*normal[0] + vel1[1]*normal[1] + vel1[2]*normal[2];</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160; </div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velSquared0 = vel0[0]*vel0[0] + vel0[1]*vel0[1] + vel0[2]*vel0[2];</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velSquared1 = vel1[0]*vel1[0] + vel1[1]*vel1[1] + vel1[2]*vel1[2];</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160; </div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;        <span class="comment">/*--- Compute the average of the terms that occur in the symmetrizing</span></div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;<span class="comment">              fluxes. The average of the left and right terms is taken, rather</span></div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;<span class="comment">              than the terms evaluated at the average state, because the viscous</span></div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;<span class="comment">              fluxes are also computed as the average of the fluxes and not the</span></div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;<span class="comment">              fluxes of the averaged state. ---*/</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuAvg    = 0.5*(nu0    + nu1);</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kScalAvg = 0.5*(kScal0 + kScal1);</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuVelSquaredAvg     = 0.5*(nu0*velSquared0 + nu1*velSquared1);</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuVelNormAve        = 0.5*(nu0*velNorm0    + nu1*velNorm1);</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kScalEminVelSquaredAve = 0.5*(kScal0*(Etot0-velSquared0)</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                                               +      kScal1*(Etot1-velSquared1));</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160; </div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuVelAvg[] = {0.5*(nu0*vel0[0] + nu1*vel1[0]),</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                                      0.5*(nu0*vel0[1] + nu1*vel1[1]),</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                                      0.5*(nu0*vel0[2] + nu1*vel1[2])};</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kScalVelAvg[] = {0.5*(kScal0*vel0[0] + kScal1*vel1[0]),</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                                         0.5*(kScal0*vel0[1] + kScal1*vel1[1]),</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                                         0.5*(kScal0*vel0[2] + kScal1*vel1[2])};</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> nuVelVelAvg[] = {0.5*(nu0*vel0[0]*velNorm0 + nu1*vel1[0]*velNorm1),</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                                         0.5*(nu0*vel0[1]*velNorm0 + nu1*vel1[1]*velNorm1),</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;                                         0.5*(nu0*vel0[2]*velNorm0 + nu1*vel1[2]*velNorm1)};</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160; </div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;        <span class="comment">/*--- Abbreviations to make the flux computations a bit more efficient. ---*/</span></div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv1 = normal[0]  *dSol[1] + normal[1]  *dSol[2] + normal[2]  *dSol[3];</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv2 = nuVelAvg[0]*dSol[1] + nuVelAvg[1]*dSol[2] + nuVelAvg[2]*dSol[3];</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160; </div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv2kScal = kScalVelAvg[0]*dSol[1] + kScalVelAvg[1]*dSol[2]</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;                                  + kScalVelAvg[2]*dSol[3];</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160; </div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv3 = beta*(nuAvg*abv1 - nuVelNormAve*dSol[0]);</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> abv4 = kScalAvg*dSol[4] - abv2kScal</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;                             - kScalEminVelSquaredAve*dSol[0] + abv2;</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160; </div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in x-direction. ---*/</span></div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;        flux[1] = abv3 + alphaP1*normal[0]*(nuAvg*dSol[1] - nuVelAvg[0]*dSol[0]);</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;        flux[2] = nuAvg*(normal[0]*dSol[2] + alpha*normal[1]*dSol[1])</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;                - (normal[0]*nuVelAvg[1] + alpha*normal[1]*nuVelAvg[0])*dSol[0];</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;        flux[3] = nuAvg*(normal[0]*dSol[3] + alpha*normal[2]*dSol[1])</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;                - (normal[0]*nuVelAvg[2] + alpha*normal[2]*nuVelAvg[0])*dSol[0];</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;        flux[4] = normal[0]*abv4</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;                - (lambdaP1*nuVelVelAvg[0] + nuVelSquaredAvg*normal[0])*dSol[0]</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;                + alpha*nuVelNormAve*dSol[1] + beta*nuVelAvg[0]*abv1;</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160; </div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in y-direction. ---*/</span></div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;        flux    = flux + NPad;</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;        flux[1] = nuAvg*(normal[1]*dSol[1] + alpha*normal[0]*dSol[2])</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;                - (normal[1]*nuVelAvg[0] + alpha*normal[0]*nuVelAvg[1])*dSol[0];</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;        flux[2] = abv3 + alphaP1*normal[1]*(nuAvg*dSol[2] - nuVelAvg[1]*dSol[0]);</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;        flux[3] = nuAvg*(normal[1]*dSol[3] + alpha*normal[2]*dSol[2])</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;                - (normal[1]*nuVelAvg[2] + alpha*normal[2]*nuVelAvg[1])*dSol[0];</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;        flux[4] = normal[1]*abv4</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;                - (lambdaP1*nuVelVelAvg[1] + nuVelSquaredAvg*normal[1])*dSol[0]</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;                + alpha*nuVelNormAve*dSol[2] + beta*nuVelAvg[1]*abv1;</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160; </div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in z-direction. ---*/</span></div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;        flux    = flux + NPad;</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;        flux[1] = nuAvg*(normal[2]*dSol[1] + alpha*normal[0]*dSol[3])</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;                - (normal[2]*nuVelAvg[0] + alpha*normal[0]*nuVelAvg[2])*dSol[0];</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;        flux[2] = nuAvg*(normal[2]*dSol[2] + alpha*normal[1]*dSol[3])</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;                - (normal[2]*nuVelAvg[1] + alpha*normal[1]*nuVelAvg[2])*dSol[0];</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;        flux[3] = abv3 + alphaP1*normal[2]*(nuAvg*dSol[3] - nuVelAvg[2]*dSol[0]);</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;        flux[4] = normal[2]*abv4</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;                - (lambdaP1*nuVelVelAvg[2] + nuVelSquaredAvg*normal[2])*dSol[0]</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;                + alpha*nuVelNormAve*dSol[3] + beta*nuVelAvg[2]*abv1;</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      }</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160; </div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;    }</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;  }</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;}</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160; </div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::TransformSymmetrizingFluxes(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indFaceChunk,</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt,</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      halfTheta,</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *symmFluxes,</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *weights,</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *metricCoorFace,</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;                                                         <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      *paramFluxes) {</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160; </div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;  <span class="comment">/*--- Transform the fluxes, such that they must be multiplied with the</span></div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;<span class="comment">        gradients w.r.t. the parametric coordinates rather than the</span></div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;<span class="comment">        Cartesian coordinates of the basis functions. This involves the</span></div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;<span class="comment">        multiplication with the metric terms. Also multiply the fluxes with</span></div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;<span class="comment">        their integration weights and -theta/2. The parameter theta is the</span></div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;<span class="comment">        parameter in the Interior Penalty formulation, the factor 1/2 comes in</span></div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;<span class="comment">        from the averaging and the minus sign is from the convention that the</span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;<span class="comment">        viscous fluxes come with a minus sign in this code. ---*/</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160; </div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;  <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;<span class="comment">     in order to have the most efficient code. */</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;  <span class="keywordflow">switch</span>( <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160; </div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;      <span class="comment">/* Two-dimensional computation. Loop over the integration</span></div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;<span class="comment">         points to correct the fluxes. */</span></div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160; </div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;        <span class="comment">/* Easier storage of the location where the the fluxes</span></div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;<span class="comment">           are stored for this integration point as well as an</span></div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;<span class="comment">           abbreviation for the integration weights time halfTheta. */</span></div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad + indFaceChunk*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxX =  symmFluxes + offPointer;</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxY =  fluxX + NPad;</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wTheta = -halfTheta*weights[i];</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *paramFlux   =  paramFluxes + offPointer;</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160; </div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;        <span class="comment">/* Compute the modified metric terms. */</span></div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = metricCoorFace + 4*i;   <span class="comment">// The 4 is nDim*nDim;</span></div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = wTheta*metricTerms[0];</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = wTheta*metricTerms[1];</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = wTheta*metricTerms[2];</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = wTheta*metricTerms[3];</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160; </div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;        <span class="comment">/* Parametric fluxes in r-direction. */</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;        paramFlux[0] = fluxX[0]*drdx + fluxY[0]*drdy;</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;        paramFlux[1] = fluxX[1]*drdx + fluxY[1]*drdy;</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;        paramFlux[2] = fluxX[2]*drdx + fluxY[2]*drdy;</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;        paramFlux[3] = fluxX[3]*drdx + fluxY[3]*drdy;</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160; </div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;        <span class="comment">/* Parametric fluxes in s-direction. */</span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;        paramFlux    = paramFlux + NPad;</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;        paramFlux[0] = fluxX[0]*dsdx + fluxY[0]*dsdy;</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;        paramFlux[1] = fluxX[1]*dsdx + fluxY[1]*dsdy;</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;        paramFlux[2] = fluxX[2]*dsdx + fluxY[2]*dsdy;</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;        paramFlux[3] = fluxX[3]*dsdx + fluxY[3]*dsdy;</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;      }</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160; </div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;    }</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160; </div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;      <span class="comment">/* Three-dimensional computation. Loop over the integration</span></div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;<span class="comment">         points to correct the fluxes. */</span></div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160; </div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;        <span class="comment">/* Easier storage of the location where the the fluxes</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;<span class="comment">           are stored for this integration point as well as an</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;<span class="comment">           abbreviation for the integration weights time halfTheta. */</span></div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad + indFaceChunk*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxX =  symmFluxes + offPointer;</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxY =  fluxX + NPad;</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxZ =  fluxY + NPad;</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wTheta = -halfTheta*weights[i];</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *paramFlux   =  paramFluxes + offPointer;</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160; </div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;        <span class="comment">/* Compute the modified metric terms. */</span></div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = metricCoorFace + 9*i;   <span class="comment">// The 9 is nDim*nDim;</span></div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = wTheta*metricTerms[0];</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = wTheta*metricTerms[1];</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdz = wTheta*metricTerms[2];</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160; </div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = wTheta*metricTerms[3];</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = wTheta*metricTerms[4];</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdz = wTheta*metricTerms[5];</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160; </div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdx = wTheta*metricTerms[6];</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdy = wTheta*metricTerms[7];</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdz = wTheta*metricTerms[8];</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160; </div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;        <span class="comment">/* Parametric fluxes in r-direction. */</span></div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;        paramFlux[0] = fluxX[0]*drdx + fluxY[0]*drdy + fluxZ[0]*drdz;</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;        paramFlux[1] = fluxX[1]*drdx + fluxY[1]*drdy + fluxZ[1]*drdz;</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;        paramFlux[2] = fluxX[2]*drdx + fluxY[2]*drdy + fluxZ[2]*drdz;</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;        paramFlux[3] = fluxX[3]*drdx + fluxY[3]*drdy + fluxZ[3]*drdz;</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;        paramFlux[4] = fluxX[4]*drdx + fluxY[4]*drdy + fluxZ[4]*drdz;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160; </div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;        <span class="comment">/* Parametric fluxes in s-direction. */</span></div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;        paramFlux    = paramFlux + NPad;</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;        paramFlux[0] = fluxX[0]*dsdx + fluxY[0]*dsdy + fluxZ[0]*dsdz;</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;        paramFlux[1] = fluxX[1]*dsdx + fluxY[1]*dsdy + fluxZ[1]*dsdz;</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;        paramFlux[2] = fluxX[2]*dsdx + fluxY[2]*dsdy + fluxZ[2]*dsdz;</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;        paramFlux[3] = fluxX[3]*dsdx + fluxY[3]*dsdy + fluxZ[3]*dsdz;</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;        paramFlux[4] = fluxX[4]*dsdx + fluxY[4]*dsdy + fluxZ[4]*dsdz;</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160; </div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;        <span class="comment">/* Parametric fluxes in t-direction. */</span></div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;        paramFlux    = paramFlux + NPad;</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;        paramFlux[0] = fluxX[0]*dtdx + fluxY[0]*dtdy + fluxZ[0]*dtdz;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;        paramFlux[1] = fluxX[1]*dtdx + fluxY[1]*dtdy + fluxZ[1]*dtdz;</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;        paramFlux[2] = fluxX[2]*dtdx + fluxY[2]*dtdy + fluxZ[2]*dtdz;</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;        paramFlux[3] = fluxX[3]*dtdx + fluxY[3]*dtdy + fluxZ[3]*dtdz;</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;        paramFlux[4] = fluxX[4]*dtdx + fluxY[4]*dtdy + fluxZ[4]*dtdz;</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;      }</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160; </div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;    }</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;  }</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;}</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160; </div>
<div class="line"><a name="l04979"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a3bc4438cb7e9feb7f388d4ba87745996"> 4979</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a3bc4438cb7e9feb7f388d4ba87745996">CFEM_DG_NSSolver::BC_Euler_Wall</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;                                     <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                                     <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;                                     <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray){</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160; </div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160; </div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160; </div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160; </div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160; </div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160; </div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160; </div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160; </div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160; </div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160; </div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;    <span class="comment">/* Compute the right state by applying the inviscid wall BC&#39;s. */</span></div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a5d32e85923daf35ff0126d5f716ff9ec">BoundaryStates_Euler_Wall</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;                              solIntL, solIntR);</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160; </div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;                                    indResFaces, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160; </div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;  }</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;}</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160; </div>
<div class="line"><a name="l05045"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a4eff2ed485808a8a96cb9bb9c7936058"> 5045</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a4eff2ed485808a8a96cb9bb9c7936058">CFEM_DG_NSSolver::BC_Far_Field</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;                                    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;                                    <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;                                    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray){</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160; </div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160; </div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160; </div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160; </div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160; </div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160; </div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160; </div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160; </div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160; </div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160; </div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;    <span class="comment">/* Set the right state in the integration points to the free stream value. */</span></div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UR = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++j)</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;          UR[j] = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[j];</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;      }</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;    }</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160; </div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;                                    indResFaces, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160; </div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;  }</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;}</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160; </div>
<div class="line"><a name="l05117"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a44020ceaf82c37e386385366c6cda7a5"> 5117</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a44020ceaf82c37e386385366c6cda7a5">CFEM_DG_NSSolver::BC_Sym_Plane</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;                                    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;                                    <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                                    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray){</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160; </div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160; </div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160; </div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160; </div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160; </div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;    <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;    <span class="comment">/*--- Step 1: Initialization and computation of the left states.         ---*/</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;    <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160; </div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160; </div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160; </div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt         = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem    = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>     *derBasisElem = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#abd2f5656593a34508bdfb2093a1d6f92">GetMatDerBasisElemIntegration</a>();</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160; </div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL      = workArray;</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR      = solIntL + NPad*nInt;</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscosityInt = solIntR + NPad*nInt;</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *kOverCvInt   = viscosityInt + llEnd*nInt;</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradSolInt   = kOverCvInt   + llEnd*nInt;</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxes       = gradSolInt   + NPad*nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscFluxes   = fluxes       + NPad*max(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, (<span class="keywordtype">int</span>) nDOFsElem);</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160; </div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;    <span class="comment">/* Compute the left states in the integration points of this chunk of</span></div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;<span class="comment">       faces.  Use fluxes as a temporary storage array. */</span></div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                                            fluxes, solIntL);</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160; </div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;    <span class="comment">/*--- Step 2: Computation of the gradients of the conservative        ---*/</span></div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;    <span class="comment">/*---         variables w.r.t. the parametric coordinates.            ---*/</span></div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160; </div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;    <span class="comment">/* Set the pointer solElem to fluxes, just for readability. It is a temporary</span></div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;<span class="comment">       storage of the solution of the elements, such that the gradients can be</span></div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;<span class="comment">       computed efficiently. */</span></div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solElem = fluxes;</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160; </div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;    <span class="comment">/* Loop over the faces of the chunk to set the conservative variables</span></div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;<span class="comment">       in the appropriate sequence. */</span></div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel  = ll - l;</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = llRel*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160; </div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;      <span class="comment">/* Determine the time level of the boundary face, which is equal</span></div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;<span class="comment">         to the time level of the adjacent element. */</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemID    = surfElem[ll].<a class="code" href="structCSurfaceElementFEM.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="classCVolumeElementFEM.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160; </div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;      <span class="comment">/* Determine the offset that must be applied to access the correct data for</span></div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;<span class="comment">         the adjacent element in the working vector of the solution. This is a</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;<span class="comment">         boundary face, which has the same time level as the adjacent element. */</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;                                 - <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160; </div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;      <span class="comment">/* Loop over the DOFs of the element and copy the solution. */</span></div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem; ++i) {</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;                                + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(surfElem[ll].<a class="code" href="structCSurfaceElementFEM.html#abdf9f21e0435e853d60d7faeecbb5e2f">DOFsSolElement</a>[i] - offset);</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;          solElem[NPad*i+llNVar+mm] = solDOF[mm];</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;      }</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;    }</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160; </div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    <span class="comment">/* Compute the left gradients in the integration points. Call the general</span></div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;<span class="comment">       function to carry out the matrix product. */</span></div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem, derBasisElem, solElem, gradSolInt, config);</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160; </div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;    <span class="comment">/*--- Step 3: Computation of the viscous fluxes in the integration    ---*/</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;    <span class="comment">/*---         points.                                                 ---*/</span></div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160; </div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;    <span class="comment">/* Determine the offset between r- and -s-derivatives, which is also the</span></div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;<span class="comment">       offset between s- and t-derivatives. */</span></div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160; </div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;    <span class="comment">/* Loop over the faces of the chunk. */</span></div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel  = ll - l;</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = llRel*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160; </div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;      <span class="comment">/* Compute the length scale for the LES of the adjacent element. */</span></div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemID = surfElem[ll].<a class="code" href="structCSurfaceElementFEM.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iind   = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="classCVolumeElementFEM.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160; </div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[iind].<a class="code" href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;      <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160; </div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale_LES = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160; </div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;      <span class="comment">/* Easier storage of the wall distance array for this surface element. */</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *wallDistance = surfElem[ll].<a class="code" href="structCSurfaceElementFEM.html#a69fdb86db7c5b6ac05be11490c3696b5">wallDistance</a>.data();</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160; </div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;      <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;<span class="comment">         in order to have the most efficient code. */</span></div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;      <span class="keywordflow">switch</span>( <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160; </div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;        <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160; </div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;          <span class="comment">/*--- 2D simulation. Loop over the integration points to apply the</span></div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;<span class="comment">                symmetry condition and to compute the viscous normal fluxes. This</span></div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;<span class="comment">                is done in the same loop, because the gradients in the right</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;<span class="comment">                integration points are constructed using the symmetry boundary</span></div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;<span class="comment">                condition. ---*/</span></div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160; </div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;            <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;<span class="comment">               for this integration point. */</span></div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pointerOffset = NPad*i + llNVar;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UL      = solIntL + pointerOffset;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UR      = solIntR + pointerOffset;</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normals = surfElem[ll].<a class="code" href="structCSurfaceElementFEM.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160; </div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;            <span class="comment">/* Compute twice the normal component of the momentum variables. The</span></div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;<span class="comment">               factor 2 comes from the fact that the velocity must be mirrored. */</span></div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rVn = 2.0*(UL[1]*normals[0] + UL[2]*normals[1]);</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160; </div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;            <span class="comment">/* Set the right state. Note that the total energy of the right state is</span></div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;<span class="comment">               identical to the left state, because the magnitude of the velocity</span></div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;<span class="comment">               remains the same. */</span></div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;            UR[0] = UL[0];</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;            UR[1] = UL[1] - rVn*normals[0];</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;            UR[2] = UL[2] - rVn*normals[1];</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;            UR[3] = UL[3];</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160; </div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;            <span class="comment">/* Easier storage of the metric terms and left gradients of this</span></div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;<span class="comment">               integration point. */</span></div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = surfElem[ll].<a class="code" href="structCSurfaceElementFEM.html#a49f9ee99ed3a8a6c5c895050f29169d8">metricCoorDerivFace</a>.data()</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;                                         + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dULDr       = gradSolInt + pointerOffset;</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dULDs       = dULDr + offDeriv;</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160; </div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;            <span class="comment">/* Easier storage of the metric terms in this integration point. */</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = metricTerms[2];</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = metricTerms[3];</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160; </div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;            <span class="comment">/* Compute the Cartesian gradients of the left solution. */</span></div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ULGradCart[4][2];</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;            ULGradCart[0][0] = dULDr[0]*drdx + dULDs[0]*dsdx;</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;            ULGradCart[1][0] = dULDr[1]*drdx + dULDs[1]*dsdx;</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;            ULGradCart[2][0] = dULDr[2]*drdx + dULDs[2]*dsdx;</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;            ULGradCart[3][0] = dULDr[3]*drdx + dULDs[3]*dsdx;</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160; </div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;            ULGradCart[0][1] = dULDr[0]*drdy + dULDs[0]*dsdy;</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;            ULGradCart[1][1] = dULDr[1]*drdy + dULDs[1]*dsdy;</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;            ULGradCart[2][1] = dULDr[2]*drdy + dULDs[2]*dsdy;</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;            ULGradCart[3][1] = dULDr[3]*drdy + dULDs[3]*dsdy;</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160; </div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;            <span class="comment">/* Determine the normal gradients of all variables. */</span></div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ULGradNorm[4];</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;            ULGradNorm[0] = ULGradCart[0][0]*normals[0] + ULGradCart[0][1]*normals[1];</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;            ULGradNorm[1] = ULGradCart[1][0]*normals[0] + ULGradCart[1][1]*normals[1];</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;            ULGradNorm[2] = ULGradCart[2][0]*normals[0] + ULGradCart[2][1]*normals[1];</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;            ULGradNorm[3] = ULGradCart[3][0]*normals[0] + ULGradCart[3][1]*normals[1];</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160; </div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;            <span class="comment">/* For the construction of the gradients of the right solution, also</span></div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;<span class="comment">               the Cartesian gradients and the normal gradient of the normal</span></div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;<span class="comment">               momentum is needed. This is computed below. */</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> GradCartNormMomL[2];</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;            GradCartNormMomL[0] = ULGradCart[1][0]*normals[0] + ULGradCart[2][0]*normals[1];</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;            GradCartNormMomL[1] = ULGradCart[1][1]*normals[0] + ULGradCart[2][1]*normals[1];</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160; </div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> GradNormNormMomL = ULGradNorm[1]*normals[0] + ULGradNorm[2]*normals[1];</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160; </div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;            <span class="comment">/* Abbreviate twice the normal vector. */</span></div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tnx = 2.0*normals[0], tny = 2.0*normals[1];</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160; </div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;            <span class="comment">/*--- Construct the gradients of the right solution. The tangential</span></div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;<span class="comment">                  gradients of the normal momentum and normal gradients of the other</span></div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;<span class="comment">                  variables, density, energy and tangential momentum, must be negated.</span></div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;<span class="comment">                  For the common situation that the symmetry plane coincides with an</span></div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;<span class="comment">                  x- or y-plane this boils down to a multiplication by -1 or +1,</span></div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;<span class="comment">                  depending on the variable and gradient. However, the implementation</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;<span class="comment">                  below is valid for an arbitrary orientation of the symmetry plane. ---*/</span></div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> URGradCart[4][2];</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;            URGradCart[0][0] = ULGradCart[0][0] - tnx*ULGradNorm[0];</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;            URGradCart[1][0] = ULGradCart[1][0] - tnx*ULGradNorm[1] - tnx*GradCartNormMomL[0] + tnx*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;            URGradCart[2][0] = ULGradCart[2][0] - tnx*ULGradNorm[2] - tny*GradCartNormMomL[0] + tnx*tny*GradNormNormMomL;</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;            URGradCart[3][0] = ULGradCart[3][0] - tnx*ULGradNorm[3];</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160; </div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;            URGradCart[0][1] = ULGradCart[0][1] - tny*ULGradNorm[0];</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;            URGradCart[1][1] = ULGradCart[1][1] - tny*ULGradNorm[1] - tnx*GradCartNormMomL[1] + tny*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;            URGradCart[2][1] = ULGradCart[2][1] - tny*ULGradNorm[2] - tny*GradCartNormMomL[1] + tny*tny*GradNormNormMomL;</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;            URGradCart[3][1] = ULGradCart[3][1] - tny*ULGradNorm[3];</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160; </div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;            <span class="comment">/*--- Compute the viscous fluxes of the left and right state and average</span></div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;<span class="comment">                  them to compute the correct viscous flux for a symmetry boundary. ---*/</span></div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wallDist = wallDistance ? wallDistance[i] : 0.0;</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> viscFluxL[4], viscFluxR[4];</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity, kOverCv;</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160; </div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;            ViscousNormalFluxIntegrationPoint_2D(UR, URGradCart, normals, 0.0, 1.0,</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;                                                 wallDist, lenScale_LES, Viscosity,</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;                                                 kOverCv, viscFluxR);</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;            ViscousNormalFluxIntegrationPoint_2D(UL, ULGradCart, normals, 0.0, 1.0,</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;                                                 wallDist, lenScale_LES, Viscosity,</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;                                                 kOverCv, viscFluxL);</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;            viscosityInt[nInt*llRel+i] = Viscosity;</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;            kOverCvInt[nInt*llRel+i]   = kOverCv;</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160; </div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscNormalFlux = viscFluxes + pointerOffset;</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;            viscNormalFlux[0] = 0.5*(viscFluxL[0] + viscFluxR[0]);</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;            viscNormalFlux[1] = 0.5*(viscFluxL[1] + viscFluxR[1]);</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;            viscNormalFlux[2] = 0.5*(viscFluxL[2] + viscFluxR[2]);</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;            viscNormalFlux[3] = 0.5*(viscFluxL[3] + viscFluxR[3]);</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;          }</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160; </div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;        }</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160; </div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160; </div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;        <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160; </div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;          <span class="comment">/*--- 3D simulation. Loop over the integration points to apply the</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;<span class="comment">                symmetry condition and to compute the viscous normal fluxes. This</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;<span class="comment">                is done in the same loop, because the gradients in the right</span></div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;<span class="comment">                integration points are constructed using the symmetry boundary</span></div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;<span class="comment">                condition. ---*/</span></div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160; </div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;            <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;<span class="comment">               for this integration point. */</span></div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pointerOffset = NPad*i + llNVar;</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UL      = solIntL + pointerOffset;</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UR      = solIntR + pointerOffset;</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normals = surfElem[ll].<a class="code" href="structCSurfaceElementFEM.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160; </div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;            <span class="comment">/* Compute twice the normal component of the momentum variables. The</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;<span class="comment">               factor 2 comes from the fact that the velocity must be mirrored. */</span></div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rVn = 2.0*(UL[1]*normals[0] + UL[2]*normals[1] + UL[3]*normals[2]);</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160; </div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;            <span class="comment">/* Set the right state. Note that the total energy of the right state is</span></div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;<span class="comment">               identical to the left state, because the magnitude of the velocity</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;<span class="comment">               remains the same. */</span></div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;            UR[0] = UL[0];</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;            UR[1] = UL[1] - rVn*normals[0];</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;            UR[2] = UL[2] - rVn*normals[1];</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;            UR[3] = UL[3] - rVn*normals[2];</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;            UR[4] = UL[4];</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160; </div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;            <span class="comment">/* Easier storage of the metric terms and left gradients of this</span></div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;<span class="comment">               integration point. */</span></div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *metricTerms = surfElem[ll].<a class="code" href="structCSurfaceElementFEM.html#a49f9ee99ed3a8a6c5c895050f29169d8">metricCoorDerivFace</a>.data()</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;                                         + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dULDr       = gradSolInt + pointerOffset;</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dULDs       = dULDr + offDeriv;</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *dULDt       = dULDs + offDeriv;</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160; </div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;            <span class="comment">/* Easier storage of the metric terms in this integration point. */</span></div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> drdz = metricTerms[2];</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160; </div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdx = metricTerms[3];</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdy = metricTerms[4];</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dsdz = metricTerms[5];</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160; </div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdx = metricTerms[6];</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdy = metricTerms[7];</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dtdz = metricTerms[8];</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160; </div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;            <span class="comment">/* Compute the Cartesian gradients of the left solution. */</span></div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ULGradCart[5][3];</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;            ULGradCart[0][0] = dULDr[0]*drdx + dULDs[0]*dsdx + dULDt[0]*dtdx;</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;            ULGradCart[1][0] = dULDr[1]*drdx + dULDs[1]*dsdx + dULDt[1]*dtdx;</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;            ULGradCart[2][0] = dULDr[2]*drdx + dULDs[2]*dsdx + dULDt[2]*dtdx;</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;            ULGradCart[3][0] = dULDr[3]*drdx + dULDs[3]*dsdx + dULDt[3]*dtdx;</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;            ULGradCart[4][0] = dULDr[4]*drdx + dULDs[4]*dsdx + dULDt[4]*dtdx;</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160; </div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;            ULGradCart[0][1] = dULDr[0]*drdy + dULDs[0]*dsdy + dULDt[0]*dtdy;</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;            ULGradCart[1][1] = dULDr[1]*drdy + dULDs[1]*dsdy + dULDt[1]*dtdy;</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;            ULGradCart[2][1] = dULDr[2]*drdy + dULDs[2]*dsdy + dULDt[2]*dtdy;</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;            ULGradCart[3][1] = dULDr[3]*drdy + dULDs[3]*dsdy + dULDt[3]*dtdy;</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;            ULGradCart[4][1] = dULDr[4]*drdy + dULDs[4]*dsdy + dULDt[4]*dtdy;</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160; </div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;            ULGradCart[0][2] = dULDr[0]*drdz + dULDs[0]*dsdz + dULDt[0]*dtdz;</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;            ULGradCart[1][2] = dULDr[1]*drdz + dULDs[1]*dsdz + dULDt[1]*dtdz;</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;            ULGradCart[2][2] = dULDr[2]*drdz + dULDs[2]*dsdz + dULDt[2]*dtdz;</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;            ULGradCart[3][2] = dULDr[3]*drdz + dULDs[3]*dsdz + dULDt[3]*dtdz;</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;            ULGradCart[4][2] = dULDr[4]*drdz + dULDs[4]*dsdz + dULDt[4]*dtdz;</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160; </div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;            <span class="comment">/* Determine the normal gradients of all variables. */</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ULGradNorm[5];</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;            ULGradNorm[0] = ULGradCart[0][0]*normals[0] + ULGradCart[0][1]*normals[1] + ULGradCart[0][2]*normals[2];</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;            ULGradNorm[1] = ULGradCart[1][0]*normals[0] + ULGradCart[1][1]*normals[1] + ULGradCart[1][2]*normals[2];</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;            ULGradNorm[2] = ULGradCart[2][0]*normals[0] + ULGradCart[2][1]*normals[1] + ULGradCart[2][2]*normals[2];</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;            ULGradNorm[3] = ULGradCart[3][0]*normals[0] + ULGradCart[3][1]*normals[1] + ULGradCart[3][2]*normals[2];</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;            ULGradNorm[4] = ULGradCart[4][0]*normals[0] + ULGradCart[4][1]*normals[1] + ULGradCart[4][2]*normals[2];</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160; </div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;            <span class="comment">/* For the construction of the gradients of the right solution, also</span></div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;<span class="comment">               the Cartesian gradients and the normal gradient of the normal</span></div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;<span class="comment">               momentum is needed. This is computed below. */</span></div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> GradCartNormMomL[3];</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;            GradCartNormMomL[0] = ULGradCart[1][0]*normals[0] + ULGradCart[2][0]*normals[1] + ULGradCart[3][0]*normals[2];</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;            GradCartNormMomL[1] = ULGradCart[1][1]*normals[0] + ULGradCart[2][1]*normals[1] + ULGradCart[3][1]*normals[2];</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;            GradCartNormMomL[2] = ULGradCart[1][2]*normals[0] + ULGradCart[2][2]*normals[1] + ULGradCart[3][2]*normals[2];</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160; </div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> GradNormNormMomL = ULGradNorm[1]*normals[0]</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;                                             + ULGradNorm[2]*normals[1]</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;                                             + ULGradNorm[3]*normals[2];</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160; </div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;            <span class="comment">/* Abbreviate twice the normal vector. */</span></div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tnx = 2.0*normals[0], tny = 2.0*normals[1], tnz = 2.0*normals[2];</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160; </div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;            <span class="comment">/*--- Construct the gradients of the right solution. The tangential</span></div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;<span class="comment">                  gradients of the normal momentum and normal gradients of the other</span></div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;<span class="comment">                  variables, density, energy and tangential momentum, must be negated.</span></div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;<span class="comment">                  For the common situation that the symmetry plane coincides with an</span></div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;<span class="comment">                  x-, y- or z-plane this boils down to a multiplication by -1 or +1,</span></div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;<span class="comment">                  depending on the variable and gradient. However, the implementation</span></div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;<span class="comment">                  below is valid for an arbitrary orientation of the symmetry plane. ---*/</span></div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> URGradCart[5][3];</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;            URGradCart[0][0] = ULGradCart[0][0] - tnx*ULGradNorm[0];</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;            URGradCart[1][0] = ULGradCart[1][0] - tnx*ULGradNorm[1] - tnx*GradCartNormMomL[0] + tnx*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;            URGradCart[2][0] = ULGradCart[2][0] - tnx*ULGradNorm[2] - tny*GradCartNormMomL[0] + tnx*tny*GradNormNormMomL;</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;            URGradCart[3][0] = ULGradCart[3][0] - tnx*ULGradNorm[3] - tnz*GradCartNormMomL[0] + tnx*tnz*GradNormNormMomL;</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;            URGradCart[4][0] = ULGradCart[4][0] - tnx*ULGradNorm[4];</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160; </div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;            URGradCart[0][1] = ULGradCart[0][1] - tny*ULGradNorm[0];</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;            URGradCart[1][1] = ULGradCart[1][1] - tny*ULGradNorm[1] - tnx*GradCartNormMomL[1] + tny*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;            URGradCart[2][1] = ULGradCart[2][1] - tny*ULGradNorm[2] - tny*GradCartNormMomL[1] + tny*tny*GradNormNormMomL;</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;            URGradCart[3][1] = ULGradCart[3][1] - tny*ULGradNorm[3] - tnz*GradCartNormMomL[1] + tny*tnz*GradNormNormMomL;</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;            URGradCart[4][1] = ULGradCart[4][1] - tny*ULGradNorm[4];</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160; </div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;            URGradCart[0][2] = ULGradCart[0][2] - tnz*ULGradNorm[0];</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;            URGradCart[1][2] = ULGradCart[1][2] - tnz*ULGradNorm[1] - tnx*GradCartNormMomL[2] + tnz*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;            URGradCart[2][2] = ULGradCart[2][2] - tnz*ULGradNorm[2] - tny*GradCartNormMomL[2] + tnz*tny*GradNormNormMomL;</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;            URGradCart[3][2] = ULGradCart[3][2] - tnz*ULGradNorm[3] - tnz*GradCartNormMomL[2] + tnz*tnz*GradNormNormMomL;</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;            URGradCart[4][2] = ULGradCart[4][2] - tnz*ULGradNorm[4];</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160; </div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;            <span class="comment">/*--- Compute the viscous fluxes of the left and right state and average</span></div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;<span class="comment">                  them to compute the correct viscous flux for a symmetry boundary. ---*/</span></div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> wallDist = wallDistance ? wallDistance[i] : 0.0;</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> viscFluxL[5], viscFluxR[5];</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Viscosity, kOverCv;</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160; </div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;            ViscousNormalFluxIntegrationPoint_3D(UR, URGradCart, normals, 0.0, 1.0,</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;                                                 wallDist, lenScale_LES, Viscosity,</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;                                                 kOverCv, viscFluxR);</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;            ViscousNormalFluxIntegrationPoint_3D(UL, ULGradCart, normals, 0.0, 1.0,</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;                                                 wallDist, lenScale_LES, Viscosity,</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;                                                 kOverCv, viscFluxL);</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;            viscosityInt[nInt*llRel+i] = Viscosity;</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;            kOverCvInt[nInt*llRel+i]   = kOverCv;</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160; </div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscNormalFlux = viscFluxes + pointerOffset;</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;            viscNormalFlux[0] = 0.5*(viscFluxL[0] + viscFluxR[0]);</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;            viscNormalFlux[1] = 0.5*(viscFluxL[1] + viscFluxR[1]);</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;            viscNormalFlux[2] = 0.5*(viscFluxL[2] + viscFluxR[2]);</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;            viscNormalFlux[3] = 0.5*(viscFluxL[3] + viscFluxR[3]);</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;            viscNormalFlux[4] = 0.5*(viscFluxL[4] + viscFluxR[4]);</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;          }</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160; </div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;        }</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;      }</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;    }</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160; </div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;    <span class="comment">/* The remainder of the boundary condition treatment is the same for all</span></div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;<span class="comment">       types of boundary conditions, including the symmetry plane. The function</span></div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;<span class="comment">       ResidualViscousBoundaryFace will carry out this task. */</span></div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;    ResidualViscousBoundaryFace(config, conv_numerics, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;                                solIntL, solIntR, gradSolInt, fluxes, viscFluxes,</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;                                viscosityInt, kOverCvInt, resFaces, indResFaces);</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160; </div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;  }</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;}</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160; </div>
<div class="line"><a name="l05522"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a2c5840cbba7a0cf9048a5465eab883b4"> 5522</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a2c5840cbba7a0cf9048a5465eab883b4">CFEM_DG_NSSolver::BC_Supersonic_Outlet</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;                                            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;                                            <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;                                            <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray){</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160; </div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160; </div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160; </div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160; </div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160; </div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160; </div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160; </div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160; </div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160; </div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160; </div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;    <span class="comment">/* Set the right state in the integration points to the left state, i.e.</span></div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;<span class="comment">       no boundary condition is applied for a supersonic outlet. */</span></div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;(NPad*nInt); ++mm)</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;      solIntR[mm] = solIntL[mm];</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160; </div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;                                    indResFaces, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160; </div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;  }</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;}</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160; </div>
<div class="line"><a name="l05589"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a08d05db7c9f0a94dec17ab1eecd5c44d"> 5589</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a08d05db7c9f0a94dec17ab1eecd5c44d">CFEM_DG_NSSolver::BC_Inlet</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;                                <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;                                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;                                <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;                                <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;                                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray) {</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160; </div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160; </div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160; </div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160; </div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160; </div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160; </div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160; </div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160; </div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160; </div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160; </div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;    <span class="comment">/* Compute the right state by applying the subsonic inlet BC&#39;s. */</span></div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#af993f01423bbb8e24b8c2bb565bf55eb">BoundaryStates_Inlet</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160; </div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;                                    indResFaces, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160; </div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;  }</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;}</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160; </div>
<div class="line"><a name="l05655"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#afa7d6c1243dd1f7a29408f272c26b02d"> 5655</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#afa7d6c1243dd1f7a29408f272c26b02d">CFEM_DG_NSSolver::BC_Outlet</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;                                 <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;                                 <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;                                 <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray) {</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160; </div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160; </div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160; </div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160; </div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160; </div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160; </div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160; </div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160; </div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160; </div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160; </div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;    <span class="comment">/* Compute the right state by applying the subsonic outlet BC&#39;s. */</span></div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a3233306f97b6173c5c109cae04a4c9be">BoundaryStates_Outlet</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160; </div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;                                    indResFaces, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160; </div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;  }</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;}</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160; </div>
<div class="line"><a name="l05721"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#ac55acb75de727685caa05b9273267f8e"> 5721</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#ac55acb75de727685caa05b9273267f8e">CFEM_DG_NSSolver::BC_HeatFlux_Wall</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;                                        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;                                        <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;                                        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;                                        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray) {</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160; </div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;  <span class="comment">/* Set the factor for the wall velocity. For factWallVel = 0, the right state</span></div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;<span class="comment">     contains the wall velocity. For factWallVel = 1.0, the velocity of the</span></div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;<span class="comment">     right state is obtained by negating the interior velocity w.r.t. the</span></div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;<span class="comment">     velocity of the wall. */</span></div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factWallVel = 0.0;</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;  <span class="comment">// const su2double factWallVel = 1.0;</span></div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160; </div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;  <span class="comment">/* Get the wall heat flux. */</span></div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">string</span> Marker_Tag       = config-&gt;<a class="code" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Wall_HeatFlux = config-&gt;<a class="code" href="classCConfig.html#a61a5154012543ac7d95929ddc6b79950">GetWall_HeatFlux</a>(Marker_Tag);</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160; </div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160; </div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160; </div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160; </div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160; </div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160; </div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160; </div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160; </div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160; </div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160; </div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;    <span class="comment">/*--- Compute the right states. A distinction must be made whether or not</span></div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;<span class="comment">          all functions are used. ---*/</span></div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCFEM__DG__EulerSolver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[val_marker].wallModel ) {</div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160; </div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;      <span class="comment">/*--- Wall functions are used to model the lower part of the boundary</span></div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;<span class="comment">            layer. Consequently, a slip boundary condition is used for the</span></div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;<span class="comment">            velocities and the skin friction and heat flux from the wall</span></div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;<span class="comment">            should drive the velocities towards the no-slip and prescribed</span></div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;<span class="comment">            heat flux. Therefore the right states for the actual flow solver</span></div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;<span class="comment">            can be computed using BoundaryStates_Euler_Wall. ---*/</span></div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#a5d32e85923daf35ff0126d5f716ff9ec">BoundaryStates_Euler_Wall</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;                                solIntL, solIntR);</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;    }</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160; </div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;      <span class="comment">/*--- Integration to the wall is used, so the no-slip condition is enforced,</span></div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;<span class="comment">            albeit weakly. Loop over the number of faces in this chunk and the</span></div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;<span class="comment">            number of integration points and apply the heat flux wall boundary</span></div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;<span class="comment">            conditions to compute the right state. There are two options. Either</span></div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;<span class="comment">            the velocity is negated or it is set to zero. Some experiments are</span></div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;<span class="comment">            needed to see which formulation gives better results. ---*/</span></div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160; </div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160; </div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;          <span class="comment">/* Easier storage of the grid velocity and the left and right solution</span></div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;<span class="comment">             for this integration point. */</span></div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UL      = solIntL + NPad*i + llNVar;</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;                <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UR      = solIntR + NPad*i + llNVar;</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160; </div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;          <span class="comment">/* Set the right state. The initial value of the total energy is the</span></div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;<span class="comment">             energy of the left state. Also compute the difference in kinetic</span></div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;<span class="comment">             energy between the left and right state. */</span></div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;          UR[0]      = UL[0];</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;          UR[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = UL[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1];</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160; </div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> diffKin    = 0.0;</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velL = DensityInv*UL[iDim+1];</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dV   = factWallVel*(velL-gridVel[iDim]);</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;            <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velR = gridVel[iDim] - dV;</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160; </div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;            UR[iDim+1] = UR[0]*velR;</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;            diffKin   += velL*velL - velR*velR;</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;          }</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160; </div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;          <span class="comment">/* As only the internal energy of UR is equal to UL, the difference</span></div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;<span class="comment">             in kinetic energy must be subtracted. */</span></div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;          UR[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] -= 0.5*UR[0]*diffKin;</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;        }</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;      }</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;    }</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160; </div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;                                    Wall_HeatFlux, <span class="keyword">true</span>, 0.0, <span class="keyword">false</span>,</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;                                    &amp;surfElem[l], solIntL, solIntR,</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;                                    work, resFaces, indResFaces,</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;                                    <a class="code" href="classCFEM__DG__EulerSolver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[val_marker].wallModel);</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160; </div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;  }</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;}</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160; </div>
<div class="line"><a name="l05853"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#aea70aaab1228b018aab7f2d588de9704"> 5853</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#aea70aaab1228b018aab7f2d588de9704">CFEM_DG_NSSolver::BC_Isothermal_Wall</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;                                          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;                                          <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;                                          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;                                          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray) {</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160; </div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;  <span class="comment">/* Set the factor for the wall velocity. For factWallVel = 0, the right state</span></div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;<span class="comment">     contains the wall velocity. For factWallVel = 1.0, the velocity of the</span></div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;<span class="comment">     right state is obtained by negating the interior velocity w.r.t. the</span></div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;<span class="comment">     velocity of the wall. */</span></div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> factWallVel = 0.0;</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;  <span class="comment">// const su2double factWallVel = 1.0;</span></div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160; </div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;  <span class="comment">/* Get the wall temperature. */</span></div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> TWall   = config-&gt;<a class="code" href="classCConfig.html#a2bf56370670128e9e93af4ed3a7e2bb7">GetIsothermal_Temperature</a>(Marker_Tag)/config-&gt;<a class="code" href="classCConfig.html#a218d027f78cd801a8734a2d4581591ad">GetTemperature_Ref</a>();</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160; </div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;  <span class="comment">/* Compute the prescribed value of the energy (per unit mass). */</span></div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant = config-&gt;<a class="code" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Cv           = Gas_Constant/<a class="code" href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> StaticEnergy = Cv*TWall;</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160; </div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160; </div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160; </div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160; </div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160; </div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160; </div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160; </div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160; </div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160; </div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160; </div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;    <span class="comment">/*--- Integration to the wall is used, so the no-slip condition is enforced,</span></div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;<span class="comment">          albeit weakly. Loop over the number of faces in this chunk and the</span></div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;<span class="comment">          number of integration points and apply the isothermal wall boundary</span></div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;<span class="comment">          conditions to compute the right state. There are two options. Either</span></div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;<span class="comment">          the velocity is negated or it is set to zero. Some experiments are</span></div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;<span class="comment">          needed to see which formulation gives better results. ---*/</span></div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160; </div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160; </div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;         <span class="comment">/* Easier storage of the grid velocity and the left and right solution</span></div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;<span class="comment">           for this integration point. */</span></div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = surfElem[lll].<a class="code" href="structCSurfaceElementFEM.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UL      = solIntL + NPad*i + llNVar;</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;              <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UR      = solIntR + NPad*i + llNVar;</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160; </div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;        <span class="comment">/* Set the right state for the density and the momentum variables of the</span></div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;<span class="comment">           right state. Compute twice the possible kinetic energy. */</span></div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;        UR[0] = UL[0];</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kinEner    = 0.0;</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velL = DensityInv*UL[iDim+1];</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dV   = factWallVel*(velL-gridVel[iDim]);</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velR = gridVel[iDim] - dV;</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160; </div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;          UR[iDim+1] = UR[0]*velR;</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;          kinEner   += velR*velR;</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;        }</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160; </div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;        <span class="comment">/* Compute the total energy of the right state. */</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;        UR[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = UR[0]*(StaticEnergy + 0.5*kinEner);</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;      }</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;    }</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160; </div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;                                    0.0, <span class="keyword">false</span>, TWall, <span class="keyword">true</span>,</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;                                    &amp;surfElem[l], solIntL, solIntR,</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;                                    work, resFaces, indResFaces,</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;                                    <a class="code" href="classCFEM__DG__EulerSolver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[val_marker].wallModel);</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160; </div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;  }</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;}</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160; </div>
<div class="line"><a name="l05970"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#a22b8079ccea001f1a35d236bfb2750d4"> 5970</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#a22b8079ccea001f1a35d236bfb2750d4">CFEM_DG_NSSolver::BC_Riemann</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;                                  <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;                                  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray) {</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160; </div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160; </div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160; </div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160; </div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160; </div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160; </div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160; </div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160; </div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160; </div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160; </div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;    <span class="comment">/* Compute the right state by applying the Riemann BC&#39;s. */</span></div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a5bfdc0bca1daa8e5d716d4fc3c7f5867">BoundaryStates_Riemann</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160; </div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;                                    solIntL, solIntR, work,</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;                                    resFaces, indResFaces, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160; </div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;  }</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;}</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160; </div>
<div class="line"><a name="l06036"></a><span class="lineno"><a class="line" href="classCFEM__DG__NSSolver.html#acd2193a119fc1162909b554e8acf11b2"> 6036</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCFEM__DG__NSSolver.html#acd2193a119fc1162909b554e8acf11b2">CFEM_DG_NSSolver::BC_Custom</a>(<a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;                                 <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;                                 <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;                                 <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *workArray) {</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160; </div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160; </div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160; </div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a>);</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160; </div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;  <span class="comment">/*--- Get the physical time if necessary. ---*/</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> time = 0.0;</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#ac47e04d76ce865893a94dcedd3c9b6a5">GetTime_Marching</a>() != <a class="code" href="option__structure_8hpp.html#a75d7083b30c2dd99c3f11ddb57226342ad1e7fb475a6de2107e56a5d516df332d">TIME_MARCHING::STEADY</a>) time = config-&gt;<a class="code" href="classCConfig.html#a4f4842f072c0484236e776956ff41cbb">GetPhysicalTime</a>();</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160; </div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160; </div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160; </div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160; </div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160; </div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160; </div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160; </div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;    <span class="comment">/* Check for a verification solution. */</span></div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a> ) {</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160; </div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;      <span class="comment">/*--- Loop over the number of simultaneously treated faces and integration points</span></div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;<span class="comment">            to compute the right state for the boundary conditions. ---*/</span></div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160; </div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;          <span class="comment">/* Determine the pointer to the coordinates of this integration</span></div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;<span class="comment">             point and the pointer to the solution and call the function</span></div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;<span class="comment">             GetBCState to determine the actual boundary state. */</span></div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;          <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *coor = surfElem[ll+l].<a class="code" href="structCSurfaceElementFEM.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data() + i*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;          <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *UR   = solIntR + NPad*i + ll*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160; </div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;          <a class="code" href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">VerificationSolution</a>-&gt;<a class="code" href="classCVerificationSolution.html#ab198a62147ee10d352830627e3d5017e">GetBCState</a>(coor, time, UR);</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;        }</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;      }</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;    }</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160; </div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;      <span class="comment">/* The user must specify the custom BC&#39;s here. */</span></div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;      <a class="code" href="classCBaseMPIWrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Implement customized boundary conditions here.&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;    }</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160; </div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160; </div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;                                    solIntL, solIntR, work,</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;                                    resFaces, indResFaces, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160; </div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;  }</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;}</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160; </div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ViscousBoundaryFacesBCTreatment(</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;                                       <a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;                                       <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          Wall_HeatFlux,</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span>               HeatFlux_Prescribed,</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          Wall_Temperature,</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span>               Temperature_Prescribed,</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *solIntL,</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *solIntR,</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;                                             <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *workArray,</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;                                             <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *resFaces,</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;                                             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      &amp;indResFaces,</div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;                                             <a class="code" href="classCWallModel.html">CWallModel</a>         *wallModel) {</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160; </div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;  <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;<span class="comment">        for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind       = surfElem[0].<a class="code" href="structCSurfaceElementFEM.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt      = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *derBasisElem  = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#abd2f5656593a34508bdfb2093a1d6f92">GetMatDerBasisElemIntegration</a>();</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160; </div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;  <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscosityInt = workArray;</div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *kOverCvInt   = viscosityInt + nFaceSimul*nInt;</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gradSolInt   = kOverCvInt   + nFaceSimul*nInt;</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *fluxes       = gradSolInt   + NPad*nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *viscFluxes   = fluxes       + NPad*max(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, (<span class="keywordtype">int</span>) nDOFsElem);</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160; </div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;  <span class="comment">/* Compute the viscous fluxes in the integration points of the faces that</span></div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;<span class="comment">     are treated simulaneously. Make a distinction between a wall function</span></div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;<span class="comment">     treatment and a standard computation of the viscous fluxes. */</span></div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;  <span class="keywordflow">if</span>( wallModel ) {</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;    WallTreatmentViscousFluxes(config, nFaceSimul, NPad, nInt, Wall_HeatFlux,</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;                               HeatFlux_Prescribed, Wall_Temperature,</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;                               Temperature_Prescribed, surfElem, solIntL,</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;                               gradSolInt, viscFluxes, viscosityInt,</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;                               kOverCvInt, wallModel);</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;  }</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;    ComputeViscousFluxesBoundaryFaces(config, nFaceSimul, NPad, nInt, nDOFsElem,</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;                                      Wall_HeatFlux, HeatFlux_Prescribed,</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;                                      derBasisElem, surfElem, solIntL,</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;                                      fluxes, gradSolInt, viscFluxes,</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;                                      viscosityInt, kOverCvInt);</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;  }</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160; </div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;  <span class="comment">/* The remainder of the boundary condition treatment is the same for all</span></div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;<span class="comment">     types of boundary conditions, including the symmetry plane and the</span></div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;<span class="comment">     wall function treatment. The function ResidualViscousBoundaryFace will</span></div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;<span class="comment">     carry out this task. */</span></div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160; </div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;  ResidualViscousBoundaryFace(config, conv_numerics, nFaceSimul, NPad, surfElem,</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;                              solIntL, solIntR, gradSolInt, fluxes, viscFluxes,</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;                              viscosityInt, kOverCvInt, resFaces, indResFaces);</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;}</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160; </div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ComputeViscousFluxesBoundaryFaces(</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;                                       <a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nInt,</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nDOFsElem,</div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          Wall_HeatFlux,</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span>               HeatFlux_Prescribed,</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *derBasisElem,</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *solIntL,</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;                                             <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *solElem,</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;                                             <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *gradSolInt,</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;                                             <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *viscFluxes,</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;                                             <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *viscosityInt,</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;                                             <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *kOverCvInt) {</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160; </div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;  <span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;  <span class="comment">/*--- Step 1: Compute the gradients of the conservative variables in the  ---*/</span></div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;  <span class="comment">/*---         integration points of the faces.                            ---*/</span></div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;  <span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160; </div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;  <span class="comment">/* Loop over the simultaneously treated faces to set the solution of the elements. */</span></div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160; </div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;    <span class="comment">/* Determine the offset that must be applied to access the correct data for</span></div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;<span class="comment">       this element in the working vector of the solution. Per definition the</span></div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;<span class="comment">       boundary face has the same time level as the adjacent element, hence</span></div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;<span class="comment">       offsetDOFsSolThisTimeLevel is used. */</span></div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID     = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="classCVolumeElementFEM.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset     = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;                                   - <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160; </div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;    <span class="comment">/* Loop over the DOFs of the element and copy the solution to the appropriate</span></div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;<span class="comment">       position in solElem. */</span></div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFsElem = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#abdf9f21e0435e853d60d7faeecbb5e2f">DOFsSolElement</a>.data();</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem; ++i) {</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOF = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;                              + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFsElem[i] - offset);</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>       *sol    = solElem + NPad*i + llNVar;</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;        sol[mm] = solDOF[mm];</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;    }</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;  }</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160; </div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;  <span class="comment">/* Compute the gradients in the integration points. Call the general function to</span></div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;<span class="comment">     carry out the matrix product. */</span></div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem, derBasisElem, solElem, gradSolInt, config);</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160; </div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;  <span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;  <span class="comment">/*--- Step 2: Compute the viscous normal fluxes in the integration points ---*/</span></div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;  <span class="comment">/*---         of the faces.                                               ---*/</span></div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;  <span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160; </div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;  <span class="comment">/* Loop over the simultaneously treated faces. */</span></div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160; </div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;    <span class="comment">/* Determine the ID of the adjacent element. */</span></div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160; </div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;    <span class="comment">/* Call the general function to compute the viscous flux in normal</span></div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;<span class="comment">       direction for the face. */</span></div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;    ViscousNormalFluxFace(&amp;<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID], l, nInt, NPad, Wall_HeatFlux,</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;                          HeatFlux_Prescribed, solIntL, gradSolInt,</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;                          surfElem[l].metricCoorDerivFace.data(),</div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;                          surfElem[l].metricNormalsFace.data(),</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;                          surfElem[l].<a class="code" href="classCVolumeElementFEM.html#abcd8ed2e51e1429b0f164086419a40ff">wallDistance</a>.data(),</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;                          viscFluxes, viscosityInt, kOverCvInt);</div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;  }</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;}</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160; </div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::WallTreatmentViscousFluxes(</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;                                  <a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nInt,</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          Wall_HeatFlux,</div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">bool</span>               HeatFlux_Prescribed,</div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          Wall_Temperature,</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">bool</span>               Temperature_Prescribed,</div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *solIntL,</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;                                        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *workArray,</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;                                        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *viscFluxes,</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;                                        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *viscosityInt,</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;                                        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *kOverCvInt,</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;                                        <a class="code" href="classCWallModel.html">CWallModel</a>         *wallModel) {</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160; </div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;  <span class="comment">/* Loop over the simultaneously treated faces. */</span></div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160; </div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;    <span class="comment">/* Loop over the donors for this boundary face. */</span></div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a7a048944dcc446cbc2fc2128bfa425cc">donorsWallFunction</a>.size(); ++j) {</div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160; </div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;      <span class="comment">/* Easier storage of the element ID of the donor and set the pointer</span></div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;<span class="comment">         where the solution of this element starts. Note that by construction</span></div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;<span class="comment">         the time level of the donor element is the same as the time level</span></div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;<span class="comment">         of the boundary face. */</span></div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> donorID    = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a7a048944dcc446cbc2fc2128bfa425cc">donorsWallFunction</a>[j];</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="classCVolumeElementFEM.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solDOFsElem   = <a class="code" href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;                                     + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160; </div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;      <span class="comment">/* Determine the number of integration points for this donor and</span></div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;<span class="comment">         interpolate the solution for the corresponding exchange points. */</span></div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nIntThisDonor = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j+1]</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;                                         - surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j];</div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160; </div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;      <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nIntThisDonor, <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, nDOFsElem, surfElem[l].matWallFunctionDonor[j].data(),</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;                          solDOFsElem, workArray, config);</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160; </div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;      <span class="comment">/* Loop over the integration points for this donor element. */</span></div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=surfElem[l].nIntPerWallFunctionDonor[j];</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;                         i&lt;surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j+1]; ++i) {</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160; </div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;        <span class="comment">/* Easier storage of the actual integration point. */</span></div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aa6f58573b6ae42747d3e98e1497d76f1">intPerWallFunctionDonor</a>[i];</div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160; </div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;        <span class="comment">/* Determine the normal and the wall velocity for this integration point. */</span></div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normals = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + ii*(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *gridVel = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + ii*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160; </div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;        <span class="comment">/* Determine the velocities and pressure in the exchange point. */</span></div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solInt = workArray</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;                                + <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(i-surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j]);</div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160; </div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> rhoInv = 1.0/solInt[0];</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel[]  = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k] = rhoInv*solInt[k+1];</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160; </div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> vel2Mag = vel[0]*vel[0] + vel[1]*vel[1] + vel[2]*vel[2];</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> eInt    = rhoInv*solInt[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] - 0.5*vel2Mag;</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160; </div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;        <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">SetTDState_rhoe</a>(solInt[0], eInt);</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Pressure = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">GetPressure</a>();</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Temperature = <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ab7651562ac98477a1f3ae39832a4ffb1">GetTemperature</a>();</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> LaminarViscosity= <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160; </div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;        <span class="comment">/* Subtract the prescribed wall velocity, i.e. grid velocity</span></div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;<span class="comment">           from the velocity in the exchange point. */</span></div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k] -= gridVel[k];</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160; </div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;        <span class="comment">/* Determine the tangential velocity by subtracting the normal</span></div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;<span class="comment">           velocity component. */</span></div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velNorm = 0.0;</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) velNorm += normals[k]*vel[k];</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k]  -= normals[k]*velNorm;</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160; </div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;        <span class="comment">/* Determine the magnitude of the tangential velocity as well</span></div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;<span class="comment">           as its direction (unit vector). */</span></div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velTan = <a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(vel[0]*vel[0] + vel[1]*vel[1] + vel[2]*vel[2]);</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;        velTan = max(velTan,1.e-25);</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160; </div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dirTan[] = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) dirTan[k] = vel[k]/velTan;</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160; </div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;        <span class="comment">/* Compute the wall shear stress and heat flux vector using</span></div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;<span class="comment">           the wall model. */</span></div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> tauWall, qWall, ViscosityWall, kOverCvWall;</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160; </div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;        wallModel-&gt;<a class="code" href="classCWallModel.html#aa97d804c3e84dddab5c3e16b5996b16a">WallShearStressAndHeatFlux</a>(Temperature, velTan, LaminarViscosity, Pressure,</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;                                              Wall_HeatFlux, HeatFlux_Prescribed,</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;                                              Wall_Temperature, Temperature_Prescribed,</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;                                              <a class="code" href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>, tauWall, qWall, ViscosityWall,</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;                                              kOverCvWall);</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160; </div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;        <span class="comment">/* Compute the wall velocity in tangential direction. */</span></div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;        <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *solWallInt = solIntL + NPad*ii + llNVar;</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> velWallTan = 0.0;</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k)</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;          velWallTan += solWallInt[k+1]*dirTan[k];</div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;        velWallTan /= solWallInt[0];</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160; </div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;        <span class="comment">/* Determine the position where the viscous fluxes, viscosity and</span></div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;<span class="comment">           thermal conductivity must be stored. */</span></div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;        <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *normalFlux = viscFluxes + NPad*ii + llNVar;</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160; </div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = l*nInt + ii;</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;        viscosityInt[ind] = ViscosityWall;</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;        kOverCvInt[ind]   = kOverCvWall;</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160; </div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;        <span class="comment">/* Compute the viscous normal flux. Note that the unscaled normals</span></div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;<span class="comment">           must be used, hence the multiplication with normals[nDim]. */</span></div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;        normalFlux[0] = 0.0;</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k)</div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;          normalFlux[k+1] = -normals[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*tauWall*dirTan[k];</div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;        normalFlux[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] = normals[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*(qWall - tauWall*velWallTan);</div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;      }</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;    }</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;  }</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;}</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160; </div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ResidualViscousBoundaryFace(</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;                                      <a class="code" href="classCConfig.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;                                      <a class="code" href="classCNumerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *solInt0,</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *solInt1,</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;                                      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *paramFluxes,</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;                                      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *fluxes,</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;                                      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *viscFluxes,</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *viscosityInt,</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>          *kOverCvInt,</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;                                      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>                *resFaces,</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>            &amp;indResFaces) {</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160; </div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;  <span class="comment">/*--- Get the required information from the standard element, which is the</span></div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;<span class="comment">        same for all faces considered. ---*/</span></div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind          = surfElem[0].<a class="code" href="structCSurfaceElementFEM.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt         = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs        = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem    = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>      ConstPenFace = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#aa2e4984684567bfa78f6556ad41a7c9c">GetPenaltyConstant</a>();</div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>     *weights      = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160; </div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;  <span class="comment">/*--- Step 1: Compute the sum of the inviscid, viscous and penalty     ---*/</span></div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;  <span class="comment">/*---         fluxes in the integration points of the faces.           ---*/</span></div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160; </div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;  <span class="comment">/* Store the normals and grid velocities of the faces in an array of</span></div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;<span class="comment">     pointers to be used in the call to ComputeInviscidFluxesFace. */</span></div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* arrNorm[<a class="code" href="CFEM__DG__NSSolver_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>];</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* arrGridVel[<a class="code" href="CFEM__DG__NSSolver_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>];</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160; </div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;  <span class="keywordflow">if</span>(nFaceSimul &gt; <a class="code" href="CFEM__DG__NSSolver_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>)</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;    <a class="code" href="classCBaseMPIWrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;SIZE_ARR_NORM is too small. Increase it or decrease ALIGNED_BYTES_MATMUL&quot;</span>,</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;                   <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160; </div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;    arrNorm[l]    = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data();</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;    arrGridVel[l] = surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data();</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;  }</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160; </div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;  <span class="comment">/* General function to compute the inviscid fluxes, using an approximate</span></div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;<span class="comment">     Riemann solver in the integration points. */</span></div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#a4851d39829e12202592d85c36ea36489">ComputeInviscidFluxesFace</a>(config, nFaceSimul, NPad, nInt, arrNorm, arrGridVel,</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;                            solInt0, solInt1, fluxes, conv_numerics);</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160; </div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;  <span class="comment">/* Subtract the viscous fluxes from the inviscid fluxes. */</span></div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] -= viscFluxes[j];</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160; </div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;  <span class="comment">/*--- Loop over the faces in this chunk to compute the penalty fluxes. ---*/</span></div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160; </div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;    <span class="comment">/* Get the length scale for the adjacent element. */</span></div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> lenScale = <a class="code" href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[surfElem[l].<a class="code" href="structCSurfaceElementFEM.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>].<a class="code" href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160; </div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;    <span class="comment">/* Call the function PenaltyTermsFluxFace to compute the actual penalty</span></div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;<span class="comment">       terms. Use the array viscFluxes as storage. */</span></div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;    PenaltyTermsFluxFace(l, nInt, NPad, solInt0, solInt1, viscosityInt,</div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;                         viscosityInt, kOverCvInt, kOverCvInt, ConstPenFace,</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;                         lenScale, lenScale, surfElem[l].metricNormalsFace.data(),</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;                         viscFluxes);</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;  }</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160; </div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;  <span class="comment">/* Add the penalty fluxes to the earlier computed fluxes. */</span></div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] += viscFluxes[j];</div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160; </div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;  <span class="comment">/* Multiply the fluxes with the integration weight of the corresponding</span></div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;<span class="comment">     integration point. */</span></div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *flux = fluxes + i*NPad;</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160; </div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;NPad; ++j)</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;      flux[j] *= weights[i];</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;  }</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160; </div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;  <span class="comment">/*--- Step 2: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;  <span class="comment">/*---         integration over the surface element of the invisid      ---*/</span></div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;  <span class="comment">/*---         fluxes, viscous fluxes and penalty terms.                ---*/</span></div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160; </div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;  <span class="comment">/* Set the value of the offset of the residual between each of the</span></div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;<span class="comment">     faces. This depends whether or not symmetrizing terms are stored.</span></div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;<span class="comment">     Also set the location where the symmetrizing terms of the first face</span></div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;<span class="comment">     must be stored. */</span></div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offsetRes = nDOFs;</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classCFEM__DG__EulerSolver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) offsetRes += nDOFsElem;</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160; </div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResSym = indResFaces + nDOFs;</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160; </div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;  <span class="comment">/* Get the correct form of the basis functions needed for the matrix</span></div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;<span class="comment">     multiplication to compute the residual. */</span></div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;  <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *basisFaceTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#a35b1e9f96cb19c91da19c7a30596a128">GetBasisFaceIntegrationTranspose</a>();</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160; </div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;  <span class="comment">/* Call the general function to carry out the matrix product. Use viscFluxes</span></div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;<span class="comment">     as temporary storage for the result. */</span></div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;  <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFs, NPad, nInt, basisFaceTrans, fluxes, viscFluxes, config);</div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160; </div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;  <span class="comment">/* Loop over the number of faces in this chunk to store the residual in</span></div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;<span class="comment">     the correct locations in resFaces. */</span></div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160; </div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;    <span class="comment">/* Easier storage of the position in the residual array for this face</span></div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;<span class="comment">       and update the corresponding counter. */</span></div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;    <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *resFace = resFaces + indResFaces*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;    indResFaces       += offsetRes;</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160; </div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;    <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;        resFace[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i+mm] = viscFluxes[NPad*i+llNVar+mm];</div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;  }</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160; </div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;  <span class="comment">/*--- Step 3: Compute and distribute the symmetrizing terms, if        ---*/</span></div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;  <span class="comment">/*---         present. Note that these terms must be distributed to    ---*/</span></div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;  <span class="comment">/*---         DOFs of the adjacent element, not only of the face.      ---*/</span></div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160; </div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classCFEM__DG__EulerSolver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) {</div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160; </div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;    <span class="comment">/* The symmetrizing fluxes will be multiplied by 0.5 times the theta</span></div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;<span class="comment">       parameter. Store this factor a bit easier. */</span></div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> halfTheta = 0.5*config-&gt;<a class="code" href="classCConfig.html#a1c1aa8ce41b9bfffea9cbf502ad08188">GetTheta_Interior_Penalty_DGFEM</a>();</div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160; </div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;    <span class="comment">/* Loop over the simultaneously treated faces. */</span></div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160; </div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;      <span class="comment">/* Compute the symmetrizing fluxes in the nDim directions. */</span></div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;      SymmetrizingFluxesFace(l, nInt, NPad, solInt0, solInt1, viscosityInt,</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;                             viscosityInt, kOverCvInt, kOverCvInt,</div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;                             surfElem[l].metricNormalsFace.data(), fluxes);</div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160; </div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;      <span class="comment">/* Transform the fluxes, such that they must be multiplied with the</span></div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;<span class="comment">         gradients w.r.t. the parametric coordinates rather than the</span></div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;<span class="comment">         Cartesian coordinates of the basis functions. Also a multiplication</span></div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;<span class="comment">         with the integration weight and the theta parameter is carried out. */</span></div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;      TransformSymmetrizingFluxes(l, nInt, NPad, halfTheta, fluxes, weights,</div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;                                  surfElem[l].metricCoorDerivFace.data(),</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;                                  paramFluxes);</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;    }</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160; </div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product to compute</span></div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;<span class="comment">       the residual. Use fluxes as temporary storage for the result. */</span></div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;    <span class="keyword">const</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *derBasisElemTrans = <a class="code" href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="classCFEMStandardBoundaryFace.html#af871727fdb40d29be27a7107571be421">GetMatDerBasisElemIntegrationTranspose</a>();</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160; </div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;    <a class="code" href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">gemm</a>(nDOFsElem, NPad, nInt*<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, derBasisElemTrans, paramFluxes, fluxes, config);</div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160; </div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;    <span class="comment">/* Loop over the faces of this chunk to store the residual in</span></div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;<span class="comment">       the correct locations in resFaces. */</span></div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160; </div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;      <span class="comment">/* Easier storage of the position in the residual array for this face</span></div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;<span class="comment">         and update the corresponding counter. */</span></div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;      <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *resElem = resFaces + indResSym*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;      indResSym         += offsetRes;</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160; </div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;      <span class="comment">/* Loop over the DOFs of the element and copy the data. */</span></div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem; ++i)</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mm=0; mm&lt;<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++mm)</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;          resElem[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i+mm] = fluxes[NPad*i+llNVar+mm];</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;    }</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;  }</div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977a2fd33892864d1c342d3bead2f2d9ad56"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a2fd33892864d1c342d3bead2f2d9ad56">TRIANGLE</a></div><div class="ttdeci">@ TRIANGLE</div><div class="ttdoc">VTK nomenclature for defining a triangle element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00128">option_structure.hpp:128</a></div></div>
<div class="ttc" id="aclassCFEMStandardElement_html_ac5299da576559652cc910b91541b243b"><div class="ttname"><a href="classCFEMStandardElement.html#ac5299da576559652cc910b91541b243b">CFEMStandardElement::GetMatDerBasisFunctionsSolDOFs</a></div><div class="ttdeci">const su2double * GetMatDerBasisFunctionsSolDOFs(void) const</div><div class="ttdoc">Function, which makes available the matrix storage of the derivative of the basis functions in the so...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l00968">fem_standard_element.hpp:968</a></div></div>
<div class="ttc" id="aclassCConfig_html_a82d3faf3154d13bf694af4d818ef91c7"><div class="ttname"><a href="classCConfig.html#a82d3faf3154d13bf694af4d818ef91c7">CConfig::GetSizeMatMulPadding</a></div><div class="ttdeci">unsigned short GetSizeMatMulPadding(void) const</div><div class="ttdoc">Function to make available the matrix size in vectorization in order to optimize the gemm performance...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l09022">CConfig.hpp:9022</a></div></div>
<div class="ttc" id="aclassCVerificationSolution_html_acb2e19001e55c60e498be21ff5c8a085"><div class="ttname"><a href="classCVerificationSolution.html#acb2e19001e55c60e498be21ff5c8a085">CVerificationSolution::GetMMSSourceTerm</a></div><div class="ttdeci">virtual void GetMMSSourceTerm(const su2double *val_coords, const su2double val_t, su2double *val_source) const</div><div class="ttdoc">Get the source term for the manufactured solution (MMS).</div><div class="ttdef"><b>Definition:</b> <a href="CVerificationSolution_8cpp_source.html#l00110">CVerificationSolution.cpp:110</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_aca2a1ae12ad274b8c2494ffb69bd73f1"><div class="ttname"><a href="classCVolumeElementFEM.html#aca2a1ae12ad274b8c2494ffb69bd73f1">CVolumeElementFEM::offsetDOFsSolPrevTimeLevel</a></div><div class="ttdeci">unsigned long offsetDOFsSolPrevTimeLevel</div><div class="ttdoc">Local offset of the solution DOFs of this element in the working vector of the previous time level.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00229">fem_geometry_structure.hpp:229</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_ab7546cb31b73191bbac2b338c88cfbc4"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#ab7546cb31b73191bbac2b338c88cfbc4">CFEM_DG_EulerSolver::InviscidFluxesInternalMatchingFace</a></div><div class="ttdeci">void InviscidFluxesInternalMatchingFace(CConfig *config, const unsigned long lBeg, const unsigned long lEnd, const unsigned short NPad, su2double *solIntL, su2double *solIntR, su2double *fluxes, CNumerics *numerics)</div><div class="ttdoc">Function, which computes the inviscid fluxes in the face integration points of a chunk of matching in...</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8cpp_source.html#l06394">CFEM_DG_EulerSolver.cpp:6394</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_a69fdb86db7c5b6ac05be11490c3696b5"><div class="ttname"><a href="structCSurfaceElementFEM.html#a69fdb86db7c5b6ac05be11490c3696b5">CSurfaceElementFEM::wallDistance</a></div><div class="ttdeci">vector&lt; su2double &gt; wallDistance</div><div class="ttdoc">The wall distances of the integration points of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00387">fem_geometry_structure.hpp:387</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a672104ec690d1efa0e99d3d527264ef4"><div class="ttname"><a href="classCVolumeElementFEM.html#a672104ec690d1efa0e99d3d527264ef4">CVolumeElementFEM::metricTerms</a></div><div class="ttdeci">vector&lt; su2double &gt; metricTerms</div><div class="ttdoc">Vector of the metric terms in the integration points of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00245">fem_geometry_structure.hpp:245</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a7924707aed377b385c0cd7019ae1ef71"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a7924707aed377b385c0cd7019ae1ef71">CFEM_DG_EulerSolver::Total_CMz</a></div><div class="ttdeci">su2double Total_CMz</div><div class="ttdoc">Total z moment coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00104">CFEM_DG_EulerSolver.hpp:104</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_af993f01423bbb8e24b8c2bb565bf55eb"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#af993f01423bbb8e24b8c2bb565bf55eb">CFEM_DG_EulerSolver::BoundaryStates_Inlet</a></div><div class="ttdeci">void BoundaryStates_Inlet(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, unsigned short val_marker, const su2double *solIntL, su2double *solIntR)</div><div class="ttdoc">Function, which computes the boundary states in the integration points of the boundary face by applyi...</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8cpp_source.html#l07547">CFEM_DG_EulerSolver.cpp:7547</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_adcd6c309300a05665a4a738ec400e264"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#adcd6c309300a05665a4a738ec400e264">CFEM_DG_EulerSolver::standardBoundaryFacesSol</a></div><div class="ttdeci">const CFEMStandardBoundaryFace * standardBoundaryFacesSol</div><div class="ttdoc">Array that contains the standard boundary faces used for the solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00155">CFEM_DG_EulerSolver.hpp:155</a></div></div>
<div class="ttc" id="aclassCVerificationSolution_html_ab198a62147ee10d352830627e3d5017e"><div class="ttname"><a href="classCVerificationSolution.html#ab198a62147ee10d352830627e3d5017e">CVerificationSolution::GetBCState</a></div><div class="ttdeci">virtual void GetBCState(const su2double *val_coords, const su2double val_t, su2double *val_solution) const</div><div class="ttdoc">Get the boundary conditions state for an exact solution.</div><div class="ttdef"><b>Definition:</b> <a href="CVerificationSolution_8cpp_source.html#l00103">CVerificationSolution.cpp:103</a></div></div>
<div class="ttc" id="aclassCSolver_html_a3b566efc4c362c24f244094aed7577a2"><div class="ttname"><a href="classCSolver.html#a3b566efc4c362c24f244094aed7577a2">CSolver::VerificationSolution</a></div><div class="ttdeci">CVerificationSolution * VerificationSolution</div><div class="ttdoc">Verification solution class used within the solver.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00205">CSolver.hpp:205</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0abcea8fd4c94005a730427882d6e1d0a6a2d09f749cfe603633b071dbecf4a7f"><div class="ttname"><a href="option__structure_8hpp.html#a0abcea8fd4c94005a730427882d6e1d0a6a2d09f749cfe603633b071dbecf4a7f">TURB_SGS_MODEL::SMAGORINSKY</a></div><div class="ttdeci">@ SMAGORINSKY</div><div class="ttdoc">Smagorinsky SGS model.</div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_abcd8ed2e51e1429b0f164086419a40ff"><div class="ttname"><a href="classCVolumeElementFEM.html#abcd8ed2e51e1429b0f164086419a40ff">CVolumeElementFEM::wallDistance</a></div><div class="ttdeci">vector&lt; su2double &gt; wallDistance</div><div class="ttdoc">The wall distance to the viscous walls for the integration points of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00264">fem_geometry_structure.hpp:264</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a6f734d2019596d01b1a7bfad33a96d47af19f3665dab8ceb999b7b0a1e972e332"><div class="ttname"><a href="option__structure_8hpp.html#a6f734d2019596d01b1a7bfad33a96d47af19f3665dab8ceb999b7b0a1e972e332">FEM_SHOCK_CAPTURING_DG::PERSSON</a></div><div class="ttdeci">@ PERSSON</div><div class="ttdoc">Per-Olof Persson's sub-cell shock capturing method.</div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_acd4208ae47226c5917479d6a232b7584"><div class="ttname"><a href="classCFEMStandardInternalFace.html#acd4208ae47226c5917479d6a232b7584">CFEMStandardInternalFace::GetNDOFsFaceSide0</a></div><div class="ttdeci">unsigned short GetNDOFsFaceSide0(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs on side 0 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01488">fem_standard_element.hpp:1488</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a6d2d005c8472c1437afd3a1846467421"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a6d2d005c8472c1437afd3a1846467421">CFEM_DG_EulerSolver::ConsVarFreeStream</a></div><div class="ttdeci">vector&lt; su2double &gt; ConsVarFreeStream</div><div class="ttdoc">Vector, which contains the free stream conservative variables.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00056">CFEM_DG_EulerSolver.hpp:56</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a2e1ebd88419fba439acdfb1524915ab5"><div class="ttname"><a href="classCVolumeElementFEM.html#a2e1ebd88419fba439acdfb1524915ab5">CVolumeElementFEM::lenScale</a></div><div class="ttdeci">su2double lenScale</div><div class="ttdoc">Length scale of the element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00239">fem_geometry_structure.hpp:239</a></div></div>
<div class="ttc" id="avector__expressions_8hpp_html_a3cb1f15360cf9dcc531a72e558b3cffa"><div class="ttname"><a href="vector__expressions_8hpp.html#a3cb1f15360cf9dcc531a72e558b3cffa">u</a></div><div class="ttdeci">store_t&lt; const U &gt; u</div><div class="ttdef"><b>Definition:</b> <a href="vector__expressions_8hpp_source.html#l00195">vector_expressions.hpp:195</a></div></div>
<div class="ttc" id="aclassCConfig_html_a1c1aa8ce41b9bfffea9cbf502ad08188"><div class="ttname"><a href="classCConfig.html#a1c1aa8ce41b9bfffea9cbf502ad08188">CConfig::GetTheta_Interior_Penalty_DGFEM</a></div><div class="ttdeci">su2double GetTheta_Interior_Penalty_DGFEM(void) const</div><div class="ttdoc">Function to make available the multiplication factor theta of the symmetrizing terms in the DG discre...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l09015">CConfig.hpp:9015</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae57f903be939aa55dee4fb3298a249fb"><div class="ttname"><a href="classCConfig.html#ae57f903be939aa55dee4fb3298a249fb">CConfig::GetUnst_CFL</a></div><div class="ttdeci">su2double GetUnst_CFL(void) const</div><div class="ttdoc">Get the Courant Friedrich Levi number for unsteady simulations.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02766">CConfig.hpp:2766</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a6d7d256bd8da591999b249512b44617e"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a6d7d256bd8da591999b249512b44617e">CFEM_DG_EulerSolver::VecWorkSolDOFs</a></div><div class="ttdeci">vector&lt; vector&lt; su2double &gt; &gt; VecWorkSolDOFs</div><div class="ttdoc">Working double vector to store the conserved variables for the DOFs for the different time levels.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00183">CFEM_DG_EulerSolver.hpp:183</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a9f7075a39087b68ffbe4791d3e7c97aa"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a9f7075a39087b68ffbe4791d3e7c97aa">CFEM_DG_EulerSolver::symmetrizingTermsPresent</a></div><div class="ttdeci">bool symmetrizingTermsPresent</div><div class="ttdoc">Whether or not symmetrizing terms are present in the discretization.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00213">CFEM_DG_EulerSolver.hpp:213</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_acd2193a119fc1162909b554e8acf11b2"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#acd2193a119fc1162909b554e8acf11b2">CFEM_DG_NSSolver::BC_Custom</a></div><div class="ttdeci">void BC_Custom(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray) override</div><div class="ttdoc">Impose the user customized boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l06036">CFEM_DG_NSSolver.cpp:6036</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977a626d2901e9e521eb60f5681ada30849c"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a626d2901e9e521eb60f5681ada30849c">QUADRILATERAL</a></div><div class="ttdeci">@ QUADRILATERAL</div><div class="ttdoc">VTK nomenclature for defining a quadrilateral element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00129">option_structure.hpp:129</a></div></div>
<div class="ttc" id="aclassCFEMStandardElement_html_affb3cc64405ea150788c7c9739d8d6d5"><div class="ttname"><a href="classCFEMStandardElement.html#affb3cc64405ea150788c7c9739d8d6d5">CFEMStandardElement::GetBasisFunctionsIntegrationTrans</a></div><div class="ttdeci">const su2double * GetBasisFunctionsIntegrationTrans(void) const</div><div class="ttdoc">Function, which makes available the transpose of the basis functions in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l00914">fem_standard_element.hpp:914</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4f4842f072c0484236e776956ff41cbb"><div class="ttname"><a href="classCConfig.html#a4f4842f072c0484236e776956ff41cbb">CConfig::GetPhysicalTime</a></div><div class="ttdeci">su2double GetPhysicalTime(void) const</div><div class="ttdoc">Get the current physical time.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03152">CConfig.hpp:3152</a></div></div>
<div class="ttc" id="aclassCFEMStandardElementBase_html_aa5ad06a05a1d7b66bccca65521168a3b"><div class="ttname"><a href="classCFEMStandardElementBase.html#aa5ad06a05a1d7b66bccca65521168a3b">CFEMStandardElementBase::GetNIntegration</a></div><div class="ttdeci">unsigned short GetNIntegration(void) const</div><div class="ttdoc">Function, which makes available the number of integration points for this standard element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l00116">fem_standard_element.hpp:116</a></div></div>
<div class="ttc" id="aclassCConfig_html_adcfe24128655d4e063972fabd35b101e"><div class="ttname"><a href="classCConfig.html#adcfe24128655d4e063972fabd35b101e">CConfig::GetBody_Force_Vector</a></div><div class="ttdeci">const su2double * GetBody_Force_Vector(void) const</div><div class="ttdoc">Get a pointer to the body force vector.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l06040">CConfig.hpp:6040</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a9f3df866845a7ab68be4c8ddc08a84ea"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a9f3df866845a7ab68be4c8ddc08a84ea">CFEM_DG_EulerSolver::Gamma</a></div><div class="ttdeci">su2double Gamma</div><div class="ttdoc">Fluid's Gamma constant (ratio of specific heats).</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00043">CFEM_DG_EulerSolver.hpp:43</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a417c1b82a8a8b76d049cd48a796f68f3"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a417c1b82a8a8b76d049cd48a796f68f3">CFEM_DG_EulerSolver::Surface_CMy</a></div><div class="ttdeci">su2double * Surface_CMy</div><div class="ttdoc">y Moment coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00115">CFEM_DG_EulerSolver.hpp:115</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a5d32e85923daf35ff0126d5f716ff9ec"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a5d32e85923daf35ff0126d5f716ff9ec">CFEM_DG_EulerSolver::BoundaryStates_Euler_Wall</a></div><div class="ttdeci">void BoundaryStates_Euler_Wall(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, const su2double *solIntL, su2double *solIntR)</div><div class="ttdoc">Function, which computes the boundary states in the integration points of the boundary face by applyi...</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8cpp_source.html#l07480">CFEM_DG_EulerSolver.cpp:7480</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a04457c47629bda56704e6a8804833eeb"><div class="ttname"><a href="classCBaseMPIWrapper.html#a04457c47629bda56704e6a8804833eeb">CBaseMPIWrapper::Error</a></div><div class="ttdeci">static void Error(std::string ErrorMsg, std::string FunctionName)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8cpp_source.html#l00114">mpi_structure.cpp:114</a></div></div>
<div class="ttc" id="aclassCConfig_html_ac47e04d76ce865893a94dcedd3c9b6a5"><div class="ttname"><a href="classCConfig.html#ac47e04d76ce865893a94dcedd3c9b6a5">CConfig::GetTime_Marching</a></div><div class="ttdeci">TIME_MARCHING GetTime_Marching() const</div><div class="ttdoc">Provides information about the time integration, and change the write in the output files information...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05301">CConfig.hpp:5301</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_adae0b69228db8a532b39824eee930605"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#adae0b69228db8a532b39824eee930605">CFEM_DG_EulerSolver::VecResDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; VecResDOFs</div><div class="ttdoc">Vector, which stores the residuals in the owned DOFs.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00186">CFEM_DG_EulerSolver.hpp:186</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0abcea8fd4c94005a730427882d6e1d0a37768dcf184b83625cab7709c591e0ec"><div class="ttname"><a href="option__structure_8hpp.html#a0abcea8fd4c94005a730427882d6e1d0a37768dcf184b83625cab7709c591e0ec">TURB_SGS_MODEL::VREMAN</a></div><div class="ttdeci">@ VREMAN</div><div class="ttdoc">Vreman SGS model.</div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_a0d2d6958c0259607615f6715754eede8"><div class="ttname"><a href="classCFEMStandardInternalFace.html#a0d2d6958c0259607615f6715754eede8">CFEMStandardInternalFace::GetBasisFaceIntegrationTransposeSide1</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegrationTransposeSide1(void) const</div><div class="ttdoc">Function, which makes available transpose matrix of the face basis functions of side 1 in the integra...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01440">fem_standard_element.hpp:1440</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_ae13c22d84e920bba7ea932eead5c3baf"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#ae13c22d84e920bba7ea932eead5c3baf">CFEM_DG_EulerSolver::AeroCoeffForceRef</a></div><div class="ttdeci">su2double AeroCoeffForceRef</div><div class="ttdoc">Reference force for coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00095">CFEM_DG_EulerSolver.hpp:95</a></div></div>
<div class="ttc" id="aclassCSolver_html_a203241aa245597347fb258fac60962f6"><div class="ttname"><a href="classCSolver.html#a203241aa245597347fb258fac60962f6">CSolver::nDim</a></div><div class="ttdeci">unsigned short nDim</div><div class="ttdoc">Number of dimensions of the problem.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00086">CSolver.hpp:86</a></div></div>
<div class="ttc" id="aclassCFEMStandardBoundaryFace_html_aa2e4984684567bfa78f6556ad41a7c9c"><div class="ttname"><a href="classCFEMStandardBoundaryFace.html#aa2e4984684567bfa78f6556ad41a7c9c">CFEMStandardBoundaryFace::GetPenaltyConstant</a></div><div class="ttdeci">su2double GetPenaltyConstant(void) const</div><div class="ttdoc">Function, which makes available the penalty constant for this standard face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01724">fem_standard_element.hpp:1724</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a88c999a2ce949a2b939c223ae1132480"><div class="ttname"><a href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a></div><div class="ttdeci">const su2double TWO3</div><div class="ttdoc">Two divided by three.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00103">option_structure.hpp:103</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab99f4c81b2b9dd7e4b0f917ad8c5e829"><div class="ttname"><a href="classCConfig.html#ab99f4c81b2b9dd7e4b0f917ad8c5e829">CConfig::GetHeat_Flux_Ref</a></div><div class="ttdeci">su2double GetHeat_Flux_Ref(void) const</div><div class="ttdoc">Get the reference value for the heat flux.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01692">CConfig.hpp:1692</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a86580fa20aba8a73a9bd741fdc6e6a47"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a86580fa20aba8a73a9bd741fdc6e6a47">CFEM_DG_EulerSolver::VecDeltaTime</a></div><div class="ttdeci">vector&lt; su2double &gt; VecDeltaTime</div><div class="ttdoc">Vector, which stores the time steps of the owned volume elements.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00178">CFEM_DG_EulerSolver.hpp:178</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html"><div class="ttname"><a href="structCSurfaceElementFEM.html">CSurfaceElementFEM</a></div><div class="ttdoc">Class to store a surface element for the FEM solver.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00358">fem_geometry_structure.hpp:358</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a75d7083b30c2dd99c3f11ddb57226342ad1e7fb475a6de2107e56a5d516df332d"><div class="ttname"><a href="option__structure_8hpp.html#a75d7083b30c2dd99c3f11ddb57226342ad1e7fb475a6de2107e56a5d516df332d">TIME_MARCHING::STEADY</a></div><div class="ttdeci">@ STEADY</div><div class="ttdoc">A steady computation.</div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a95cef33ccbfa61def433d11ddef5745d"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a95cef33ccbfa61def433d11ddef5745d">CFEM_DG_EulerSolver::sizeWorkArray</a></div><div class="ttdeci">unsigned int sizeWorkArray</div><div class="ttdoc">The size of the work array needed.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00171">CFEM_DG_EulerSolver.hpp:171</a></div></div>
<div class="ttc" id="aclassCFluidModel_html_a0c795f4190d7f03963bd4ba50f43c641"><div class="ttname"><a href="classCFluidModel.html#a0c795f4190d7f03963bd4ba50f43c641">CFluidModel::SetTDState_rhoe</a></div><div class="ttdeci">virtual void SetTDState_rhoe(su2double rho, su2double e)</div><div class="ttdoc">virtual member that would be different for each gas model implemented</div><div class="ttdef"><b>Definition:</b> <a href="CFluidModel_8hpp_source.html#l00257">CFluidModel.hpp:257</a></div></div>
<div class="ttc" id="acode__config_8hpp_html_a404145e25ce1ea18e25e884f125237e3"><div class="ttname"><a href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a></div><div class="ttdeci">double su2double</div><div class="ttdef"><b>Definition:</b> <a href="code__config_8hpp_source.html#l00110">code_config.hpp:110</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_a043294eff88a9374a936fefaca0ea860"><div class="ttname"><a href="classCFEMStandardInternalFace.html#a043294eff88a9374a936fefaca0ea860">CFEMStandardInternalFace::GetNDOFsElemSide1</a></div><div class="ttdeci">unsigned short GetNDOFsElemSide1(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs of the element on side 1 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01482">fem_standard_element.hpp:1482</a></div></div>
<div class="ttc" id="astructCInternalFaceElementFEM_html_a07efa5d61195d365f7650e36851c03bb"><div class="ttname"><a href="structCInternalFaceElementFEM.html#a07efa5d61195d365f7650e36851c03bb">CInternalFaceElementFEM::elemID0</a></div><div class="ttdeci">unsigned long elemID0</div><div class="ttdoc">Element ID adjacent to side 0 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00318">fem_geometry_structure.hpp:318</a></div></div>
<div class="ttc" id="aclassCSGSModel_html_aebef9146565169091059c7b1a0fb926d"><div class="ttname"><a href="classCSGSModel.html#aebef9146565169091059c7b1a0fb926d">CSGSModel::ComputeEddyViscosity_2D</a></div><div class="ttdeci">virtual su2double ComputeEddyViscosity_2D(const su2double rho, const su2double dudx, const su2double dudy, const su2double dvdx, const su2double dvdy, const su2double lenScale, const su2double distToWall)</div><div class="ttdoc">Virtual function to determine the eddy viscosity for the given function arguments for a 2D simulation...</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8inl_source.html#l00033">sgs_model.inl:33</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html">CFEM_DG_EulerSolver</a></div><div class="ttdoc">Main class for defining the Euler Discontinuous Galerkin finite element flow solver.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00040">CFEM_DG_EulerSolver.hpp:40</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_ad6c3809edcd555e6387d36a6a0b6550d"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#ad6c3809edcd555e6387d36a6a0b6550d">CFEM_DG_EulerSolver::Total_CD</a></div><div class="ttdeci">su2double Total_CD</div><div class="ttdoc">Total drag coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00097">CFEM_DG_EulerSolver.hpp:97</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977a4cc31b3ed970e3f26bfd2d491b8d7946"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a4cc31b3ed970e3f26bfd2d491b8d7946">PRISM</a></div><div class="ttdeci">@ PRISM</div><div class="ttdoc">VTK nomenclature for defining a prism element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00132">option_structure.hpp:132</a></div></div>
<div class="ttc" id="aclassCConfig_html_a2bf56370670128e9e93af4ed3a7e2bb7"><div class="ttname"><a href="classCConfig.html#a2bf56370670128e9e93af4ed3a7e2bb7">CConfig::GetIsothermal_Temperature</a></div><div class="ttdeci">su2double GetIsothermal_Temperature(string val_index) const</div><div class="ttdoc">Get the wall temperature (static) at an isothermal boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8cpp_source.html#l09173">CConfig.cpp:9173</a></div></div>
<div class="ttc" id="aclassCConfig_html_a70fa75374f533da62b71207d589d6211"><div class="ttname"><a href="classCConfig.html#a70fa75374f533da62b71207d589d6211">CConfig::GetMarker_All_Monitoring</a></div><div class="ttdeci">unsigned short GetMarker_All_Monitoring(unsigned short val_marker) const</div><div class="ttdoc">Get the monitoring information for a marker val_marker.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03462">CConfig.hpp:3462</a></div></div>
<div class="ttc" id="aclassCFEMStandardElement_html_af525d0cd36565e5d1a452eaf927e14d0"><div class="ttname"><a href="classCFEMStandardElement.html#af525d0cd36565e5d1a452eaf927e14d0">CFEMStandardElement::GetMatVandermondeInv</a></div><div class="ttdeci">const su2double * GetMatVandermondeInv(void) const</div><div class="ttdoc">Function, which makes available the matrix storage of the inverse of Vandermonde matrix of solution D...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l00944">fem_standard_element.hpp:944</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a79debb4e2ee70feac94e9a420705dbf9"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a79debb4e2ee70feac94e9a420705dbf9">CFEM_DG_EulerSolver::LeftStatesIntegrationPointsBoundaryFace</a></div><div class="ttdeci">void LeftStatesIntegrationPointsBoundaryFace(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, su2double *solFace, su2double *solIntL)</div><div class="ttdoc">Function, which computes the left state of a boundary face.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8cpp_source.html#l08863">CFEM_DG_EulerSolver.cpp:8863</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aa058ba472f0fd41ae860caeaebca0166"><div class="ttname"><a href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a></div><div class="ttdeci">#define MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00476">mpi_structure.hpp:476</a></div></div>
<div class="ttc" id="aclassCSolver_html_a83cc131d1581bb838bb23721edf2afa4"><div class="ttname"><a href="classCSolver.html#a83cc131d1581bb838bb23721edf2afa4">CSolver::Max_Delta_Time</a></div><div class="ttdeci">su2double Max_Delta_Time</div><div class="ttdoc">Maximum value of the delta time for all the control volumes.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00089">CSolver.hpp:89</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074"><div class="ttname"><a href="option__structure_8hpp.html#a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074">COMM_FULL</a></div><div class="ttdeci">@ COMM_FULL</div><div class="ttdoc">Perform all MPI communications.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l02471">option_structure.hpp:2471</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a22b8079ccea001f1a35d236bfb2750d4"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a22b8079ccea001f1a35d236bfb2750d4">CFEM_DG_NSSolver::BC_Riemann</a></div><div class="ttdeci">void BC_Riemann(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray) override</div><div class="ttdoc">Impose the boundary condition using characteristic reconstruction.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l05970">CFEM_DG_NSSolver.cpp:5970</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_a0e3ff97b8c11ca92ede562565eec7041"><div class="ttname"><a href="classCFEMStandardInternalFace.html#a0e3ff97b8c11ca92ede562565eec7041">CFEMStandardInternalFace::GetNDOFsFaceSide1</a></div><div class="ttdeci">unsigned short GetNDOFsFaceSide1(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs on side 1 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01494">fem_standard_element.hpp:1494</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a9f443708e1245051148ad5a009120325"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a9f443708e1245051148ad5a009120325">CFEM_DG_EulerSolver::Surface_CD</a></div><div class="ttdeci">su2double * Surface_CD</div><div class="ttdoc">Drag coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00109">CFEM_DG_EulerSolver.hpp:109</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aa2fecfa16d35e8fa3894c512a527b73f"><div class="ttname"><a href="mpi__structure_8hpp.html#aa2fecfa16d35e8fa3894c512a527b73f">MPI_MIN</a></div><div class="ttdeci">#define MPI_MIN</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00479">mpi_structure.hpp:479</a></div></div>
<div class="ttc" id="aclassCConfig_html_a48a38b37dada9393fa8288e6b0a09b3e"><div class="ttname"><a href="classCConfig.html#a48a38b37dada9393fa8288e6b0a09b3e">CConfig::GetKind_SGS_Model</a></div><div class="ttdeci">TURB_SGS_MODEL GetKind_SGS_Model(void) const</div><div class="ttdoc">Get the kind of the subgrid scale model.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04364">CConfig.hpp:4364</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a215f5d64c363a662ee0cb31cbd4f13a1"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a215f5d64c363a662ee0cb31cbd4f13a1">CFEM_DG_EulerSolver::Total_CFx</a></div><div class="ttdeci">su2double Total_CFx</div><div class="ttdoc">Total x force coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00099">CFEM_DG_EulerSolver.hpp:99</a></div></div>
<div class="ttc" id="aclassCConfig_html_afbf664fbd8b2c75c5874432fdc185937"><div class="ttname"><a href="classCConfig.html#afbf664fbd8b2c75c5874432fdc185937">CConfig::GetKind_Regime</a></div><div class="ttdeci">ENUM_REGIME GetKind_Regime(void) const</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03744">CConfig.hpp:3744</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a3d32ed98538d3d4c345dd9c3a7d74c28"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">CFEM_DG_EulerSolver::Total_CFz</a></div><div class="ttdeci">su2double Total_CFz</div><div class="ttdoc">Total z force coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00101">CFEM_DG_EulerSolver.hpp:101</a></div></div>
<div class="ttc" id="aclassCConfig_html_a07714d2b67cf861cdb43891e2ff4f318"><div class="ttname"><a href="classCConfig.html#a07714d2b67cf861cdb43891e2ff4f318">CConfig::GetViscosity_FreeStreamND</a></div><div class="ttdeci">su2double GetViscosity_FreeStreamND(void) const</div><div class="ttdoc">Get the value of the non-dimensionalized freestream viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01934">CConfig.hpp:1934</a></div></div>
<div class="ttc" id="aCFEM__DG__NSSolver_8cpp_html_ad9581c7d57445a61638a869e3b4b8e3b"><div class="ttname"><a href="CFEM__DG__NSSolver_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a></div><div class="ttdeci">#define SIZE_ARR_NORM</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l00032">CFEM_DG_NSSolver.cpp:32</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_afee7aa41b9ef5cb33a6239ef2961fc57"><div class="ttname"><a href="classCVolumeElementFEM.html#afee7aa41b9ef5cb33a6239ef2961fc57">CVolumeElementFEM::shockSensorValue</a></div><div class="ttdeci">su2double shockSensorValue</div><div class="ttdoc">Value for sensing a shock.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00241">fem_geometry_structure.hpp:241</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a4eaf18ac074f0d11d4325a1965225a6b"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a4eaf18ac074f0d11d4325a1965225a6b">CFEM_DG_EulerSolver::VecSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; VecSolDOFs</div><div class="ttdoc">Vector, which stores the solution variables in the owned DOFs.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00176">CFEM_DG_EulerSolver.hpp:176</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a></div><div class="ttdeci">@ ISOTHERMAL</div><div class="ttdoc">No slip isothermal wall boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01516">option_structure.hpp:1516</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a2678e216127388c9c2e1812dda61dd7f"><div class="ttname"><a href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a></div><div class="ttdeci">const su2double EPS</div><div class="ttdoc">Error scale.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00098">option_structure.hpp:98</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a407d8b7c0f6944c2f08ee7fb9b28aa0c"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a407d8b7c0f6944c2f08ee7fb9b28aa0c">CFEM_DG_NSSolver::ResidualFaces</a></div><div class="ttdeci">void ResidualFaces(CConfig *config, const unsigned long indFaceBeg, const unsigned long indFaceEnd, unsigned long &amp;indResFaces, CNumerics *numerics, su2double *workArray) override</div><div class="ttdoc">Compute the spatial residual for the given range of faces.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l03723">CFEM_DG_NSSolver.cpp:3723</a></div></div>
<div class="ttc" id="astructCInternalFaceElementFEM_html_ab6c86e670d9d1ae338a04795a5638b1f"><div class="ttname"><a href="structCInternalFaceElementFEM.html#ab6c86e670d9d1ae338a04795a5638b1f">CInternalFaceElementFEM::DOFsSolElementSide1</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolElementSide1</div><div class="ttdoc">Vector of the solution DOFs of the element of side 1.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00329">fem_geometry_structure.hpp:329</a></div></div>
<div class="ttc" id="aclassCConfig_html_a9d3085d222e6ab0b658d79c52b6477fc"><div class="ttname"><a href="classCConfig.html#a9d3085d222e6ab0b658d79c52b6477fc">CConfig::SetDelta_UnstTimeND</a></div><div class="ttdeci">void SetDelta_UnstTimeND(su2double val_delta_unsttimend)</div><div class="ttdoc">Set the value of the unsteadty time step using the CFL number.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05684">CConfig.hpp:5684</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_aa6f58573b6ae42747d3e98e1497d76f1"><div class="ttname"><a href="structCSurfaceElementFEM.html#aa6f58573b6ae42747d3e98e1497d76f1">CSurfaceElementFEM::intPerWallFunctionDonor</a></div><div class="ttdeci">vector&lt; unsigned short &gt; intPerWallFunctionDonor</div><div class="ttdoc">The integration points per donor element for the wall function treatment.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00394">fem_geometry_structure.hpp:394</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a2a26031c6fd9824899ecb92125207b60"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a2a26031c6fd9824899ecb92125207b60">CFEM_DG_EulerSolver::Surface_CSF</a></div><div class="ttdeci">su2double * Surface_CSF</div><div class="ttdoc">Side-force coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00110">CFEM_DG_EulerSolver.hpp:110</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a7d84d5e44c469d17b9024f44a93bb2bc"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a7d84d5e44c469d17b9024f44a93bb2bc">CFEM_DG_EulerSolver::Surface_CEff</a></div><div class="ttdeci">su2double * Surface_CEff</div><div class="ttdoc">Efficiency (Cl/Cd) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00117">CFEM_DG_EulerSolver.hpp:117</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a04fa3111afb642b208d97efe113ff1cf"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a04fa3111afb642b208d97efe113ff1cf">CFEM_DG_NSSolver::Shock_Capturing_DG_Persson</a></div><div class="ttdeci">void Shock_Capturing_DG_Persson(const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray)</div><div class="ttdoc">Per-Olof Persson's method for capturing shock in DG.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l02986">CFEM_DG_NSSolver.cpp:2986</a></div></div>
<div class="ttc" id="aclassCFEMStandardElement_html_a51b506fa4dc4b72b40b32dd0c85590f9"><div class="ttname"><a href="classCFEMStandardElement.html#a51b506fa4dc4b72b40b32dd0c85590f9">CFEMStandardElement::GetMatBasisFunctionsIntegration</a></div><div class="ttdeci">const su2double * GetMatBasisFunctionsIntegration(void) const</div><div class="ttdoc">Function, which makes available the matrix storage of the basis functions in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l00950">fem_standard_element.hpp:950</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a973142a08d87ce2338d5c64f7f1e146b"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a973142a08d87ce2338d5c64f7f1e146b">CFEM_DG_EulerSolver::Total_CEff</a></div><div class="ttdeci">su2double Total_CEff</div><div class="ttdoc">Total efficiency coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00105">CFEM_DG_EulerSolver.hpp:105</a></div></div>
<div class="ttc" id="aclassCGeometry_html"><div class="ttname"><a href="classCGeometry.html">CGeometry</a></div><div class="ttdoc">Parent class for defining the geometry of the problem (complete geometry, multigrid agglomerated geom...</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00075">CGeometry.hpp:75</a></div></div>
<div class="ttc" id="aclassCFEMStandardBoundaryFace_html_a26266f4d68d95c22bbb949fe6d8f5db6"><div class="ttname"><a href="classCFEMStandardBoundaryFace.html#a26266f4d68d95c22bbb949fe6d8f5db6">CFEMStandardBoundaryFace::GetNDOFsFace</a></div><div class="ttdeci">unsigned short GetNDOFsFace(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01704">fem_standard_element.hpp:1704</a></div></div>
<div class="ttc" id="aclassCConfig_html_aa824c1a1b3c7cd05b7be414a76e0b250"><div class="ttname"><a href="classCConfig.html#aa824c1a1b3c7cd05b7be414a76e0b250">CConfig::GetAoA</a></div><div class="ttdeci">su2double GetAoA(void) const</div><div class="ttdoc">Get the angle of attack of the body. This is the angle between a reference line on a lifting body (of...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02646">CConfig.hpp:2646</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a3233306f97b6173c5c109cae04a4c9be"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a3233306f97b6173c5c109cae04a4c9be">CFEM_DG_EulerSolver::BoundaryStates_Outlet</a></div><div class="ttdeci">void BoundaryStates_Outlet(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, unsigned short val_marker, const su2double *solIntL, su2double *solIntR)</div><div class="ttdoc">Function, which computes the boundary states in the integration points of the boundary face by applyi...</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8cpp_source.html#l07662">CFEM_DG_EulerSolver.cpp:7662</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a2c5840cbba7a0cf9048a5465eab883b4"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a2c5840cbba7a0cf9048a5465eab883b4">CFEM_DG_NSSolver::BC_Supersonic_Outlet</a></div><div class="ttdeci">void BC_Supersonic_Outlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray) override</div><div class="ttdoc">Impose the supersonic outlet boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l05522">CFEM_DG_NSSolver.cpp:5522</a></div></div>
<div class="ttc" id="aclassCConfig_html_aa495414133c826e5f6651d4ce82d0ef6"><div class="ttname"><a href="classCConfig.html#aa495414133c826e5f6651d4ce82d0ef6">CConfig::GetComm_Level</a></div><div class="ttdeci">unsigned short GetComm_Level(void) const</div><div class="ttdoc">Get the level of MPI communications to be performed.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l09365">CConfig.hpp:9365</a></div></div>
<div class="ttc" id="aclassCFEMStandardElement_html_a007e03cd4cc6bd8f37e54411eaf0b23f"><div class="ttname"><a href="classCFEMStandardElement.html#a007e03cd4cc6bd8f37e54411eaf0b23f">CFEMStandardElement::GetNPoly</a></div><div class="ttdeci">unsigned short GetNPoly(void) const</div><div class="ttdoc">Function, which makes available the polynomial degree for this standard element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01023">fem_standard_element.hpp:1023</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0abcea8fd4c94005a730427882d6e1d0a7192fae7ec327c8d281dfe19e94d4e72"><div class="ttname"><a href="option__structure_8hpp.html#a0abcea8fd4c94005a730427882d6e1d0a7192fae7ec327c8d281dfe19e94d4e72">TURB_SGS_MODEL::WALE</a></div><div class="ttdeci">@ WALE</div><div class="ttdoc">Wall-Adapting Local Eddy-viscosity SGS model.</div></div>
<div class="ttc" id="aclassCConfig_html_afe9547710c70982ff9eee4504e3c4a69"><div class="ttname"><a href="classCConfig.html#afe9547710c70982ff9eee4504e3c4a69">CConfig::GetRefLength</a></div><div class="ttdeci">su2double GetRefLength(void) const</div><div class="ttdoc">Get the reference length for computing moment (the default value is 1).</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02270">CConfig.hpp:2270</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a80d80987b473f4a13b0cc0384eddb51b"><div class="ttname"><a href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a></div><div class="ttdeci">#define MPI_MAX</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00480">mpi_structure.hpp:480</a></div></div>
<div class="ttc" id="aclassCFEMStandardBoundaryFace_html_aad6afe2fa8d35697a57dfc22a7542176"><div class="ttname"><a href="classCFEMStandardBoundaryFace.html#aad6afe2fa8d35697a57dfc22a7542176">CFEMStandardBoundaryFace::GetNDOFsElem</a></div><div class="ttdeci">unsigned short GetNDOFsElem(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs of the adjacent element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01698">fem_standard_element.hpp:1698</a></div></div>
<div class="ttc" id="astructCInternalFaceElementFEM_html_aaf7209a1e287371117f9e525f6aae3e6"><div class="ttname"><a href="structCInternalFaceElementFEM.html#aaf7209a1e287371117f9e525f6aae3e6">CInternalFaceElementFEM::DOFsSolElementSide0</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolElementSide0</div><div class="ttdoc">Vector of the solution DOFs of the element of side 0.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00328">fem_geometry_structure.hpp:328</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977ad447314c433c39f567ca6bd240eae16a"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977ad447314c433c39f567ca6bd240eae16a">TETRAHEDRON</a></div><div class="ttdeci">@ TETRAHEDRON</div><div class="ttdoc">VTK nomenclature for defining a tetrahedron element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00130">option_structure.hpp:130</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_aa9c40460f4f77c1d43a99e7a77e595ca"><div class="ttname"><a href="classCVolumeElementFEM.html#aa9c40460f4f77c1d43a99e7a77e595ca">CVolumeElementFEM::factTimeLevel</a></div><div class="ttdeci">unsigned int factTimeLevel</div><div class="ttdoc">Number of local time steps for this element compared to the largest time step when time accurate loca...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00218">fem_geometry_structure.hpp:218</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a1719ed3ac3197990c7463c9317cae90b"><div class="ttname"><a href="classCVolumeElementFEM.html#a1719ed3ac3197990c7463c9317cae90b">CVolumeElementFEM::gridVelocities</a></div><div class="ttdeci">vector&lt; su2double &gt; gridVelocities</div><div class="ttdoc">Vector of the grid velocities in the integration points of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00254">fem_geometry_structure.hpp:254</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_a502c48a6cfd3ede3dd87f7b18922044f"><div class="ttname"><a href="structCSurfaceElementFEM.html#a502c48a6cfd3ede3dd87f7b18922044f">CSurfaceElementFEM::indStandardElement</a></div><div class="ttdeci">unsigned short indStandardElement</div><div class="ttdoc">Index in the vector of standard elements.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00363">fem_geometry_structure.hpp:363</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a84662874cf763c9001e3913fe20b3785"><div class="ttname"><a href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a></div><div class="ttdeci">#define CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00059">mpi_structure.hpp:59</a></div></div>
<div class="ttc" id="aclassCConfig_html_a90249ccb3ccab165af6d95dc5d4fc68f"><div class="ttname"><a href="classCConfig.html#a90249ccb3ccab165af6d95dc5d4fc68f">CConfig::GetBody_Force</a></div><div class="ttdeci">bool GetBody_Force(void) const</div><div class="ttdoc">Get information about the body force.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l06034">CConfig.hpp:6034</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a092d4e3317e650c1976872c763a668d8"><div class="ttname"><a href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a></div><div class="ttdeci">const su2double PI_NUMBER</div><div class="ttdoc">Pi number.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00106">option_structure.hpp:106</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_afe0727b6abf5816f8fd383dac6d91196"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#afe0727b6abf5816f8fd383dac6d91196">CFEM_DG_EulerSolver::blasFunctions</a></div><div class="ttdeci">CBlasStructure * blasFunctions</div><div class="ttdoc">Pointer to the object to carry out the BLAS functionalities.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00232">CFEM_DG_EulerSolver.hpp:232</a></div></div>
<div class="ttc" id="aclassCFEMStandardBoundaryFace_html_a35b1e9f96cb19c91da19c7a30596a128"><div class="ttname"><a href="classCFEMStandardBoundaryFace.html#a35b1e9f96cb19c91da19c7a30596a128">CFEMStandardBoundaryFace::GetBasisFaceIntegrationTranspose</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegrationTranspose(void) const</div><div class="ttdoc">Function, which makes available transpose matrix of the face basis functions in the integration point...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01677">fem_standard_element.hpp:1677</a></div></div>
<div class="ttc" id="aclassCConfig_html_a15b6f9a9ef3431c9478f68b6017b0137"><div class="ttname"><a href="classCConfig.html#a15b6f9a9ef3431c9478f68b6017b0137">CConfig::GetTke_FreeStreamND</a></div><div class="ttdeci">su2double GetTke_FreeStreamND(void) const</div><div class="ttdoc">Get the value of the non-dimensionalized freestream viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01940">CConfig.hpp:1940</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0abcea8fd4c94005a730427882d6e1d0afb51ccd07d6c26673745aa0ae14c4a85"><div class="ttname"><a href="option__structure_8hpp.html#a0abcea8fd4c94005a730427882d6e1d0afb51ccd07d6c26673745aa0ae14c4a85">TURB_SGS_MODEL::IMPLICIT_LES</a></div><div class="ttdeci">@ IMPLICIT_LES</div><div class="ttdoc">Implicit LES, i.e. no explicit SGS model.</div></div>
<div class="ttc" id="aclassCSGSModel_html_a2d935e92d5cb774b14e5763ca6389a99"><div class="ttname"><a href="classCSGSModel.html#a2d935e92d5cb774b14e5763ca6389a99">CSGSModel::ComputeGradEddyViscosity_3D</a></div><div class="ttdeci">virtual void ComputeGradEddyViscosity_3D(const su2double rho, const su2double drhodx, const su2double drhody, const su2double drhodz, const su2double dudx, const su2double dudy, const su2double dudz, const su2double dvdx, const su2double dvdy, const su2double dvdz, const su2double dwdx, const su2double dwdy, const su2double dwdz, const su2double d2udx2, const su2double d2udy2, const su2double d2udz2, const su2double d2udxdy, const su2double d2udxdz, const su2double d2udydz, const su2double d2vdx2, const su2double d2vdy2, const su2double d2vdz2, const su2double d2vdxdy, const su2double d2vdxdz, const su2double d2vdydz, const su2double d2wdx2, const su2double d2wdy2, const su2double d2wdz2, const su2double d2wdxdy, const su2double d2wdxdz, const su2double d2wdydz, const su2double lenScale, const su2double distToWall, su2double &amp;dMuTdx, su2double &amp;dMuTdy, su2double &amp;dMuTdz)</div><div class="ttdoc">Virtual function to determine the gradients of the eddy viscosity for the given function arguments fo...</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8inl_source.html#l00078">sgs_model.inl:78</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_a75e3433e592f810c39db50d1377b0509"><div class="ttname"><a href="structCSurfaceElementFEM.html#a75e3433e592f810c39db50d1377b0509">CSurfaceElementFEM::gridVelocities</a></div><div class="ttdeci">vector&lt; su2double &gt; gridVelocities</div><div class="ttdoc">Grid velocities in the integration points of this face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00386">fem_geometry_structure.hpp:386</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_a2ce24062976b9c064622aad15699e3dd"><div class="ttname"><a href="structCSurfaceElementFEM.html#a2ce24062976b9c064622aad15699e3dd">CSurfaceElementFEM::metricNormalsFace</a></div><div class="ttdeci">vector&lt; su2double &gt; metricNormalsFace</div><div class="ttdoc">The normals in the integration points of the face. The normals point out of the adjacent element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00381">fem_geometry_structure.hpp:381</a></div></div>
<div class="ttc" id="aclassCSmagorinskyModel_html"><div class="ttname"><a href="classCSmagorinskyModel.html">CSmagorinskyModel</a></div><div class="ttdoc">Derived class for defining the Smagorinsky SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8hpp_source.html#l00229">sgs_model.hpp:229</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a02b5ff59de9ae4559e88381a0571acf1"><div class="ttname"><a href="classCVolumeElementFEM.html#a02b5ff59de9ae4559e88381a0571acf1">CVolumeElementFEM::offsetDOFsSolLocal</a></div><div class="ttdeci">unsigned long offsetDOFsSolLocal</div><div class="ttdoc">Local offset of the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00224">fem_geometry_structure.hpp:224</a></div></div>
<div class="ttc" id="aclassCFluidModel_html_aee63b54308942e8b61b62a12a3278029"><div class="ttname"><a href="classCFluidModel.html#aee63b54308942e8b61b62a12a3278029">CFluidModel::GetPressure</a></div><div class="ttdeci">su2double GetPressure() const</div><div class="ttdoc">Get fluid pressure.</div><div class="ttdef"><b>Definition:</b> <a href="CFluidModel_8hpp_source.html#l00098">CFluidModel.hpp:98</a></div></div>
<div class="ttc" id="aclassCVremanModel_html"><div class="ttname"><a href="classCVremanModel.html">CVremanModel</a></div><div class="ttdoc">Derived class for defining the WALE SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8hpp_source.html#l00606">sgs_model.hpp:606</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a3bc4438cb7e9feb7f388d4ba87745996"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a3bc4438cb7e9feb7f388d4ba87745996">CFEM_DG_NSSolver::BC_Euler_Wall</a></div><div class="ttdeci">void BC_Euler_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray) override</div><div class="ttdoc">Impose via the residual the Euler wall boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l04979">CFEM_DG_NSSolver.cpp:4979</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_aae397626d48e4506157b9c4d7df06ab4"><div class="ttname"><a href="structCSurfaceElementFEM.html#aae397626d48e4506157b9c4d7df06ab4">CSurfaceElementFEM::nIntPerWallFunctionDonor</a></div><div class="ttdeci">vector&lt; unsigned short &gt; nIntPerWallFunctionDonor</div><div class="ttdoc">The number of integration points per donor element for the wall function treatment.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00392">fem_geometry_structure.hpp:392</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_af8d803542e4530244295b095f0e40dcb"><div class="ttname"><a href="classCVolumeElementFEM.html#af8d803542e4530244295b095f0e40dcb">CVolumeElementFEM::shockArtificialViscosity</a></div><div class="ttdeci">su2double shockArtificialViscosity</div><div class="ttdoc">Artificial viscosity for a shock.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00242">fem_geometry_structure.hpp:242</a></div></div>
<div class="ttc" id="aclassCConfig_html"><div class="ttname"><a href="classCConfig.html">CConfig</a></div><div class="ttdoc">Main class for defining the problem; basically this class reads the configuration file,...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l00062">CConfig.hpp:62</a></div></div>
<div class="ttc" id="aclassCFEMStandardElement_html_a4c15d676cd2b35367cbeea38f4a634b6"><div class="ttname"><a href="classCFEMStandardElement.html#a4c15d676cd2b35367cbeea38f4a634b6">CFEMStandardElement::GetMat2ndDerBasisFunctionsInt</a></div><div class="ttdeci">const su2double * GetMat2ndDerBasisFunctionsInt(void) const</div><div class="ttdoc">Function, which makes available the matrix storage of the second derivativex of the basis functions i...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l00975">fem_standard_element.hpp:975</a></div></div>
<div class="ttc" id="aclassCConfig_html_a1431ababf767a9f74ff74fe9ef647957"><div class="ttname"><a href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">CConfig::GetGas_ConstantND</a></div><div class="ttdeci">su2double GetGas_ConstantND(void) const</div><div class="ttdoc">Get the value of specific gas constant.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01650">CConfig.hpp:1650</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_ab40a08956d8e1bd5a19c7e166b63d3ee"><div class="ttname"><a href="classCFEMStandardInternalFace.html#ab40a08956d8e1bd5a19c7e166b63d3ee">CFEMStandardInternalFace::GetPenaltyConstant</a></div><div class="ttdeci">su2double GetPenaltyConstant(void) const</div><div class="ttdoc">Function, which makes available the penalty constant for this standard face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01500">fem_standard_element.hpp:1500</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4b89ad15fa82f93ca8ccfe945e2c14a7"><div class="ttname"><a href="classCConfig.html#a4b89ad15fa82f93ca8ccfe945e2c14a7">CConfig::GetPrandtl_Turb</a></div><div class="ttdeci">su2double GetPrandtl_Turb(unsigned short val_index=0) const</div><div class="ttdoc">Get the value of the turbulent Prandtl number.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01745">CConfig.hpp:1745</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a5bfdc0bca1daa8e5d716d4fc3c7f5867"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a5bfdc0bca1daa8e5d716d4fc3c7f5867">CFEM_DG_EulerSolver::BoundaryStates_Riemann</a></div><div class="ttdeci">void BoundaryStates_Riemann(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, unsigned short val_marker, const su2double *solIntL, su2double *solIntR)</div><div class="ttdoc">Function, which computes the boundary states in the integration points of the boundary face by applyi...</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8cpp_source.html#l07739">CFEM_DG_EulerSolver.cpp:7739</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a6adc8d7d1588b7747b8f278fcd73b58f"><div class="ttname"><a href="classCVolumeElementFEM.html#a6adc8d7d1588b7747b8f278fcd73b58f">CVolumeElementFEM::wallDistanceSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; wallDistanceSolDOFs</div><div class="ttdoc">The wall distance to the viscous walls for the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00266">fem_geometry_structure.hpp:266</a></div></div>
<div class="ttc" id="aclassCConfig_html_afa721d24bb2ffcb31bc0743f64dd33ee"><div class="ttname"><a href="classCConfig.html#afa721d24bb2ffcb31bc0743f64dd33ee">CConfig::GetKind_FEM_DG_Shock</a></div><div class="ttdeci">FEM_SHOCK_CAPTURING_DG GetKind_FEM_DG_Shock(void) const</div><div class="ttdoc">Get the kind of shock capturing method in FEM DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04603">CConfig.hpp:4603</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_addfa3cde2c8c248370af20b1e04e270d"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#addfa3cde2c8c248370af20b1e04e270d">CFEM_DG_EulerSolver::boundaries</a></div><div class="ttdeci">CBoundaryFEM * boundaries</div><div class="ttdoc">Array of the boundaries of the FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00149">CFEM_DG_EulerSolver.hpp:149</a></div></div>
<div class="ttc" id="aclassCFluidModel_html_abe5c1bbc7a5822be2ca700a296a0090a"><div class="ttname"><a href="classCFluidModel.html#abe5c1bbc7a5822be2ca700a296a0090a">CFluidModel::GetdmudT_rho</a></div><div class="ttdeci">su2double GetdmudT_rho()</div><div class="ttdoc">Get fluid dynamic viscosity partial derivative.</div><div class="ttdef"><b>Definition:</b> <a href="CFluidModel_8hpp_source.html#l00219">CFluidModel.hpp:219</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a9ada4b64ba200cf75493d963191c182e"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a9ada4b64ba200cf75493d963191c182e">CFEM_DG_EulerSolver::Gamma_Minus_One</a></div><div class="ttdeci">su2double Gamma_Minus_One</div><div class="ttdoc">Fluids's Gamma - 1.0 .</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00044">CFEM_DG_EulerSolver.hpp:44</a></div></div>
<div class="ttc" id="aclassCConfig_html_a25bfd5255f84135494ca2c368a848f98"><div class="ttname"><a href="classCConfig.html#a25bfd5255f84135494ca2c368a848f98">CConfig::GetAoS</a></div><div class="ttdeci">su2double GetAoS(void) const</div><div class="ttdoc">Get the angle of sideslip of the body. It relates to the rotation of the aircraft centerline from the...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02703">CConfig.hpp:2703</a></div></div>
<div class="ttc" id="astructCInternalFaceElementFEM_html_a26aae78c2fbc75adc617e6d5b152886f"><div class="ttname"><a href="structCInternalFaceElementFEM.html#a26aae78c2fbc75adc617e6d5b152886f">CInternalFaceElementFEM::elemID1</a></div><div class="ttdeci">unsigned long elemID1</div><div class="ttdoc">Element ID adjacent to side 1 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00319">fem_geometry_structure.hpp:319</a></div></div>
<div class="ttc" id="aclassCWALEModel_html"><div class="ttname"><a href="classCWALEModel.html">CWALEModel</a></div><div class="ttdoc">Derived class for defining the WALE SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8hpp_source.html#l00418">sgs_model.hpp:418</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a3d92e0a004752d2ef55cf6c1e2e3d6f0a4462c3537ac234334d1897fb8bacddcd"><div class="ttname"><a href="option__structure_8hpp.html#a3d92e0a004752d2ef55cf6c1e2e3d6f0a4462c3537ac234334d1897fb8bacddcd">ENUM_REGIME::COMPRESSIBLE</a></div><div class="ttdeci">@ COMPRESSIBLE</div><div class="ttdoc">Definition of compressible solver.</div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_a7a048944dcc446cbc2fc2128bfa425cc"><div class="ttname"><a href="structCSurfaceElementFEM.html#a7a048944dcc446cbc2fc2128bfa425cc">CSurfaceElementFEM::donorsWallFunction</a></div><div class="ttdeci">vector&lt; unsigned long &gt; donorsWallFunction</div><div class="ttdoc">Local element IDs of the donors for the wall function treatment. These donors can be halo's.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00390">fem_geometry_structure.hpp:390</a></div></div>
<div class="ttc" id="aclassCFEMStandardBoundaryFace_html_a19d1d508495d95239567972e425fd0c3"><div class="ttname"><a href="classCFEMStandardBoundaryFace.html#a19d1d508495d95239567972e425fd0c3">CFEMStandardBoundaryFace::GetBasisFaceIntegration</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegration(void) const</div><div class="ttdoc">Function, which makes available the face basis functions in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01670">fem_standard_element.hpp:1670</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_abdf9f21e0435e853d60d7faeecbb5e2f"><div class="ttname"><a href="structCSurfaceElementFEM.html#abdf9f21e0435e853d60d7faeecbb5e2f">CSurfaceElementFEM::DOFsSolElement</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolElement</div><div class="ttdoc">Vector of the solution DOFs of the adjacent element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00379">fem_geometry_structure.hpp:379</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a0e6816b988bcaeeb106a228096412c4b"><div class="ttname"><a href="classCVolumeElementFEM.html#a0e6816b988bcaeeb106a228096412c4b">CVolumeElementFEM::indStandardElement</a></div><div class="ttdeci">unsigned short indStandardElement</div><div class="ttdoc">Index in the vector of standard elements.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00216">fem_geometry_structure.hpp:216</a></div></div>
<div class="ttc" id="agroup__SIMD_html_ga54a1925ab40fb4249ea255072520de35"><div class="ttname"><a href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a></div><div class="ttdeci">FORCEINLINE ARRAY_T sqrt(const ARRAY_T &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="special__vectorization_8hpp_source.html#l00105">special_vectorization.hpp:105</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_ac11cd50dda8ce7d14d5561576b2e673e"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#ac11cd50dda8ce7d14d5561576b2e673e">CFEM_DG_EulerSolver::standardMatchingFacesSol</a></div><div class="ttdeci">const CFEMStandardInternalFace * standardMatchingFacesSol</div><div class="ttdoc">Array that contains the standard matching internal faces used for the solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00159">CFEM_DG_EulerSolver.hpp:159</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_aea70aaab1228b018aab7f2d588de9704"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#aea70aaab1228b018aab7f2d588de9704">CFEM_DG_NSSolver::BC_Isothermal_Wall</a></div><div class="ttdeci">void BC_Isothermal_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray) override</div><div class="ttdoc">Impose an isothermal condition at the wall.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l05853">CFEM_DG_NSSolver.cpp:5853</a></div></div>
<div class="ttc" id="astructCBoundaryFEM_html_a56dc8a452cc81445b0349f49122942c8"><div class="ttname"><a href="structCBoundaryFEM.html#a56dc8a452cc81445b0349f49122942c8">CBoundaryFEM::surfElem</a></div><div class="ttdeci">vector&lt; CSurfaceElementFEM &gt; surfElem</div><div class="ttdoc">Vector of the local surface elements.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00430">fem_geometry_structure.hpp:430</a></div></div>
<div class="ttc" id="aclassCFEMStandardElement_html_acaed7911bdb18d3a9a0de508869d2670"><div class="ttname"><a href="classCFEMStandardElement.html#acaed7911bdb18d3a9a0de508869d2670">CFEMStandardElement::GetDerMatBasisFunctionsIntTrans</a></div><div class="ttdeci">const su2double * GetDerMatBasisFunctionsIntTrans(void) const</div><div class="ttdoc">Function, which makes available the transpose matrix of the derivative of the basis functions in the ...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l00956">fem_standard_element.hpp:956</a></div></div>
<div class="ttc" id="aclassCNumerics_html"><div class="ttname"><a href="classCNumerics.html">CNumerics</a></div><div class="ttdoc">Class for defining the numerical methods.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00047">CNumerics.hpp:47</a></div></div>
<div class="ttc" id="aclassCConfig_html_a0acfef8e480970316e9e672eacd59e9b"><div class="ttname"><a href="classCConfig.html#a0acfef8e480970316e9e672eacd59e9b">CConfig::GetDelta_UnstTimeND</a></div><div class="ttdeci">su2double GetDelta_UnstTimeND(void) const</div><div class="ttdoc">If we are prforming an unsteady simulation, there is only one value of the time step for the complete...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05664">CConfig.hpp:5664</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_ac91dc7ef6eb5a6ede92a91708201e782"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#ac91dc7ef6eb5a6ede92a91708201e782">CFEM_DG_NSSolver::Shock_Capturing_DG</a></div><div class="ttdeci">void Shock_Capturing_DG(CConfig *config, const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray) override</div><div class="ttdoc">Compute the artificial viscosity for shock capturing in DG.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l02971">CFEM_DG_NSSolver.cpp:2971</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_ade87ae25bf13e3f96ff015e79386173c"><div class="ttname"><a href="classCVolumeElementFEM.html#ade87ae25bf13e3f96ff015e79386173c">CVolumeElementFEM::offsetDOFsSolThisTimeLevel</a></div><div class="ttdeci">unsigned long offsetDOFsSolThisTimeLevel</div><div class="ttdoc">Local offset of the solution DOFs of this element in the working vector of the time level of the elem...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00226">fem_geometry_structure.hpp:226</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a381d4b3738c09d92ee1ae9f89715b541"><div class="ttname"><a href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">CBaseMPIWrapper::Allreduce</a></div><div class="ttdeci">static void Allreduce(const void *sendbuf, void *recvbuf, int count, Datatype datatype, Op op, Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00557">mpi_structure.hpp:557</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a5118d674e7eb6f4865fb53f6f20eac1c"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a5118d674e7eb6f4865fb53f6f20eac1c">CFEM_DG_NSSolver::Friction_Forces</a></div><div class="ttdeci">void Friction_Forces(const CGeometry *geometry, const CConfig *config) override</div><div class="ttdoc">Compute the viscous forces and all the addimensional coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l00183">CFEM_DG_NSSolver.cpp:183</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977a3fcd053f6577a9c10a59c3d3595658eb"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a3fcd053f6577a9c10a59c3d3595658eb">PYRAMID</a></div><div class="ttdeci">@ PYRAMID</div><div class="ttdoc">VTK nomenclature for defining a pyramid element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00133">option_structure.hpp:133</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html"><div class="ttname"><a href="classCVolumeElementFEM.html">CVolumeElementFEM</a></div><div class="ttdoc">Class to store a volume element for the FEM solver.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00194">fem_geometry_structure.hpp:194</a></div></div>
<div class="ttc" id="astructCBoundaryFEM_html_adfdf6282092e74ca678b522fad104a7b"><div class="ttname"><a href="structCBoundaryFEM.html#adfdf6282092e74ca678b522fad104a7b">CBoundaryFEM::wallModel</a></div><div class="ttdeci">CWallModel * wallModel</div><div class="ttdoc">Wall model for LES.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00432">fem_geometry_structure.hpp:432</a></div></div>
<div class="ttc" id="aclassCConfig_html_a67306b97ff437e1b9939c3f8561c6e4a"><div class="ttname"><a href="classCConfig.html#a67306b97ff437e1b9939c3f8561c6e4a">CConfig::GetRefOriginMoment</a></div><div class="ttdeci">std::array&lt; su2double, 3 &gt; GetRefOriginMoment(unsigned short val_marker) const</div><div class="ttdoc">Get reference origin for moment computation.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01466">CConfig.hpp:1466</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_aa4480bd23e59713336af7ea0a57e724a"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#aa4480bd23e59713336af7ea0a57e724a">CFEM_DG_EulerSolver::VecResFaces</a></div><div class="ttdeci">vector&lt; su2double &gt; VecResFaces</div><div class="ttdoc">Vector, which stores the residuals of the DOFs that come from the faces, both boundary and internal.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00187">CFEM_DG_EulerSolver.hpp:187</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a195f99f02c2acdb5c441b0e60b6ca6cc"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">CFEM_DG_EulerSolver::Surface_CMz</a></div><div class="ttdeci">su2double * Surface_CMz</div><div class="ttdoc">z Moment coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00116">CFEM_DG_EulerSolver.hpp:116</a></div></div>
<div class="ttc" id="aclassCSolver_html_a69bc3df96cdb96a8b25b788118c4fcc9"><div class="ttname"><a href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">CSolver::nVar</a></div><div class="ttdeci">unsigned short nVar</div><div class="ttdoc">Number of variables of the problem.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00080">CSolver.hpp:80</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_acb4d942925e07bfc13a241aa0ec34c4a"><div class="ttname"><a href="classCFEMStandardInternalFace.html#acb4d942925e07bfc13a241aa0ec34c4a">CFEMStandardInternalFace::GetBasisFaceIntegrationTransposeSide0</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegrationTransposeSide0(void) const</div><div class="ttdoc">Function, which makes available transpose matrix of the face basis functions of side 0 in the integra...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01433">fem_standard_element.hpp:1433</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a256b4f3287dc3bb464d39c7908c77235"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a256b4f3287dc3bb464d39c7908c77235">CFEM_DG_EulerSolver::standardElementsSol</a></div><div class="ttdeci">const CFEMStandardElement * standardElementsSol</div><div class="ttdoc">Array that contains the standard volume elements used for the solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00157">CFEM_DG_EulerSolver.hpp:157</a></div></div>
<div class="ttc" id="aclassCSolver_html"><div class="ttname"><a href="classCSolver.html">CSolver</a></div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00066">CSolver.hpp:66</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_af47adcfc34283af5e61df0a69374e912"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#af47adcfc34283af5e61df0a69374e912">CFEM_DG_EulerSolver::Total_CMx</a></div><div class="ttdeci">su2double Total_CMx</div><div class="ttdoc">Total x moment coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00102">CFEM_DG_EulerSolver.hpp:102</a></div></div>
<div class="ttc" id="avector__expressions_8hpp_html_ada7eb2e492c6835c296205b2217a9021"><div class="ttname"><a href="vector__expressions_8hpp.html#ada7eb2e492c6835c296205b2217a9021">v</a></div><div class="ttdeci">store_t&lt; const V &gt; v</div><div class="ttdef"><b>Definition:</b> <a href="vector__expressions_8hpp_source.html#l00195">vector_expressions.hpp:195</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a0e61340858f57929e2697e19f730c260"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a0e61340858f57929e2697e19f730c260">CFEM_DG_EulerSolver::Total_CL</a></div><div class="ttdeci">su2double Total_CL</div><div class="ttdoc">Total lift coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00096">CFEM_DG_EulerSolver.hpp:96</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_aa2b0fa39f8b4853f27c537e30681d2c7"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#aa2b0fa39f8b4853f27c537e30681d2c7">CFEM_DG_EulerSolver::Surface_CMx</a></div><div class="ttdeci">su2double * Surface_CMx</div><div class="ttdoc">x Moment coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00114">CFEM_DG_EulerSolver.hpp:114</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a2d8cb0d23c35d78eb7f0a1ebc95be2c1"><div class="ttname"><a href="classCVolumeElementFEM.html#a2d8cb0d23c35d78eb7f0a1ebc95be2c1">CVolumeElementFEM::VTK_Type</a></div><div class="ttdeci">unsigned short VTK_Type</div><div class="ttdoc">Element type using the VTK convention.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00207">fem_geometry_structure.hpp:207</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4558fc163c393e628050e7a2273673f1"><div class="ttname"><a href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">CConfig::GetMarker_Monitoring_TagBound</a></div><div class="ttdeci">string GetMarker_Monitoring_TagBound(unsigned short val_marker) const</div><div class="ttdoc">Get the name of the surface defined in the geometry file.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03256">CConfig.hpp:3256</a></div></div>
<div class="ttc" id="astructCInternalFaceElementFEM_html_ad986a0eec8bc2e27e76046f64cec1046"><div class="ttname"><a href="structCInternalFaceElementFEM.html#ad986a0eec8bc2e27e76046f64cec1046">CInternalFaceElementFEM::metricNormalsFace</a></div><div class="ttdeci">vector&lt; su2double &gt; metricNormalsFace</div><div class="ttdoc">The normals in the integration points of the face. The normals point from side 0 to side 1.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00331">fem_geometry_structure.hpp:331</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0e3c6990687ed4453e660b9db9181885a99f136a862ba5c7d16967231c29f09d6"><div class="ttname"><a href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885a99f136a862ba5c7d16967231c29f09d6">YES</a></div><div class="ttdeci">@ YES</div><div class="ttdoc">Boolean definition of yes.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00210">option_structure.hpp:210</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a54b44d56de430143b203dedb967e69d9"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a54b44d56de430143b203dedb967e69d9">CFEM_DG_EulerSolver::Total_CMy</a></div><div class="ttdeci">su2double Total_CMy</div><div class="ttdoc">Total y moment coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00103">CFEM_DG_EulerSolver.hpp:103</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_a49f9ee99ed3a8a6c5c895050f29169d8"><div class="ttname"><a href="structCSurfaceElementFEM.html#a49f9ee99ed3a8a6c5c895050f29169d8">CSurfaceElementFEM::metricCoorDerivFace</a></div><div class="ttdeci">vector&lt; su2double &gt; metricCoorDerivFace</div><div class="ttdoc">The terms drdx, dsdx, etc. in the integration points of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00383">fem_geometry_structure.hpp:383</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a08d05db7c9f0a94dec17ab1eecd5c44d"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a08d05db7c9f0a94dec17ab1eecd5c44d">CFEM_DG_NSSolver::BC_Inlet</a></div><div class="ttdeci">void BC_Inlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray) override</div><div class="ttdoc">Impose the subsonic inlet boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l05589">CFEM_DG_NSSolver.cpp:5589</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_a024d56c5e3414c6bd22b278cea961ed8"><div class="ttname"><a href="classCFEMStandardInternalFace.html#a024d56c5e3414c6bd22b278cea961ed8">CFEMStandardInternalFace::GetMatDerBasisElemIntegrationSide1</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationSide1(void) const</div><div class="ttdoc">Function, which makes available the matrix with the derivatives of the element basis functions of sid...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01396">fem_standard_element.hpp:1396</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_afa7d6c1243dd1f7a29408f272c26b02d"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#afa7d6c1243dd1f7a29408f272c26b02d">CFEM_DG_NSSolver::BC_Outlet</a></div><div class="ttdeci">void BC_Outlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray) override</div><div class="ttdoc">Impose the outlet boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l05655">CFEM_DG_NSSolver.cpp:5655</a></div></div>
<div class="ttc" id="aclassCVerificationSolution_html_ad236e991301c3037e45206d939deb668"><div class="ttname"><a href="classCVerificationSolution.html#ad236e991301c3037e45206d939deb668">CVerificationSolution::IsManufacturedSolution</a></div><div class="ttdeci">virtual bool IsManufacturedSolution(void) const</div><div class="ttdoc">Whether or not this verification solution is a manufactured solution.</div><div class="ttdef"><b>Definition:</b> <a href="CVerificationSolution_8cpp_source.html#l00120">CVerificationSolution.cpp:120</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_aee91841e533b10cdbe3b3b09e98e3695"><div class="ttname"><a href="structCSurfaceElementFEM.html#aee91841e533b10cdbe3b3b09e98e3695">CSurfaceElementFEM::DOFsSolFace</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolFace</div><div class="ttdoc">Vector of the solution DOFs of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00376">fem_geometry_structure.hpp:376</a></div></div>
<div class="ttc" id="aclassCConfig_html_a77312cf52a5ba2cc1239b7cee6fce7a7"><div class="ttname"><a href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">CConfig::GetKind_Solver</a></div><div class="ttdeci">MAIN_SOLVER GetKind_Solver(void) const</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03664">CConfig.hpp:3664</a></div></div>
<div class="ttc" id="aclassCFluidModel_html_a654e55c4c6bb3914b40fbc27410876ba"><div class="ttname"><a href="classCFluidModel.html#a654e55c4c6bb3914b40fbc27410876ba">CFluidModel::GetSoundSpeed2</a></div><div class="ttdeci">su2double GetSoundSpeed2() const</div><div class="ttdoc">Get fluid speed of sound squared.</div><div class="ttdef"><b>Definition:</b> <a href="CFluidModel_8hpp_source.html#l00128">CFluidModel.hpp:128</a></div></div>
<div class="ttc" id="aclassCWallModel_html_aa97d804c3e84dddab5c3e16b5996b16a"><div class="ttname"><a href="classCWallModel.html#aa97d804c3e84dddab5c3e16b5996b16a">CWallModel::WallShearStressAndHeatFlux</a></div><div class="ttdeci">virtual void WallShearStressAndHeatFlux(const su2double tExchange, const su2double velExchange, const su2double muExchange, const su2double pExchange, const su2double Wall_HeatFlux, const bool HeatFlux_Prescribed, const su2double TWall, const bool Temperature_Prescribed, CFluidModel *FluidModel, su2double &amp;tauWall, su2double &amp;qWall, su2double &amp;ViscosityWall, su2double &amp;kOverCvWall)</div><div class="ttdoc">Virtual function, which computes the wall shear stress and heat flux from the data at the exchange lo...</div><div class="ttdef"><b>Definition:</b> <a href="wall__model_8cpp_source.html#l00047">wall_model.cpp:47</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a44d6272fd9607cb31468949e83b21a1ca1369526eecb5ac5e6b2ee9b93a048f1e"><div class="ttname"><a href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1ca1369526eecb5ac5e6b2ee9b93a048f1e">MAIN_SOLVER::FEM_LES</a></div><div class="ttdeci">@ FEM_LES</div><div class="ttdoc">Definition of the finite element Large Eddy Simulation Navier-Stokes' (LES) solver.</div></div>
<div class="ttc" id="aclassCConfig_html_a61a5154012543ac7d95929ddc6b79950"><div class="ttname"><a href="classCConfig.html#a61a5154012543ac7d95929ddc6b79950">CConfig::GetWall_HeatFlux</a></div><div class="ttdeci">su2double GetWall_HeatFlux(string val_index) const</div><div class="ttdoc">Get the wall heat flux on a constant heat flux boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8cpp_source.html#l09182">CConfig.cpp:9182</a></div></div>
<div class="ttc" id="astructCInternalFaceElementFEM_html_afec7875eae117cffa907fa22b0dfd2b7"><div class="ttname"><a href="structCInternalFaceElementFEM.html#afec7875eae117cffa907fa22b0dfd2b7">CInternalFaceElementFEM::wallDistance</a></div><div class="ttdeci">vector&lt; su2double &gt; wallDistance</div><div class="ttdoc">The wall distance to the viscous walls for the integration points of this face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00340">fem_geometry_structure.hpp:340</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a6f734d2019596d01b1a7bfad33a96d47ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="option__structure_8hpp.html#a6f734d2019596d01b1a7bfad33a96d47ab50339a10e1de285ac99d4c3990b8693">FEM_SHOCK_CAPTURING_DG::NONE</a></div><div class="ttdeci">@ NONE</div><div class="ttdoc">Shock capturing is not used.</div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aafd1dc0086079e7904385538c54c9c8f"><div class="ttname"><a href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a></div><div class="ttdeci">#define MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00474">mpi_structure.hpp:474</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a75d7083b30c2dd99c3f11ddb57226342ae1a5d5fc9657888e43b4518cdf0e9b7b"><div class="ttname"><a href="option__structure_8hpp.html#a75d7083b30c2dd99c3f11ddb57226342ae1a5d5fc9657888e43b4518cdf0e9b7b">TIME_MARCHING::TIME_STEPPING</a></div><div class="ttdeci">@ TIME_STEPPING</div><div class="ttdoc">Use a time stepping strategy for unsteady computations.</div></div>
<div class="ttc" id="aclassCSGSModel_html_a32de4fde5231a347640bf08d5be8876a"><div class="ttname"><a href="classCSGSModel.html#a32de4fde5231a347640bf08d5be8876a">CSGSModel::ComputeGradEddyViscosity_2D</a></div><div class="ttdeci">virtual void ComputeGradEddyViscosity_2D(const su2double rho, const su2double drhodx, const su2double drhody, const su2double dudx, const su2double dudy, const su2double dvdx, const su2double dvdy, const su2double d2udx2, const su2double d2udy2, const su2double d2udxdy, const su2double d2vdx2, const su2double d2vdy2, const su2double d2vdxdy, const su2double lenScale, const su2double distToWall, su2double &amp;dMuTdx, su2double &amp;dMuTdy)</div><div class="ttdoc">Virtual function to determine the gradients of the eddy viscosity for the given function arguments fo...</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8inl_source.html#l00058">sgs_model.inl:58</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_ad861b94102b072bb21d1665ef7932f2d"><div class="ttname"><a href="classCVolumeElementFEM.html#ad861b94102b072bb21d1665ef7932f2d">CVolumeElementFEM::timeLevel</a></div><div class="ttdeci">unsigned short timeLevel</div><div class="ttdoc">Time level of the element when time accurate local time stepping is employed.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00213">fem_geometry_structure.hpp:213</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a2b4d02d555cf80f6c1c92bd31770aeb6"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">CFEM_DG_EulerSolver::Surface_CL</a></div><div class="ttdeci">su2double * Surface_CL</div><div class="ttdoc">Lift coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00108">CFEM_DG_EulerSolver.hpp:108</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_ac55acb75de727685caa05b9273267f8e"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#ac55acb75de727685caa05b9273267f8e">CFEM_DG_NSSolver::BC_HeatFlux_Wall</a></div><div class="ttdeci">void BC_HeatFlux_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray) override</div><div class="ttdoc">Impose a constant heat-flux condition at the wall.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l05721">CFEM_DG_NSSolver.cpp:5721</a></div></div>
<div class="ttc" id="aclassCBlasStructure_html_ad282634317e0a32bce7896e2ddc40043"><div class="ttname"><a href="classCBlasStructure.html#ad282634317e0a32bce7896e2ddc40043">CBlasStructure::gemm</a></div><div class="ttdeci">void gemm(const int M, const int N, const int K, const su2double *A, const su2double *B, su2double *C, const CConfig *config)</div><div class="ttdoc">Function, which carries out a dense matrix product. It is a limited version of the BLAS gemm function...</div><div class="ttdef"><b>Definition:</b> <a href="blas__structure_8cpp_source.html#l00055">blas_structure.cpp:55</a></div></div>
<div class="ttc" id="aclassCConfig_html_a327893f15ca36b27db6201a7cb787022"><div class="ttname"><a href="classCConfig.html#a327893f15ca36b27db6201a7cb787022">CConfig::GetCFL</a></div><div class="ttdeci">su2double GetCFL(unsigned short val_mesh) const</div><div class="ttdoc">Get the Courant Friedrich Levi number for each grid.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02753">CConfig.hpp:2753</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a44020ceaf82c37e386385366c6cda7a5"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a44020ceaf82c37e386385366c6cda7a5">CFEM_DG_NSSolver::BC_Sym_Plane</a></div><div class="ttdeci">void BC_Sym_Plane(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray) override</div><div class="ttdoc">Impose the symmetry boundary condition using the residual.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l05117">CFEM_DG_NSSolver.cpp:5117</a></div></div>
<div class="ttc" id="aclassCFEMStandardBoundaryFace_html_abd2f5656593a34508bdfb2093a1d6f92"><div class="ttname"><a href="classCFEMStandardBoundaryFace.html#abd2f5656593a34508bdfb2093a1d6f92">CFEMStandardBoundaryFace::GetMatDerBasisElemIntegration</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegration(void) const</div><div class="ttdoc">Function, which makes available the matrix with the derivatives of the element basis functions in the...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01655">fem_standard_element.hpp:1655</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_a0719e8b18410e4720f58449ac28e8c38"><div class="ttname"><a href="classCFEMStandardInternalFace.html#a0719e8b18410e4720f58449ac28e8c38">CFEMStandardInternalFace::GetNDOFsElemSide0</a></div><div class="ttdeci">unsigned short GetNDOFsElemSide0(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs of the element on side 0 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01475">fem_standard_element.hpp:1475</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a3e5c79fc125e57530648d404111e73c2"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a3e5c79fc125e57530648d404111e73c2">CFEM_DG_EulerSolver::matchingInternalFaces</a></div><div class="ttdeci">CInternalFaceElementFEM * matchingInternalFaces</div><div class="ttdoc">Array of the local matching internal faces.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00148">CFEM_DG_EulerSolver.hpp:148</a></div></div>
<div class="ttc" id="aclassCSolver_html_a25ae37dcfbdd521de50f5a1da2633722"><div class="ttname"><a href="classCSolver.html#a25ae37dcfbdd521de50f5a1da2633722">CSolver::Min_Delta_Time</a></div><div class="ttdeci">su2double Min_Delta_Time</div><div class="ttdoc">Minimum value of the delta time for all the control volumes.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00090">CSolver.hpp:90</a></div></div>
<div class="ttc" id="aclassCConfig_html_a218d027f78cd801a8734a2d4581591ad"><div class="ttname"><a href="classCConfig.html#a218d027f78cd801a8734a2d4581591ad">CConfig::GetTemperature_Ref</a></div><div class="ttdeci">su2double GetTemperature_Ref(void) const</div><div class="ttdoc">Get the value of the reference temperature for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01806">CConfig.hpp:1806</a></div></div>
<div class="ttc" id="aclassCConfig_html_a6e65810e59b8015104b84c4fd5b1d7f9"><div class="ttname"><a href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">CConfig::GetnMarker_Monitoring</a></div><div class="ttdeci">unsigned short GetnMarker_Monitoring(void) const</div><div class="ttdoc">Get the total number of monitoring markers.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03008">CConfig.hpp:3008</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_af986cf3e59a8ce535f65b32b360a0258"><div class="ttname"><a href="classCVolumeElementFEM.html#af986cf3e59a8ce535f65b32b360a0258">CVolumeElementFEM::nDOFsSol</a></div><div class="ttdeci">unsigned short nDOFsSol</div><div class="ttdoc">Number of DOFs for the solution of the element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00211">fem_geometry_structure.hpp:211</a></div></div>
<div class="ttc" id="aclassCFluidModel_html_ad0e35cb58779dc8fe3265c85b6c29905"><div class="ttname"><a href="classCFluidModel.html#ad0e35cb58779dc8fe3265c85b6c29905">CFluidModel::GetLaminarViscosity</a></div><div class="ttdeci">virtual su2double GetLaminarViscosity()</div><div class="ttdoc">Get fluid dynamic viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="CFluidModel_8hpp_source.html#l00143">CFluidModel.hpp:143</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a6a9e78792a4e1dd0b5c27501105be895"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a6a9e78792a4e1dd0b5c27501105be895">CFEM_DG_EulerSolver::Total_CFy</a></div><div class="ttdeci">su2double Total_CFy</div><div class="ttdoc">Total y force coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00100">CFEM_DG_EulerSolver.hpp:100</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a></div><div class="ttdeci">@ HEAT_FLUX</div><div class="ttdoc">No slip constant heat flux wall boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01517">option_structure.hpp:1517</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_ace5ac45857734f2e764b4072249e5c2d"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#ace5ac45857734f2e764b4072249e5c2d">CFEM_DG_NSSolver::Volume_Residual</a></div><div class="ttdeci">void Volume_Residual(CConfig *config, const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray) override</div><div class="ttdoc">Compute the volume contributions to the spatial residual.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l03147">CFEM_DG_NSSolver.cpp:3147</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_a3acf4bc4e5877c7e1bebd11cdf99a8f5"><div class="ttname"><a href="structCSurfaceElementFEM.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">CSurfaceElementFEM::coorIntegrationPoints</a></div><div class="ttdeci">vector&lt; su2double &gt; coorIntegrationPoints</div><div class="ttdoc">The coordinates of the integration points of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00385">fem_geometry_structure.hpp:385</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a7d7110b59eb940c5e354f2303946dcf2"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a7d7110b59eb940c5e354f2303946dcf2">CFEM_DG_EulerSolver::Surface_CFy</a></div><div class="ttdeci">su2double * Surface_CFy</div><div class="ttdoc">y Force coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00112">CFEM_DG_EulerSolver.hpp:112</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab8c9c1f45950a29355be4ff357049440"><div class="ttname"><a href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">CConfig::GetMarker_All_TagBound</a></div><div class="ttdeci">string GetMarker_All_TagBound(unsigned short val_marker) const</div><div class="ttdoc">Get the index of the surface defined in the geometry file.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03208">CConfig.hpp:3208</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_ad358fa06c0e5b2762ad3258eb2c677e2"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#ad358fa06c0e5b2762ad3258eb2c677e2">CFEM_DG_EulerSolver::MetaDataChunkOfElem</a></div><div class="ttdeci">void MetaDataChunkOfElem(const TElemType *elem, const unsigned long l, const unsigned long elemEnd, const unsigned short nElemSimul, const unsigned short nPadMin, unsigned long &amp;lEnd, unsigned short &amp;ind, unsigned short &amp;llEnd, unsigned short &amp;NPad)</div><div class="ttdoc">Template function, which determines some meta data for the chunk of elements/faces that must be treat...</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l01658">CFEM_DG_EulerSolver.hpp:1658</a></div></div>
<div class="ttc" id="aclassCSGSModel_html_a6017e86477c7d39b542d82a3b2b9f1cd"><div class="ttname"><a href="classCSGSModel.html#a6017e86477c7d39b542d82a3b2b9f1cd">CSGSModel::ComputeEddyViscosity_3D</a></div><div class="ttdeci">virtual su2double ComputeEddyViscosity_3D(const su2double rho, const su2double dudx, const su2double dudy, const su2double dudz, const su2double dvdx, const su2double dvdy, const su2double dvdz, const su2double dwdx, const su2double dwdy, const su2double dwdz, const su2double lenScale, const su2double distToWall)</div><div class="ttdoc">Virtual function to determine the eddy viscosity for the given function arguments for a 3D simulation...</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8inl_source.html#l00043">sgs_model.inl:43</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a50202c322d1794f32fbfe7eff7617c25"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a50202c322d1794f32fbfe7eff7617c25">CFEM_DG_EulerSolver::Surface_CFz</a></div><div class="ttdeci">su2double * Surface_CFz</div><div class="ttdoc">z Force coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00113">CFEM_DG_EulerSolver.hpp:113</a></div></div>
<div class="ttc" id="aclassCFluidModel_html_ab7651562ac98477a1f3ae39832a4ffb1"><div class="ttname"><a href="classCFluidModel.html#ab7651562ac98477a1f3ae39832a4ffb1">CFluidModel::GetTemperature</a></div><div class="ttdeci">su2double GetTemperature() const</div><div class="ttdoc">Get fluid temperature.</div><div class="ttdef"><b>Definition:</b> <a href="CFluidModel_8hpp_source.html#l00103">CFluidModel.hpp:103</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a7fe136e76d176a903d223e989e01b29c"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a7fe136e76d176a903d223e989e01b29c">CFEM_DG_EulerSolver::nVolElemOwned</a></div><div class="ttdeci">unsigned long nVolElemOwned</div><div class="ttdoc">Number of owned local volume elements.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00124">CFEM_DG_EulerSolver.hpp:124</a></div></div>
<div class="ttc" id="aclassCSolver_html_afb56deafa3cb78f8b32ccc88e5f7f873"><div class="ttname"><a href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">CSolver::nMarker</a></div><div class="ttdeci">unsigned long nMarker</div><div class="ttdoc">Total number of markers using the grid information.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00142">CSolver.hpp:142</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a8154391fc3522954802889d81d4ef5da"><div class="ttname"><a href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">CBaseMPIWrapper::GetComm</a></div><div class="ttdeci">static Comm GetComm()</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00517">mpi_structure.hpp:517</a></div></div>
<div class="ttc" id="astructCSurfaceElementFEM_html_a01bc57f549254d1a4c48b56de5c135c6"><div class="ttname"><a href="structCSurfaceElementFEM.html#a01bc57f549254d1a4c48b56de5c135c6">CSurfaceElementFEM::volElemID</a></div><div class="ttdeci">unsigned long volElemID</div><div class="ttdoc">ID of the corresponding volume element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00365">fem_geometry_structure.hpp:365</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_a7a774000d08e4a5bdaae5ff73053911a"><div class="ttname"><a href="classCFEMStandardInternalFace.html#a7a774000d08e4a5bdaae5ff73053911a">CFEMStandardInternalFace::GetMatDerBasisElemIntegrationTransposeSide1</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationTransposeSide1(void) const</div><div class="ttdoc">Function, which makes available the transpose of the matrix with the derivatives of the element basis...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01412">fem_standard_element.hpp:1412</a></div></div>
<div class="ttc" id="aclassCFEMStandardBoundaryFace_html_af871727fdb40d29be27a7107571be421"><div class="ttname"><a href="classCFEMStandardBoundaryFace.html#af871727fdb40d29be27a7107571be421">CFEMStandardBoundaryFace::GetMatDerBasisElemIntegrationTranspose</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationTranspose(void) const</div><div class="ttdoc">Function, which makes available the transpose of the matrix with the derivatives of the element basis...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01663">fem_standard_element.hpp:1663</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977aa67bd73e46a66076a9980159f8011a02"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977aa67bd73e46a66076a9980159f8011a02">HEXAHEDRON</a></div><div class="ttdeci">@ HEXAHEDRON</div><div class="ttdoc">VTK nomenclature for defining a hexahedron element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00131">option_structure.hpp:131</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a92b0e3fa2d142ef6ed6c2ac4aafc9c04"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">CFEM_DG_EulerSolver::Total_CSF</a></div><div class="ttdeci">su2double Total_CSF</div><div class="ttdoc">Total sideforce coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00098">CFEM_DG_EulerSolver.hpp:98</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a1d77cb51e0eb51dfb95735ac965ac176"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a1d77cb51e0eb51dfb95735ac965ac176">CFEM_DG_NSSolver::SetTime_Step</a></div><div class="ttdeci">void SetTime_Step(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned long Iteration) override</div><div class="ttdoc">Function to compute the time step for solving the Navier-Stokes equations.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l00892">CFEM_DG_NSSolver.cpp:892</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_a657e76ad82d82dbf95b2939d36f15c04"><div class="ttname"><a href="classCFEMStandardInternalFace.html#a657e76ad82d82dbf95b2939d36f15c04">CFEMStandardInternalFace::GetMatDerBasisElemIntegrationSide0</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationSide0(void) const</div><div class="ttdoc">Function, which makes available the matrix with the derivatives of the element basis functions of sid...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01389">fem_standard_element.hpp:1389</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae003cd8f406eaaa91849a774c9a20730"><div class="ttname"><a href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">CConfig::GetMarker_All_KindBC</a></div><div class="ttdeci">unsigned short GetMarker_All_KindBC(unsigned short val_marker) const</div><div class="ttdoc">Get the kind of boundary for each marker.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03284">CConfig.hpp:3284</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a4851d39829e12202592d85c36ea36489"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a4851d39829e12202592d85c36ea36489">CFEM_DG_EulerSolver::ComputeInviscidFluxesFace</a></div><div class="ttdeci">void ComputeInviscidFluxesFace(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const unsigned long nPoints, const su2double *normalsFace[], const su2double *gridVelsFace[], const su2double *solL, const su2double *solR, su2double *fluxes, CNumerics *numerics)</div><div class="ttdoc">Function, which computes the inviscid fluxes in face points.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8cpp_source.html#l08909">CFEM_DG_EulerSolver.cpp:8909</a></div></div>
<div class="ttc" id="aclassCFEMStandardInternalFace_html_a0e31bf5a95fe57e837c1cbcf30e0ccb4"><div class="ttname"><a href="classCFEMStandardInternalFace.html#a0e31bf5a95fe57e837c1cbcf30e0ccb4">CFEMStandardInternalFace::GetMatDerBasisElemIntegrationTransposeSide0</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationTransposeSide0(void) const</div><div class="ttdoc">Function, which makes available the transpose of the matrix with the derivatives of the element basis...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l01404">fem_standard_element.hpp:1404</a></div></div>
<div class="ttc" id="aclassCFEMStandardElementBase_html_a07b708843f8de8a1f5a4f7113866f10e"><div class="ttname"><a href="classCFEMStandardElementBase.html#a07b708843f8de8a1f5a4f7113866f10e">CFEMStandardElementBase::GetWeightsIntegration</a></div><div class="ttdeci">const su2double * GetWeightsIntegration(void) const</div><div class="ttdoc">Function, which makes available the weights in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8hpp_source.html#l00098">fem_standard_element.hpp:98</a></div></div>
<div class="ttc" id="aclassCWallModel_html"><div class="ttname"><a href="classCWallModel.html">CWallModel</a></div><div class="ttdoc">Base class for defining the LES wall model.</div><div class="ttdef"><b>Definition:</b> <a href="wall__model_8hpp_source.html#l00047">wall_model.hpp:47</a></div></div>
<div class="ttc" id="acode__config_8hpp_html_a4dadaa5d43962856ca5f0c45aa657b06"><div class="ttname"><a href="code__config_8hpp.html#a4dadaa5d43962856ca5f0c45aa657b06">passivedouble</a></div><div class="ttdeci">double passivedouble</div><div class="ttdef"><b>Definition:</b> <a href="code__config_8hpp_source.html#l00115">code_config.hpp:115</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a3c90e5beb43d51190439eeadd0f29c74"><div class="ttname"><a href="classCVolumeElementFEM.html#a3c90e5beb43d51190439eeadd0f29c74">CVolumeElementFEM::gridVelocitiesSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; gridVelocitiesSolDOFs</div><div class="ttdoc">Vector of the grid velocities in the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00256">fem_geometry_structure.hpp:256</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a3dde950e7512a05dc691db87cd8ca51f"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a3dde950e7512a05dc691db87cd8ca51f">CFEM_DG_EulerSolver::Surface_CFx</a></div><div class="ttdeci">su2double * Surface_CFx</div><div class="ttdoc">x Force coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00111">CFEM_DG_EulerSolver.hpp:111</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a4dce50854c91ee9d721a72bbadd50254"><div class="ttname"><a href="classCVolumeElementFEM.html#a4dce50854c91ee9d721a72bbadd50254">CVolumeElementFEM::metricTerms2ndDer</a></div><div class="ttdeci">vector&lt; su2double &gt; metricTerms2ndDer</div><div class="ttdoc">Vector of the metric terms needed for the computation of the 2nd derivatives in the integration point...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00249">fem_geometry_structure.hpp:249</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a49a02faff89405aab2a322001a8c4fe6"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a49a02faff89405aab2a322001a8c4fe6">CFEM_DG_EulerSolver::volElem</a></div><div class="ttdeci">CVolumeElementFEM * volElem</div><div class="ttdoc">Array of the local volume elements, including halos.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00125">CFEM_DG_EulerSolver.hpp:125</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a166cf9167fb8c2e9fa95a0c300593d3d"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a166cf9167fb8c2e9fa95a0c300593d3d">CFEM_DG_NSSolver::~CFEM_DG_NSSolver</a></div><div class="ttdeci">~CFEM_DG_NSSolver(void) override</div><div class="ttdoc">Destructor of the class.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l00153">CFEM_DG_NSSolver.cpp:153</a></div></div>
<div class="ttc" id="aclassCConfig_html_a502035c2b049606186e11e01b7df626a"><div class="ttname"><a href="classCConfig.html#a502035c2b049606186e11e01b7df626a">CConfig::GetPrandtl_Lam</a></div><div class="ttdeci">su2double GetPrandtl_Lam(unsigned short val_index=0) const</div><div class="ttdoc">Get the value of the laminar Prandtl number.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01739">CConfig.hpp:1739</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_ae6c47cde654970b624c84f026f604a67"><div class="ttname"><a href="classCVolumeElementFEM.html#ae6c47cde654970b624c84f026f604a67">CVolumeElementFEM::metricTermsSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; metricTermsSolDOFs</div><div class="ttdoc">Vector of the metric terms in the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00247">fem_geometry_structure.hpp:247</a></div></div>
<div class="ttc" id="aclassCFEM__DG__EulerSolver_html_a741af8678935b8dace1f9c821d94da07"><div class="ttname"><a href="classCFEM__DG__EulerSolver.html#a741af8678935b8dace1f9c821d94da07">CFEM_DG_EulerSolver::FluidModel</a></div><div class="ttdeci">CFluidModel * FluidModel</div><div class="ttdoc">fluid model used in the solver</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__EulerSolver_8hpp_source.html#l00046">CFEM_DG_EulerSolver.hpp:46</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a29c1a5c8d0afd5b82ff19c6f6f64a75b"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a29c1a5c8d0afd5b82ff19c6f6f64a75b">CFEM_DG_NSSolver::CFEM_DG_NSSolver</a></div><div class="ttdeci">CFEM_DG_NSSolver(void)</div><div class="ttdoc">Constructor of the class.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l00034">CFEM_DG_NSSolver.cpp:34</a></div></div>
<div class="ttc" id="aclassCFEM__DG__NSSolver_html_a4eff2ed485808a8a96cb9bb9c7936058"><div class="ttname"><a href="classCFEM__DG__NSSolver.html#a4eff2ed485808a8a96cb9bb9c7936058">CFEM_DG_NSSolver::BC_Far_Field</a></div><div class="ttdeci">void BC_Far_Field(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray) override</div><div class="ttdoc">Impose the far-field boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="CFEM__DG__NSSolver_8cpp_source.html#l05045">CFEM_DG_NSSolver.cpp:5045</a></div></div>
<div class="ttc" id="aclassCVolumeElementFEM_html_a51a6fc4be49459ff00b9391ba87291cd"><div class="ttname"><a href="classCVolumeElementFEM.html#a51a6fc4be49459ff00b9391ba87291cd">CVolumeElementFEM::coorIntegrationPoints</a></div><div class="ttdeci">vector&lt; su2double &gt; coorIntegrationPoints</div><div class="ttdoc">The coordinates of the integration points of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00262">fem_geometry_structure.hpp:262</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_6f9fd837e39f246a8f0c94f670ad0309.html">SU2_CFD</a></li><li class="navelem"><a class="el" href="dir_74ad77d76f42ded9212b1c5616a2ad50.html">src</a></li><li class="navelem"><a class="el" href="dir_320eb617c00a5dd44b94c6b6f4553ab7.html">solvers</a></li><li class="navelem"><a class="el" href="CFEM__DG__NSSolver_8cpp.html">CFEM_DG_NSSolver.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
