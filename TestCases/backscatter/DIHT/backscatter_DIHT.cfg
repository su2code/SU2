%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
% SU2 configuration file                                                       %
% Case description: Decaying Isotropic Homogeneous Turbulence (DIHT)           % 
% Author: Angelo Passariello                                                   %
% Institution: University of Naples Federico II                                %
% Date: 2025.10.01                                                             %
% File Version 8.3.0 "Harrier"                                                 %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ------------- DIRECT, ADJOINT, AND LINEARIZED PROBLEM DEFINITION ------------%

SOLVER= RANS
KIND_TURB_MODEL= SA
HYBRID_RANSLES= SA_DES 
MATH_PROBLEM= DIRECT
RESTART_SOL= NO

% ------------- STOCHASTIC BACKSCATTER MODEL PARAMETERS -----------------------%

STOCHASTIC_BACKSCATTER= YES
SBS_CTAU= 0.001

% ------------- DECAYING ISOTROPIC HOMOGENEOUS TURBULENCE ---------------------%

DIHT= YES
DIHT_DOMAIN_LENGTH= (0.5588, 0.5588, 0.5588)
DIHT_NPOINT= (64, 64, 64) 
DIHT_NUM_MODES= 800

% ----------- COMPRESSIBLE AND INCOMPRESSIBLE FREE-STREAM DEFINITION ----------%

MACH_NUMBER= 0.001
FREESTREAM_TEMPERATURE= 300.0
REYNOLDS_NUMBER= 10129
REYNOLDS_LENGTH= 0.5588
FREESTREAM_NU_FACTOR= 1.0

% ---------------------- REFERENCE VALUE DEFINITION ---------------------------%

REF_LENGTH= 1.0
REF_AREA= 1.0

% ------------------------- UNSTEADY SIMULATION -------------------------------%

TIME_DOMAIN= NO
%TIME_MARCHING= DUAL_TIME_STEPPING-2ND_ORDER
%TIME_STEP= 0.001
%MAX_TIME= 20
%UNST_CFL_NUMBER= 0.0
INNER_ITER= 0  

% -------------------- BOUNDARY CONDITION DEFINITION --------------------------%

MARKER_PERIODIC= (xmin, xmax, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5588, 0.0, 0.0, ymin, ymax, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5588, 0.0, zmin, zmax, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5588)

% ------------- COMMON PARAMETERS DEFINING THE NUMERICAL METHOD ---------------%

NUM_METHOD_GRAD= GREEN_GAUSS
CFL_NUMBER= 10.0
CFL_ADAPT= NO
CFL_ADAPT_PARAM= ( 1.5, 0.5, 1.0, 100.0 )
RK_ALPHA_COEFF= ( 0.66667, 0.66667, 1.000000 )
TIME_ITER= 1
LINEAR_SOLVER_PREC= ILU
LOW_MACH_PREC= YES
%LOW_MACH_CORR= YES

% ----------------------- SLOPE LIMITER DEFINITION ----------------------------%

MUSCL_FLOW= YES
SLOPE_LIMITER_FLOW= NONE
MUSCL_TURB= NO
VENKAT_LIMITER_COEFF= 0.05

% -------------------- FLOW NUMERICAL METHOD DEFINITION -----------------------%
%
CONV_NUM_METHOD_FLOW= SLAU2
TIME_DISCRE_FLOW= EULER_IMPLICIT

% -------------------- TURBULENT NUMERICAL METHOD DEFINITION ------------------%
%
CONV_NUM_METHOD_TURB= SCALAR_UPWIND
TIME_DISCRE_TURB= EULER_IMPLICIT

% --------------------------- CONVERGENCE PARAMETERS --------------------------%
%
CONV_RESIDUAL_MINVAL= -15
CONV_STARTITER= 0
CONV_CAUCHY_ELEMS= 100
CONV_CAUCHY_EPS= 1E-6

% ------------------------- INPUT/OUTPUT INFORMATION --------------------------%
%
MESH_FILENAME= cube_64.su2 
MESH_FORMAT= SU2
TABULAR_FORMAT= CSV
CONV_FILENAME= history
RESTART_FILENAME= restart_flow
VOLUME_FILENAME= flow
VOLUME_OUTPUT= DDES, BACKSCATTER
SCREEN_OUTPUT= (TIME_ITER, INNER_ITER, RMS_DENSITY, RMS_MOMENTUM-X, RMS_MOMENTUM-Y, RMS_MOMENTUM-Z, RMS_NU_TILDE, RMS_STOCH_VAR_X, RMS_STOCH_VAR_Y, RMS_STOCH_VAR_Z)
HISTORY_OUTPUT= (TIME_ITER, RMS_DENSITY, RMS_MOMENTUM-X, RMS_MOMENTUM-Y, RMS_MOMENTUM-Z, RMS_NU_TILDE)
HISTORY_WRT_FREQ_INNER= 1000000
OUTPUT_WRT_FREQ= 1000000
OUTPUT_FILES= (RESTART, PARAVIEW)
