%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SU2 configuration file                                                       %
% Case description: Regression test for coupled adjoints                       %
% Author: R.Sanchez                                                            %
% Institution: Imperial College London                                         %
% Date: 2017.11.29                                                             %
% File Version 6.2.0 "Falcon"                                                   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

PHYSICAL_PROBLEM= FLUID_STRUCTURE_INTERACTION
FSI_FLUID_PROBLEM = NAVIER_STOKES
FSI_STRUCTURAL_PROBLEM = ELASTICITY

MATH_PROBLEM= DISCRETE_ADJOINT

RESTART_SOL= NO

PRESTRETCH = YES
PRESTRETCH_FILENAME = prestretch.dat

DE_EFFECTS = YES
ELECTRIC_FIELD_CONST = 4.25E-11
ELECTRIC_FIELD_DIR = (0.0,1.0)
ELECTRIC_FIELD_MOD = 20E5

OBJECTIVE_FUNCTION = REFERENCE_GEOMETRY 

REFERENCE_GEOMETRY = YES
REFERENCE_GEOMETRY_FILENAME = reference_geometry.dat
REFERENCE_GEOMETRY_FORMAT = SU2

DISCADJ_LIN_SOLVER= FGMRES
DISCADJ_LIN_PREC= JACOBI
FSI_DISCADJ_LIN_SOLVER_STRUC = CONJUGATE_GRADIENT
FSI_DISCADJ_LIN_PREC_STRUC = JACOBI

WRT_BINARY_RESTART=NO
READ_BINARY_RESTART=NO

MESH_FILENAME= mesh.su2

EXT_ITER= 1
FSI_ITER= 4

STAT_RELAX_PARAMETER= 1.0
BGS_RELAXATION = FIXED_PARAMETER
PREDICTOR_ORDER=0

MARKER_ZONE_INTERFACE = (UpperWall, UpperWallS, LowerWall, LowerWallS)
CONSERVATIVE_INTERPOLATION = YES

GEOMETRIC_CONDITIONS= LARGE_DEFORMATIONS
MATERIAL_MODEL= NEO_HOOKEAN
MATERIAL_COMPRESSIBILITY= COMPRESSIBLE

ELASTICITY_MODULUS=34150
POISSON_RATIO=0.0
MATERIAL_DENSITY=402.287
FORMULATION_ELASTICITY_2D = PLANE_STRESS

NONLINEAR_FEM_SOLUTION_METHOD = NEWTON_RAPHSON
NONLINEAR_FEM_INT_ITER = 5
RESIDUAL_FEM_UTOL = -9.0
RESIDUAL_FEM_RTOL = -9.0
RESIDUAL_FEM_ETOL = -9.0

MARKER_CLAMPED = ( Clamped_Right, Clamped_Left )
MARKER_PRESSURE= ( LowerWallS, 0, UpperWallS, 0)

UNST_INT_ITER= 50

AOA= 4.0
SIDESLIP_ANGLE= 0.0
REYNOLDS_NUMBER= 2500
FREESTREAM_OPTION = DENSITY_FS
FREESTREAM_DENSITY = 1.0
VISCOSITY_MODEL = CONSTANT_VISCOSITY
MU_CONSTANT = 5.464E-5
INIT_OPTION = TD_CONDITIONS
MACH_NUMBER = 0.2
MACH_MOTION = 0.2
FREESTREAM_PRESSURE = 17.857142857
FREESTREAM_TEMPERATURE = 0.062207438

REF_ORIGIN_MOMENT_X = 0.00
REF_ORIGIN_MOMENT_Y = 0.00
REF_ORIGIN_MOMENT_Z = 0.00
REF_AREA= 0.1366
REYNOLDS_LENGTH=0.1366

MARKER_HEATFLUX= ( Wall, 0.0, UpperWall, 0.0, LowerWall, 0.0)
MARKER_FAR = ( Farfield )

MARKER_PLOTTING= ( UpperWall, LowerWall, Wall)
MARKER_MONITORING= ( UpperWall, LowerWall, Wall)

VOLUME_FLOW_FILENAME= results_flow
VOLUME_STRUCTURE_FILENAME= results_beam

CONV_FILENAME= history

BREAKDOWN_FILENAME= forces_breakdown.dat

SOLUTION_FLOW_FILENAME= solution_flow.dat
SOLUTION_STRUCTURE_FILENAME= solution_beam.dat

RESTART_FLOW_FILENAME= restart_flow.dat
RESTART_STRUCTURE_FILENAME= restart_beam.dat

SOLUTION_ADJ_FILENAME= solution_flow_adj.dat
RESTART_ADJ_FILENAME= restart_flow_adj.dat

SOLUTION_ADJ_STRUCTURE_FILENAME= solution_flow_adj.dat
RESTART_ADJ_STRUCTURE_FILENAME= restart_flow_adj.dat

WRT_SRF_SOL = NO

MESH_FORMAT= SU2
OUTPUT_FORMAT= PARAVIEW

WRT_CON_FREQ= 1
WRT_CON_FREQ_DUALTIME= 1
WRT_SOL_FREQ= 1
WRT_SOL_FREQ_DUALTIME= 5

DEFORM_STIFFNESS_TYPE = INVERSE_VOLUME
DEFORM_LINEAR_SOLVER = CONJUGATE_GRADIENT

DEFORM_LINEAR_SOLVER_PREC = JACOBI
DEFORM_LINEAR_SOLVER_ERROR = 1E-5
DEFORM_LINEAR_SOLVER_ITER = 5000
DEFORM_CONSOLE_OUTPUT = NO

NUM_METHOD_GRAD= WEIGHTED_LEAST_SQUARES
CFL_NUMBER= 1.0
RK_ALPHA_COEFF= ( 0.66667, 0.66667, 1.000000 )

LINEAR_SOLVER= FGMRES
LINEAR_SOLVER_PREC= LU_SGS
LINEAR_SOLVER_ERROR= 1E-6
LINEAR_SOLVER_ITER= 2

FSI_LINEAR_SOLVER_STRUC = CONJUGATE_GRADIENT
FSI_LINEAR_SOLVER_PREC_STRUC = JACOBI
FSI_LINEAR_SOLVER_ERROR_STRUC = 1E-9
FSI_LINEAR_SOLVER_ITER_STRUC = 50000

CONV_NUM_METHOD_FLOW= ROE
MUSCL_FLOW= YES
SLOPE_LIMITER_FLOW= VENKATAKRISHNAN
VENKAT_LIMITER_COEFF= 1.0
JST_SENSOR_COEFF=( 0.5, 0.02 )
TIME_DISCRE_FLOW= EULER_IMPLICIT

CONV_CRITERIA= RESIDUAL
RESIDUAL_REDUCTION= 5
RESIDUAL_MINVAL= -10
STARTCONV_ITER= 10
CAUCHY_ELEMS= 100
CAUCHY_EPS= 1E-5

